<!DOCTYPE html>
<html lang="ja" class="scroll-smooth">
<head>
        <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CovarianceMatrix - I ant I Investigates</title>
    <meta name="description" content="CovarianceMatrix - Technical Indicator">
    <meta name="keywords" content="CovarianceMatrix, technical indicator, stock analysis">
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3375094177283762"
         crossorigin="anonymous"></script>
    <!-- Canonical URL -->
    <link rel="canonical" href="https://akuro17.github.io/indicators/covariancematrix.html">
    <!-- OGP (Open Graph Protocol) -->
    <meta property="og:type" content="article">
    <meta property="og:title" content="CovarianceMatrix - I ant I Investigates">
    <meta property="og:description" content="CovarianceMatrix - Technical Indicator">
    <meta property="og:url" content="https://akuro17.github.io/indicators/covariancematrix.html">
    <meta property="og:site_name" content="I ant I Investigates">
    <meta property="og:image" content="https://akuro17.github.io/assets/images/ogp/covariancematrix.png">
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="CovarianceMatrix">
    <meta name="twitter:description" content="CovarianceMatrix - Technical Indicator">
    <meta name="twitter:image" content="https://akuro17.github.io/assets/images/ogp/covariancematrix.png">
    <!-- Structured Data for SEO -->
    <script type="application/ld+json">
        {
    "@context": "https://schema.org",
    "@graph": [
        {
            "@context": "https://schema.org",
            "@type": "TechArticle",
            "headline": "CovarianceMatrix Technical Indicator",
            "description": "The Covariance Matrix is the mathematical engine of Modern Portfolio Theory that quantifies how assets move together, enabling the calculation of portfolio risk and the construction of diversified portfolios.",
            "image": "https://akuro17.github.io/assets/images/ogp/covariancematrix.png",
            "author": {
                "@type": "Organization",
                "name": "I ant I Investigates",
                "url": "https://akuro17.github.io"
            },
            "publisher": {
                "@type": "Organization",
                "name": "I ant I Investigates",
                "logo": {
                    "@type": "ImageObject",
                    "url": "https://akuro17.github.io/assets/images/logo.png"
                }
            },
            "mainEntityOfPage": {
                "@type": "WebPage",
                "@id": "https://akuro17.github.io/indicators/covariancematrix.html"
            },
            "about": {
                "@type": "SoftwareSourceCode",
                "name": "CovarianceMatrix Indicator Code",
                "programmingLanguage": [
                    "C#",
                    "Python"
                ]
            }
        },
        {
            "@context": "https://schema.org",
            "@type": "BreadcrumbList",
            "itemListElement": [
                {
                    "@type": "ListItem",
                    "position": 1,
                    "name": "Home",
                    "item": "https://akuro17.github.io/"
                },
                {
                    "@type": "ListItem",
                    "position": 2,
                    "name": "Indicators",
                    "item": "https://akuro17.github.io/indicators/"
                },
                {
                    "@type": "ListItem",
                    "position": 3,
                    "name": "CovarianceMatrix",
                    "item": "https://akuro17.github.io/indicators/covariancematrix.html"
                }
            ]
        }
    ]
}
    </script>
    <!-- Resource Hints -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
    <!-- Styles -->
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
    <link rel="stylesheet" href="../assets/css/style.css">
    <link rel="stylesheet" href="../assets/css/indicator.css">
    <!-- KaTeX (Math) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
    <!-- Libraries (defer for non-blocking load) -->
    <script defer src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <!-- Pygments Syntax Highlighting (Externalized) -->
    <link rel="stylesheet" href="../assets/css/pygments.css">

</head>
<body class="bg-slate-50 text-slate-800 font-sans antialiased relative">
        <!-- Navigation -->
    <nav class="bg-white border-b border-slate-200 sticky top-0 z-50 shadow-sm">
        <div class="max-w-[1400px] mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <div class="flex-shrink-0 flex items-center mr-6">
                        <a href="../index.html" class="font-bold text-xl text-indigo-600">
                            I ant I Investigates
                        </a>
                    </div>
                    <!-- Breadcrumbs (Moved Here) -->
                    <nav class="flex text-sm text-slate-500 mr-8" aria-label="Breadcrumb">
                        <ol class="flex items-center space-x-2">
                            <li><a href="../index.html" class="hover:text-indigo-600 transition-colors">home</a></li>
                            <li><span class="mx-1">/</span></li>
                            <li><a href="./" class="hover:text-indigo-600 transition-colors">indicators</a></li>
                            <li><span class="mx-1">/</span></li>
                            <li><span class="font-medium text-slate-900">CovarianceMatrix</span></li>
                        </ol>
                    </nav>

                    <!-- Page Top Nav (Anchor Links) -->
                    <div class="flex space-x-4 items-center">
                        <a href="#interactive-playground" class="text-slate-600 hover:text-indigo-600 px-3 py-2 text-sm font-medium transition-colors">
                            Chart
                        </a>
                        <a href="#logic-visualization" class="text-slate-600 hover:text-indigo-600 px-3 py-2 text-sm font-medium transition-colors">
                            Logic
                        </a>
                        <a href="#documentation" class="text-slate-600 hover:text-indigo-600 px-3 py-2 text-sm font-medium transition-colors">
                            Docs
                        </a>
                    </div>
                </div>
                <!-- External Links Placeholder -->
                <div class="hidden sm:flex items-center">
                </div>
            </div>
        </div>
    </nav>
    <!-- Main Container: 1-Column Stack -->
    <div class="max-w-[1400px] mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-12">
        <!-- ======================================================= -->
        <!-- TOP SECTION: CONTEXT & PLAYGROUND                       -->
        <!-- ======================================================= -->
        <div class="flex flex-col gap-6">
            <!-- Hero Header -->
            <header>
                <h1 class="text-3xl md:text-4xl font-bold text-slate-900 mb-4 leading-tight">CovarianceMatrix</h1>
                <p class="text-lg text-slate-600 leading-relaxed">The Covariance Matrix is the mathematical engine of Modern Portfolio Theory that quantifies how assets move together, enabling the calculation of portfolio risk and the construction of diversified portfolios.</p>
            </header>

            <!-- Interactive Playground -->
            <section id="interactive-playground" class="bg-white rounded-lg shadow-sm border border-slate-200 overflow-hidden scroll-mt-24">
                <div class="border-b border-slate-200 bg-indigo-50 px-6 py-4">
                    <h2 class="text-lg font-bold text-slate-800 flex items-center">
                        <span class="bg-indigo-600 text-white p-1 rounded mr-3 text-xs shadow-sm font-mono">C</span>
                        Calculator
                    </h2>
                    <p class="text-sm text-slate-600 mt-2">Calculate indicator values from your price data.</p>
                </div>
                <div class="p-6">
                    <!-- Chart Area -->
                    <div class="relative h-[400px] w-full mb-6 border border-slate-100 rounded bg-slate-50">
                        <canvas id="indicatorChart"></canvas>
                    </div>

                    <!-- Controls Area -->
                    <div id="controls" class="grid grid-cols-1 md:grid-cols-3 gap-6 bg-slate-50 p-4 rounded border border-slate-200">
                        <!-- Parameters -->
                        <div class="md:col-span-1 space-y-4">
                            <h3 class="font-bold text-sm text-slate-700 uppercase tracking-wide border-b border-slate-200 pb-2">Parameters</h3>
                            <div id="settings-container">
                                <div class="space-y-3">
                                    <!-- Dynamic settings will be injected here -->
                                </div>
                            </div>
                            <button id="btn-run" onclick="PlaygroundController.update()" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded transition-colors shadow-sm flex items-center justify-center">
                                Calculate
                            </button>
                        </div>

                        <!-- Data I/O -->
                        <div class="md:col-span-2 space-y-4">
                            <!-- Input -->
                            <div class="space-y-2">
                                <div class="flex justify-between items-center pb-2 border-b border-slate-200">
                                    <h3 class="font-bold text-sm text-slate-700 uppercase tracking-wide">Input Data (CSV)</h3>
                                    <div class="flex space-x-2">
                                        <button id="btn-load-sample-ohlcv" class="text-xs text-indigo-600 hover:text-indigo-800 hover:underline transition-colors" title="Load OHLCV Sample Data">Shape (OHLCV)</button>
                                        <span class="text-slate-300">|</span>
                                        <button id="btn-load-sample-single" class="text-xs text-indigo-600 hover:text-indigo-800 hover:underline transition-colors" title="Load Single Value Sample Data">Single</button>
                                    </div>
                                </div>
                                <p class="text-xs text-slate-500">Enter CSV data (Date,Open,High,Low,Close,Volume) or single values.</p>
                                <textarea id="input-data" class="w-full h-24 p-2 text-xs font-mono border border-slate-300 rounded focus:ring-2 focus:ring-indigo-500 transition-shadow" placeholder="e.g. 100.5, 101.2, 99.8, 102.3, 103.1...

or one per line:
100.5
101.2
99.8"></textarea>
                            </div>
                            <!-- Output (Enabled) -->
                            <div class="space-y-2">
                                <div class="flex justify-between items-center pb-2 border-b border-slate-200">
                                    <h3 class="font-bold text-sm text-slate-700 uppercase tracking-wide">Output Data (Result)</h3>
                                </div>
                                <textarea id="output-data" class="w-full h-24 p-2 text-xs font-mono border border-slate-300 rounded bg-slate-100 text-slate-600" readonly placeholder="Calculation results will appear here..."></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- ======================================================= -->
        <!-- MIDDLE SECTION: LOGIC & ARCHITECTURE (PORTED FROM 0117) -->
        <!-- ======================================================= -->
        <section id="logic-visualization" class="bg-white rounded-lg shadow-sm border border-slate-200 overflow-hidden scroll-mt-24">
            <!-- Section Header (Styled like Playground) -->
            <div class="border-b border-slate-200 bg-emerald-50 px-6 py-4">
                <h2 class="text-lg font-bold text-slate-800 flex items-center">
                    <span class="bg-emerald-600 text-white p-1 rounded mr-3 text-xs shadow-sm font-mono">L</span>
                    Logic & Code Architecture
                </h2>
                <p class="text-sm text-slate-600 mt-2">Visual flowchart showing how the indicator processes data.</p>
            </div>

            <!-- LOGIC FIGURE STRUCTURE -->
            <figure class="logic-figure" style="border: none; border-radius: 0;">
                <!-- 1. Code Panel Toggle Button -->
                <button id="code-panel-toggle-btn" onclick="toggleCodePanel()" title="View Source Code" class="font-bold text-xs">
                    CODE
                </button>

                <!-- 2. Infinite Canvas Layer -->
                <div id="canvas-container" class="chart-scroll-wrapper" 
                     tabindex="0"
                     role="application"
                     aria-label="Flowchart interaction area. Use arrow keys to pan, +/- to zoom, R to reset">
                    <div id="canvas-content" class="mermaid" style="position: absolute; top:0; left:0;">
                        flowchart TD;
subgraph INGESTION["Phase 1: Ingestion"];
A[/"Receive Multi-Asset Returns"/];
B["Capture Each Asset's Return Stream"];
C["Establish Baseline Characteristics"];
end;
subgraph EVALUATION["Phase 2: Evaluation"];
D["Compute Average Return per Asset"];
E["Measure Deviations from Average"];
F{"All Asset Pairs Evaluated?"};
end;
subgraph WEIGHTING["Phase 3: Weighting"];
G["Calculate Co-Movement Strength"];
H["Quantify Relationship Direction"];
end;
subgraph SYNTHESIS["Phase 4: Synthesis"];
I["Construct Relationship Matrix"];
J["Identify Diversification Potential"];
end;
subgraph OUTCOME["Phase 5: Outcome"];
K{"Strong Negative Correlations?"};
L["High Diversification Benefit"];
M["Limited Risk Reduction"];
N[/"Generate Portfolio Risk Profile"/];
end;
A --> B;
B --> C;
C --> D;
D --> E;
E --> F;
F -->|No| G;
F -->|Yes| I;
G --> H;
H --> F;
I --> J;
J --> K;
K -->|Yes| L;
K -->|No| M;
L --> N;
M --> N;
style INGESTION fill:#e3f2fd;
style EVALUATION fill:#fff3e0;
style WEIGHTING fill:#e8f5e9;
style SYNTHESIS fill:#fce4ec;
style OUTCOME fill:#f3e5f5;
                    </div>
                </div>

                <!-- 3. Canvas Controls (Zoom) -->
                <div class="absolute top-4 right-4 flex flex-col gap-2 z-20">
                    <button onclick="if(window.resetView) window.resetView()" class="p-2 bg-white rounded shadow border border-slate-200 hover:bg-slate-50 text-slate-600 font-mono text-xs" title="Reset View">R</button>
                    <button onclick="if(window.zoomAction) window.zoomAction('in')" class="p-2 bg-white rounded shadow border border-slate-200 hover:bg-slate-50 text-slate-600 font-mono text-xs" title="Zoom In">+</button>
                    <button onclick="if(window.zoomAction) window.zoomAction('out')" class="p-2 bg-white rounded shadow border border-slate-200 hover:bg-slate-50 text-slate-600 font-mono text-xs" title="Zoom Out">-</button>
                </div>

                <!-- 4. Code Panel Overlay (Slide-in) -->
                <div id="code-panel-overlay" class="panel-hidden" onmousedown="event.stopPropagation();">
                    <!-- Header -->
                    <div class="flex justify-between items-center p-3 border-b border-slate-200 bg-slate-50 shrink-0">
                        <div class="flex gap-2">
                            <button id="btn-lang-csharp" class="px-2 py-1 text-xs rounded transition-colors text-slate-500 hover:bg-slate-100" onclick="setLang('csharp')">C#</button>
                            <button id="btn-lang-python" class="px-2 py-1 text-xs rounded transition-colors text-slate-500 hover:bg-slate-100" onclick="setLang('python')">Python</button>
                        </div>
                        <div class="flex items-center gap-2">
                            <button id="btn-type-simple" class="text-xs text-slate-500 hover:text-indigo-600 transition-colors" onclick="setType('simple')">Simple</button>
                            <button id="btn-type-detailed" class="text-xs text-slate-500 hover:text-indigo-600 transition-colors" onclick="setType('detailed')">Detailed</button>
                            <!-- Copy -->
                            <button id="btn-copy-code" class="ml-2 text-slate-500 hover:text-slate-800 transition-colors" onclick="copyCode()" title="Copy Code">
                                <svg id="icon-copy" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                </svg>
                                <svg id="icon-copy-done" class="hidden text-green-600" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <polyline points="20 6 9 17 4 12"></polyline>
                                </svg>
                            </button>
                            <!-- Expand/Collapse -->
                            <button id="btn-panel-expand" class="text-slate-500 hover:text-slate-800 transition-colors" onclick="toggleExpand()" title="Toggle Width">
                                <svg id="icon-expand" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M15 3h6v6" /><path d="M9 21H3v-6" /><path d="M21 3l-7 7" /><path d="M3 21l7-7" />
                                </svg>
                                <svg id="icon-collapse" class="hidden" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M4 14h6v6" /><path d="M20 10h-6V4" /><path d="M14 10l7-7" /><path d="M10 14l-7 7" />
                                </svg>
                            </button>
                            <!-- Close -->
                            <button class="text-slate-500 hover:text-red-600 transition-colors" onclick="toggleCodePanel()" title="Close Panel">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="18" y1="6" x2="6" y2="18" /><line x1="6" y1="6" x2="18" y2="18" />
                                </svg>
                            </button>
                        </div>
                    </div>
                    <!-- Body -->
                    <div class="code-panel-body custom-scrollbar p-4" 
                         id="code-panel-body"
                         data-code-src="../data/codes/CovarianceMatrix.js">
                        <!-- Loading indicator -->
                        <div id="code-loading" class="hidden absolute inset-0 flex items-center justify-center bg-white/80 z-10">
                            <span class="text-slate-400 text-sm">Loading code...</span>
                        </div>
                        <!-- Code containers (populated via JS fetch) -->
                        <div id="code-csharp-simple" class="code-content hidden"></div>
                        <div id="code-csharp-detailed" class="code-content hidden"></div>
                        <div id="code-python-simple" class="code-content hidden"></div>
                        <div id="code-python-detailed" class="code-content hidden"></div>
                    </div>
                </div>
            </figure>

            <!-- Legend (5-Step Model) -->
            <div class="logic-legend">
                <div class="legend-item"><span class="legend-dot l-ingestion"></span>Ingestion</div>
                <div class="legend-item"><span class="legend-dot l-evaluation"></span>Evaluation</div>
                <div class="legend-item"><span class="legend-dot l-weighting"></span>Weighting</div>
                <div class="legend-item"><span class="legend-dot l-synthesis"></span>Synthesis</div>
                <div class="legend-item"><span class="legend-dot l-outcome"></span>Outcome</div>
                <div class="text-xs text-slate-500 ml-auto">Keyboard: Arrows(pan) / +-(zoom) / R(reset)</div>
            </div>
        </section>

        <!-- ======================================================= -->
        <!-- BOTTOM SECTION: DOCS & TOC                              -->
        <!-- ======================================================= -->
        <section id="documentation" class="bg-white rounded-lg shadow-sm border border-slate-200 overflow-hidden scroll-mt-24">
            <!-- Documentation Header -->
            <div class="border-b border-orange-200 bg-orange-50 px-6 py-4">
                <h2 class="text-lg font-bold text-slate-900 flex items-center">
                    <span class="bg-indigo-600 text-white p-1 rounded mr-3 text-xs shadow-sm font-mono">D</span>
                    Technical Documentation
                </h2>
                <p class="text-slate-600 text-xs mt-1 ml-9">
                    Detailed technical explanation of the indicator's logic, math, and implementation details.
                </p>
            </div>
            <!-- Content Body -->
            <div class="p-6 flex flex-col lg:flex-row gap-12">
                <!-- Left: Article -->
                <article class="flex-1 min-w-0">
                    <div class="prose prose-slate max-w-none prose-headings:scroll-mt-24 prose-headings:font-bold prose-h2:text-2xl prose-h2:border-b prose-h2:pb-2 prose-h2:mt-8 prose-a:text-indigo-600 hover:prose-a:text-indigo-800">
                        <h1 id="covariance-matrix">Covariance Matrix</h1>

<p class="mb-4"><h2 class="text-2xl font-bold mt-12 mb-6 border-b pb-2">PART 1: MAIN GUIDE</h2></p>

<h2 id="1-identity">1. Identity</h2>

<p class="mb-4">Full Name: Covariance Matrix  </p>
<p class="mb-4">Abbreviation: Σ (Sigma)  </p>
<p class="mb-4">Category: Statistical / Risk Management  </p>
<p class="mb-4">Creator: Harry Markowitz (1952)  </p>

<blockquote class="border-l-4 border-gray-300 pl-4 italic text-gray-700 my-4 bg-gray-50 py-2 pr-2 rounded-r">One-Sentence Definition: The Covariance Matrix is the mathematical engine of Modern Portfolio Theory that quantifies how assets move together, enabling the calculation of portfolio risk and the construction of diversified portfolios.</blockquote>

<hr class="border-[#2a2e39] my-8">

<h2 id="2-calculation-logic">2. Calculation Logic</h2>

<h3 id="formula">Formula</h3>

<p class="mb-4">The Covariance Matrix ($\Sigma$) is an $n \times n$ symmetric matrix:</p>

<p class="mb-4">$$\Sigma = \begin{bmatrix} \sigma_{1,1} & \sigma_{1,2} & \cdots & \sigma_{1,n} \\ \sigma_{2,1} & \sigma_{2,2} & \cdots & \sigma_{2,n} \\ \vdots & \vdots & \ddots & \vdots \\ \sigma_{n,1} & \sigma_{n,2} & \cdots & \sigma_{n,n} \end{bmatrix}$$</p>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Component</td><td class="px-4 py-2 border-b border-[#2a2e39]">Formula</td><td class="px-4 py-2 border-b border-[#2a2e39]">Purpose</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Mean Return</td><td class="px-4 py-2 border-b border-[#2a2e39]">$\bar{r}_i = \frac{1}{T}\sum_{t=1}^{T} r_{i,t}$</td><td class="px-4 py-2 border-b border-[#2a2e39]">Average return per asset</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Variance (Diagonal)</td><td class="px-4 py-2 border-b border-[#2a2e39]">$\sigma_{i,i} = \frac{1}{T-1}\sum_{t=1}^{T}(r_{i,t} - \bar{r}_i)^2$</td><td class="px-4 py-2 border-b border-[#2a2e39]">Individual asset risk</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Covariance (Off-diagonal)</td><td class="px-4 py-2 border-b border-[#2a2e39]">$\sigma_{i,j} = \frac{1}{T-1}\sum_{t=1}^{T}(r_{i,t} - \bar{r}_i)(r_{j,t} - \bar{r}_j)$</td><td class="px-4 py-2 border-b border-[#2a2e39]">Relationship between assets</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Portfolio Variance</td><td class="px-4 py-2 border-b border-[#2a2e39]">$\sigma_p^2 = \mathbf{w}^T \Sigma \mathbf{w}$</td><td class="px-4 py-2 border-b border-[#2a2e39]">Total portfolio risk</td></tr>
</table></div>

<h3 id="real-world-analogy">Real-World Analogy</h3>

<p class="mb-4">Think of the Covariance Matrix like a marriage compatibility chart for investments. The diagonal shows how volatile each individual asset is (their "personality intensity"), while the off-diagonal elements show how compatible pairs of assets are (do they fight or complement each other?). A well-diversified portfolio is like assembling a team where members' strengths and weaknesses balance each other out.</p>

<hr class="border-[#2a2e39] my-8">

<h2 id="3-market-standards">3. Market Standards</h2>

<h3 id="default-parameters">Default Parameters</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Parameter</td><td class="px-4 py-2 border-b border-[#2a2e39]">Standard Value</td><td class="px-4 py-2 border-b border-[#2a2e39]">Rationale</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Lookback Window</td><td class="px-4 py-2 border-b border-[#2a2e39]">252 days</td><td class="px-4 py-2 border-b border-[#2a2e39]">One trading year; captures full market cycle</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Tactical Window</td><td class="px-4 py-2 border-b border-[#2a2e39]">60 days</td><td class="px-4 py-2 border-b border-[#2a2e39]">Shorter window for regime-responsive allocation</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">EWMA Lambda</td><td class="px-4 py-2 border-b border-[#2a2e39]">0.94</td><td class="px-4 py-2 border-b border-[#2a2e39]">RiskMetrics standard; weights recent data more heavily</td></tr>
</table></div>

<h3 id="data-requirements">Data Requirements</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Requirement</td><td class="px-4 py-2 border-b border-[#2a2e39]">Specification</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Minimum Observations</td><td class="px-4 py-2 border-b border-[#2a2e39]">$T > N$ (periods > assets)</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Recommended</td><td class="px-4 py-2 border-b border-[#2a2e39]">$T \geq 2N$ for stable estimates</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Data Type</td><td class="px-4 py-2 border-b border-[#2a2e39]">Returns (not prices)</td></tr>
</table></div>

<h3 id="why-these-values">Why These Values?</h3>

<p class="mb-4">The 252-day window represents one trading year, providing sufficient data for stable correlation estimates while remaining relevant to current market conditions. The EWMA lambda of 0.94 was extensively tested by J.P. Morgan's RiskMetrics and found optimal for balancing responsiveness with stability.</p>

<hr class="border-[#2a2e39] my-8">

<h2 id="4-market-context">4. Market Context</h2>

<h3 id="best-conditions">Best Conditions</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Condition</td><td class="px-4 py-2 border-b border-[#2a2e39]">Why It Works</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Normal Market Regimes</td><td class="px-4 py-2 border-b border-[#2a2e39]">Historical correlations are predictive of future behavior</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Strategic Asset Allocation</td><td class="px-4 py-2 border-b border-[#2a2e39]">Long-term diversification benefits persist</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Multi-Asset Portfolios</td><td class="px-4 py-2 border-b border-[#2a2e39]">More assets = more diversification opportunities</td></tr>
</table></div>

<h3 id="limitations">Limitations</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Condition</td><td class="px-4 py-2 border-b border-[#2a2e39]">Problem</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Market Crises</td><td class="px-4 py-2 border-b border-[#2a2e39]">Correlations converge to 1.0; diversification fails</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Regime Shifts</td><td class="px-4 py-2 border-b border-[#2a2e39]">Historical correlations become obsolete</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Small Sample Sizes</td><td class="px-4 py-2 border-b border-[#2a2e39]">Matrix becomes unstable or singular</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">High-Frequency Trading</td><td class="px-4 py-2 border-b border-[#2a2e39]">Correlations too noisy for meaningful optimization</td></tr>
</table></div>

<h3 id="asset-class-suitability">Asset Class Suitability</h3>

<p class="mb-4">- Multi-Asset Portfolios — Core application</p>
<p class="mb-4">- Equity Sectors — Rotation strategies</p>
<p class="mb-4">- Fixed Income — Duration and credit allocation</p>
<p class="mb-4">- Alternative Assets — Limited history may cause instability</p>
<p class="mb-4">- Single Stocks — Not applicable (portfolio-level tool)</p>

<hr class="border-[#2a2e39] my-8">

<h2 id="5-entry-signals">5. Entry Signals</h2>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Signal Type</td><td class="px-4 py-2 border-b border-[#2a2e39]">Condition</td><td class="px-4 py-2 border-b border-[#2a2e39]">Direction</td><td class="px-4 py-2 border-b border-[#2a2e39]">Strength</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Diversification Buy</td><td class="px-4 py-2 border-b border-[#2a2e39]">Asset covariance with portfolio is low/negative</td><td class="px-4 py-2 border-b border-[#2a2e39]">Bullish</td><td class="px-4 py-2 border-b border-[#2a2e39]">Strong</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Risk Reduction Sell</td><td class="px-4 py-2 border-b border-[#2a2e39]">Asset covariance with portfolio spikes</td><td class="px-4 py-2 border-b border-[#2a2e39]">Bearish</td><td class="px-4 py-2 border-b border-[#2a2e39]">Strong</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Correlation Dispersion</td><td class="px-4 py-2 border-b border-[#2a2e39]">Off-diagonal correlations decrease</td><td class="px-4 py-2 border-b border-[#2a2e39]">Risk-On</td><td class="px-4 py-2 border-b border-[#2a2e39]">Moderate</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Correlation Convergence</td><td class="px-4 py-2 border-b border-[#2a2e39]">Off-diagonal correlations spike toward 1.0</td><td class="px-4 py-2 border-b border-[#2a2e39]">Risk-Off</td><td class="px-4 py-2 border-b border-[#2a2e39]">Strong</td></tr>
</table></div>

<h3 id="diversification-signal">Diversification Signal</h3>

<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-">
IF Asset_Covariance_With_Portfolio &lt; Portfolio_Average_Covariance
AND Asset_Expected_Return &gt; Risk_Free_Rate
THEN → ADD TO PORTFOLIO (Risk Reduction)
</code></pre>

<h3 id="risk-warning-signal">Risk Warning Signal</h3>

<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-">
IF Average_Off_Diagonal_Correlation &gt; 0.8
OR Largest_Eigenvalue &gt; 70% of Total Variance
THEN → REDUCE EXPOSURE (Systemic Risk Alert)
</code></pre>

<hr class="border-[#2a2e39] my-8">

<h2 id="6-filter-usage">6. Filter Usage</h2>

<p class="mb-4">The Covariance Matrix is the foundation of portfolio optimization, not a trading signal generator.</p>

<h3 id="filter-rules">Filter Rules</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Rule</td><td class="px-4 py-2 border-b border-[#2a2e39]">Application</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]"><code>Correlation < 0.3</code></td><td class="px-4 py-2 border-b border-[#2a2e39]">Candidate provides meaningful diversification</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]"><code>Correlation > 0.7</code></td><td class="px-4 py-2 border-b border-[#2a2e39]">Redundant exposure; consider consolidation</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]"><code>Eigenvalue Spike</code></td><td class="px-4 py-2 border-b border-[#2a2e39]">Single factor dominance; hedge or reduce</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]"><code>Matrix Condition Number High</code></td><td class="px-4 py-2 border-b border-[#2a2e39]">Estimation noise; apply shrinkage</td></tr>
</table></div>

<h3 id="recommended-pairings">Recommended Pairings</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Partner Indicator</td><td class="px-4 py-2 border-b border-[#2a2e39]">Synergy Logic</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">VIX/Implied Volatility</td><td class="px-4 py-2 border-b border-[#2a2e39]">Regime switch signal for matrix reliability</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Momentum/RS</td><td class="px-4 py-2 border-b border-[#2a2e39]">Pre-filter assets before optimization</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Factor Models</td><td class="px-4 py-2 border-b border-[#2a2e39]">Decompose matrix into systematic components</td></tr>
</table></div>

<h3 id="example-combined-strategy">Example Combined Strategy</h3>

<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-">
REGIME DETECTION:
&nbsp;&nbsp;IF VIX &gt; 30:
&nbsp;&nbsp;&nbsp;&nbsp;Use Crisis_Correlation_Matrix (all = 0.9)
&nbsp;&nbsp;ELSE:
&nbsp;&nbsp;&nbsp;&nbsp;Use Standard_Historical_Matrix

PORTFOLIO CONSTRUCTION:
&nbsp;&nbsp;Filter universe by Top 50% Momentum
&nbsp;&nbsp;Run Mean-Variance Optimization on filtered set
&nbsp;&nbsp;Apply Ledoit-Wolf shrinkage to stabilize weights
</code></pre>

<hr class="border-[#2a2e39] my-8">

<h2 id="7-practical-cautions">7. Practical Cautions</h2>

<h3 id="estimation-challenges">Estimation Challenges</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Issue</td><td class="px-4 py-2 border-b border-[#2a2e39]">Description</td><td class="px-4 py-2 border-b border-[#2a2e39]">Mitigation</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Estimation Error</td><td class="px-4 py-2 border-b border-[#2a2e39]">Sample correlations deviate from true values</td><td class="px-4 py-2 border-b border-[#2a2e39]">Apply Shrinkage (Ledoit-Wolf)</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Non-Stationarity</td><td class="px-4 py-2 border-b border-[#2a2e39]">Correlations change over time</td><td class="px-4 py-2 border-b border-[#2a2e39]">Use rolling windows or EWMA</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Dimensionality</td><td class="px-4 py-2 border-b border-[#2a2e39]">Many assets = many parameters to estimate</td><td class="px-4 py-2 border-b border-[#2a2e39]">Factor models or RMT filtering</td></tr>
</table></div>

<blockquote class="border-l-4 border-gray-300 pl-4 italic text-gray-700 my-4 bg-gray-50 py-2 pr-2 rounded-r">Reality Check: The sample covariance matrix is notoriously noisy. With 50 assets, you're estimating 1,275 parameters. Small estimation errors compound dramatically in optimization.</blockquote>

<h3 id="false-signal-scenarios">False Signal Scenarios</h3>

<p class="mb-4">1. Correlation Breakdown in Crises  </p>
<p class="mb-4">   2008, 2020 showed all correlations converging to 1.0, making diversification worthless.</p>

<p class="mb-4">2. Spurious Correlations  </p>
<p class="mb-4">   Random chance creates apparent relationships that don't persist.</p>

<p class="mb-4">3. Regime Dependence  </p>
<p class="mb-4">   Bull market correlations differ from bear market correlations.</p>

<h3 id="mitigation-strategies">Mitigation Strategies</h3>

<p class="mb-4">- Shrinkage: Pull extreme correlations toward a structured target</p>
<p class="mb-4">- Random Matrix Theory (RMT): Filter out eigenvalues consistent with noise</p>
<p class="mb-4">- Regime Adjustment: Manually override correlations during high VIX periods</p>

<hr class="border-[#2a2e39] my-8">

<h2 id="8-pro-insights">8. Pro Insights</h2>

<h3 id="the-panic-convergence-warning">The Panic Convergence Warning</h3>

<p class="mb-4">In a healthy bull market, your correlation heatmap should look "speckled" (varied colors indicating diverse relationships). When it suddenly turns uniformly "hot" (all correlations trending toward 1.0), your diversification has mathematically evaporated. This "Panic Convergence" often precedes market crashes by 1-2 weeks.</p>

<h3 id="eigen-cleaning-for-signal-vs-noise">Eigen-Cleaning for Signal vs. Noise</h3>

<p class="mb-4">Advanced quants don't use raw covariance matrices. They decompose the matrix into eigenvalues, filter out the "noise band" predicted by Random Matrix Theory (Marchenko-Pastur distribution), and reconstruct a "cleaned" matrix containing only genuine signal.</p>

<h3 id="cross-asset-regime-detection">Cross-Asset Regime Detection</h3>

<p class="mb-4">Track the first principal component (largest eigenvalue) of your asset universe. When this eigenvalue suddenly accounts for >50% of total variance (up from typical 30%), a single factor (usually "risk-off") is dominating—hedge immediately.</p>

<h3 id="shrinkage-implementation">Shrinkage Implementation</h3>

<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-python">
# Ledoit-Wolf Shrinkage
shrunk_cov = alpha * target + (1 - alpha) * sample_cov
# where target = constant correlation matrix
# alpha = optimal shrinkage intensity (0.2-0.3 typical)
</code></pre>

<hr class="border-[#2a2e39] my-8">

<h2 id="9-summary">9. Summary</h2>

<blockquote class="border-l-4 border-gray-300 pl-4 italic text-gray-700 my-4 bg-gray-50 py-2 pr-2 rounded-r">"The Covariance Matrix is your portfolio's compatibility chart—it reveals which assets play well together and warns you when everyone starts panicking in unison."</blockquote>

<p class="mb-4"><h2 class="text-2xl font-bold mt-12 mb-6 border-b pb-2">PART 2: SUPPLEMENTARY GUIDE</h2></p>

<h2 id="1-core-concept">1. Core Concept</h2>

<p class="mb-4">The Covariance Matrix answers the fundamental question: "How do my assets move together?"</p>

<p class="mb-4">Before Markowitz, investors intuitively knew not to "put all eggs in one basket," but lacked mathematical tools to quantify diversification benefits. The covariance matrix made it possible to calculate *exactly* how much risk reduction you get from combining assets.</p>

<p class="mb-4">Key insight: Portfolio risk is NOT the average of individual risks. It depends heavily on how assets correlate:</p>
<p class="mb-4">- Positive correlation → Risks compound</p>
<p class="mb-4">- Zero correlation → Risks partially cancel</p>
<p class="mb-4">- Negative correlation → Risks actively hedge</p>

<p class="mb-4">The matrix structure is elegant: diagonal = individual volatilities; off-diagonal = pairwise relationships. This simple framework powers trillion-dollar asset allocation decisions.</p>

<hr class="border-[#2a2e39] my-8">

<h2 id="2-statistical-edge">2. Statistical Edge</h2>

<h3 id="why-diversification-works">Why Diversification Works</h3>

<p class="mb-4">Mathematical proof of diversification benefit:</p>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Portfolio Type</td><td class="px-4 py-2 border-b border-[#2a2e39]">Assets</td><td class="px-4 py-2 border-b border-[#2a2e39]">Correlation</td><td class="px-4 py-2 border-b border-[#2a2e39]">Portfolio StdDev</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Single Asset</td><td class="px-4 py-2 border-b border-[#2a2e39]">1</td><td class="px-4 py-2 border-b border-[#2a2e39]">N/A</td><td class="px-4 py-2 border-b border-[#2a2e39]">20%</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Two Assets (ρ = 1)</td><td class="px-4 py-2 border-b border-[#2a2e39]">2</td><td class="px-4 py-2 border-b border-[#2a2e39]">+1.0</td><td class="px-4 py-2 border-b border-[#2a2e39]">20% (no benefit)</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Two Assets (ρ = 0)</td><td class="px-4 py-2 border-b border-[#2a2e39]">2</td><td class="px-4 py-2 border-b border-[#2a2e39]">0</td><td class="px-4 py-2 border-b border-[#2a2e39]">14.1% (30% reduction)</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Two Assets (ρ = -1)</td><td class="px-4 py-2 border-b border-[#2a2e39]">2</td><td class="px-4 py-2 border-b border-[#2a2e39]">-1.0</td><td class="px-4 py-2 border-b border-[#2a2e39]">0% (perfect hedge)</td></tr>
</table></div>

<h3 id="empirical-evidence">Empirical Evidence</h3>

<p class="mb-4">Long-term studies show:</p>
<p class="mb-4">- Average stock-stock correlation: ~0.35</p>
<p class="mb-4">- Average stock-bond correlation: ~0.05</p>
<p class="mb-4">- Crisis correlation (all assets): ~0.85</p>

<p class="mb-4">This means diversification works most of the time but fails precisely when you need it most.</p>

<h3 id="academic-foundation">Academic Foundation</h3>

<p class="mb-4">Markowitz's 1952 paper "Portfolio Selection" (*Journal of Finance*) earned him the 1990 Nobel Prize in Economics, establishing the covariance matrix as the mathematical heart of modern finance.</p>

<hr class="border-[#2a2e39] my-8">

<h2 id="3-actionable-strategy">3. Actionable Strategy</h2>

<h3 id="strategy-name:-"regime-adjusted-allocation"">Strategy Name: "Regime-Adjusted Allocation"</h3>

<p class="mb-4">Concept: Use VIX as a regime switch to adjust correlation assumptions dynamically.</p>

<p class="mb-4">Setup Requirements:</p>
<p class="mb-4">1. Calculate 252-day sample covariance matrix monthly</p>
<p class="mb-4">2. Monitor VIX (or other volatility proxy) daily</p>

<p class="mb-4">Regime Logic:</p>
<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-">
IF VIX &lt; 20:
&nbsp;&nbsp;Use Normal_Matrix (historical 252-day)
&nbsp;&nbsp;Target_Allocation = Tangency_Portfolio
&nbsp;&nbsp;
ELSE IF VIX 20-30:
&nbsp;&nbsp;Use Blended_Matrix (50% historical, 50% crisis)
&nbsp;&nbsp;Reduce risky asset weights by 25%
&nbsp;&nbsp;
ELSE IF VIX &gt; 30:
&nbsp;&nbsp;Use Crisis_Matrix (correlations = 0.9)
&nbsp;&nbsp;Maximum 40% equity exposure
&nbsp;&nbsp;Allocate remainder to short-term bonds/cash
</code></pre>

<p class="mb-4">Rebalancing:</p>
<p class="mb-4">- Monthly under normal conditions</p>
<p class="mb-4">- Weekly during elevated VIX</p>
<p class="mb-4">- Daily crisis monitoring</p>

<hr class="border-[#2a2e39] my-8">

<h2 id="4-risks-&-limitations">4. Risks & Limitations</h2>

<h3 id="failure-patterns">Failure Patterns</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Pattern</td><td class="px-4 py-2 border-b border-[#2a2e39]">Description</td><td class="px-4 py-2 border-b border-[#2a2e39]">Mitigation</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Singular Matrix</td><td class="px-4 py-2 border-b border-[#2a2e39]">More assets than observations</td><td class="px-4 py-2 border-b border-[#2a2e39]">Reduce asset count or increase history</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Correlation Breakdown</td><td class="px-4 py-2 border-b border-[#2a2e39]">Diversification fails in crises</td><td class="px-4 py-2 border-b border-[#2a2e39]">Use regime-adjusted matrices</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Estimation Error</td><td class="px-4 py-2 border-b border-[#2a2e39]">Sample ≠ True parameters</td><td class="px-4 py-2 border-b border-[#2a2e39]">Apply shrinkage estimators</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Corner Solutions</td><td class="px-4 py-2 border-b border-[#2a2e39]">Optimizer concentrates in few assets</td><td class="px-4 py-2 border-b border-[#2a2e39]">Add weight constraints</td></tr>
</table></div>

<h3 id="psychological-traps">Psychological Traps</h3>

<p class="mb-4">1. False Diversification Confidence  </p>
<p class="mb-4">   Having 20 stocks doesn't mean you're diversified if they're all high-beta tech names.</p>

<p class="mb-4">2. Past Correlation ≠ Future Correlation  </p>
<p class="mb-4">   The matrix is backward-looking by definition.</p>

<p class="mb-4">3. Ignoring Regime Dependence  </p>
<p class="mb-4">   Bull market correlations give false comfort about crisis protection.</p>

<h3 id="common-misinterpretations">Common Misinterpretations</h3>

<p class="mb-4">- "Low correlation means safe" → Correlations spike in crises</p>
<p class="mb-4">- "More assets = more diversification" → Diminishing returns after 15-20 assets</p>
<p class="mb-4">- "The optimizer knows best" → Garbage in, garbage out</p>

<hr class="border-[#2a2e39] my-8">

<h2 id="5-further-study">5. Further Study</h2>

<h3 id="creator-attribution">Creator Attribution</h3>

<p class="mb-4">Harry Markowitz revolutionized finance with his 1952 paper introducing mean-variance optimization. He was the first to treat portfolio risk as a mathematical function of correlations, not just individual asset risks. Nobel Prize in Economics, 1990.</p>

<h3 id="related-concepts">Related Concepts</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Concept</td><td class="px-4 py-2 border-b border-[#2a2e39]">Relationship</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Correlation Matrix</td><td class="px-4 py-2 border-b border-[#2a2e39]">Normalized version (diagonal = 1)</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Efficient Frontier</td><td class="px-4 py-2 border-b border-[#2a2e39]">Uses covariance matrix as input</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Principal Component Analysis</td><td class="px-4 py-2 border-b border-[#2a2e39]">Spectral decomposition of the matrix</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Factor Models</td><td class="px-4 py-2 border-b border-[#2a2e39]">Structural alternatives to sample estimation</td></tr>
</table></div>

<h3 id="recommended-readings">Recommended Readings</h3>

<p class="mb-4">1. *Portfolio Selection* — Harry Markowitz (1952)</p>
<p class="mb-4">2. *A Well-Conditioned Estimator for Large-Dimensional Covariance Matrices* — Ledoit & Wolf</p>
<p class="mb-4">3. *Risk Management and Financial Institutions* — John Hull</p>

<hr class="border-[#2a2e39] my-8">

<h3 id="55-related-indicators-comparison">5.5 Related Indicators Comparison</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Feature</td><td class="px-4 py-2 border-b border-[#2a2e39]">Covariance Matrix</td><td class="px-4 py-2 border-b border-[#2a2e39]">Correlation Matrix</td><td class="px-4 py-2 border-b border-[#2a2e39]">Factor Model</td><td class="px-4 py-2 border-b border-[#2a2e39]">EWMA Covariance</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Output</td><td class="px-4 py-2 border-b border-[#2a2e39]">Risk values</td><td class="px-4 py-2 border-b border-[#2a2e39]">Standardized (-1 to 1)</td><td class="px-4 py-2 border-b border-[#2a2e39]">Factor loadings + residual</td><td class="px-4 py-2 border-b border-[#2a2e39]">Time-weighted cov</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Scale</td><td class="px-4 py-2 border-b border-[#2a2e39]">Asset-specific</td><td class="px-4 py-2 border-b border-[#2a2e39]">Normalized</td><td class="px-4 py-2 border-b border-[#2a2e39]">Factor-dependent</td><td class="px-4 py-2 border-b border-[#2a2e39]">Asset-specific</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Stability</td><td class="px-4 py-2 border-b border-[#2a2e39]">Low</td><td class="px-4 py-2 border-b border-[#2a2e39]">Moderate</td><td class="px-4 py-2 border-b border-[#2a2e39]">High</td><td class="px-4 py-2 border-b border-[#2a2e39]">Moderate</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Best Use</td><td class="px-4 py-2 border-b border-[#2a2e39]">Portfolio optimization</td><td class="px-4 py-2 border-b border-[#2a2e39]">Visualization</td><td class="px-4 py-2 border-b border-[#2a2e39]">Dimensionality reduction</td><td class="px-4 py-2 border-b border-[#2a2e39]">Dynamic allocation</td></tr>
</table></div>

<p class="mb-4">When to Use Which:</p>
<p class="mb-4">- Covariance Matrix — Direct input to mean-variance optimization</p>
<p class="mb-4">- Correlation Matrix — Visualization and comparison across assets</p>
<p class="mb-4">- Factor Model — When sample size is limited relative to assets</p>
<p class="mb-4">- EWMA Covariance — When recent data should dominate</p>

<p class="mb-4"><h2 class="text-2xl font-bold mt-12 mb-6 border-b pb-2">PART 3: ADVANCED SIGNAL REFERENCE</h2></p>

<h2 id="advanced-signal-reference">Advanced Signal Reference</h2>

<h3 id="threshold-matrix">Threshold Matrix</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Average Correlation</td><td class="px-4 py-2 border-b border-[#2a2e39]">Market State</td><td class="px-4 py-2 border-b border-[#2a2e39]">Action</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">< 0.2</td><td class="px-4 py-2 border-b border-[#2a2e39]">Highly dispersed</td><td class="px-4 py-2 border-b border-[#2a2e39]">Aggressive stock picking</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">0.2 - 0.4</td><td class="px-4 py-2 border-b border-[#2a2e39]">Normal diversification</td><td class="px-4 py-2 border-b border-[#2a2e39]">Standard allocation</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">0.4 - 0.6</td><td class="px-4 py-2 border-b border-[#2a2e39]">Elevated correlation</td><td class="px-4 py-2 border-b border-[#2a2e39]">Monitor closely</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">0.6 - 0.8</td><td class="px-4 py-2 border-b border-[#2a2e39]">High systemic risk</td><td class="px-4 py-2 border-b border-[#2a2e39]">Reduce exposure</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">> 0.8</td><td class="px-4 py-2 border-b border-[#2a2e39]">Crisis mode</td><td class="px-4 py-2 border-b border-[#2a2e39]">Maximum defense</td></tr>
</table></div>

<h3 id="signal-patterns">Signal Patterns</h3>

<h4 id="diversification-candidate-filter">Diversification Candidate Filter</h4>
<p class="mb-4">Low correlation with existing portfolio holdings indicates genuine diversification benefit. Assets with correlation below 0.3 contribute meaningfully to risk reduction without sacrificing expected return. This filter should be applied before any optimization to ensure new positions add structural value.</p>

<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-python">
def is_diversifying_asset(new_asset_returns, portfolio_returns, threshold=0.3):
&nbsp;&nbsp;&nbsp;&nbsp;correlation = calculate_correlation(new_asset_returns, portfolio_returns)
&nbsp;&nbsp;&nbsp;&nbsp;return correlation &lt; threshold
</code></pre>

<h4 id="systemic-risk-alert">Systemic Risk Alert</h4>
<p class="mb-4">Average off-diagonal correlation approaching 0.7 or higher signals that diversification is mathematically evaporating. This "correlation convergence" often precedes market crises by 1-2 weeks as all assets begin moving together. When triggered, aggressive risk reduction is warranted regardless of other indicators.</p>

<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-python">
def systemic_risk_alert(correlation_matrix, threshold=0.7):
&nbsp;&nbsp;&nbsp;&nbsp;n = len(correlation_matrix)
&nbsp;&nbsp;&nbsp;&nbsp;off_diag_sum = 0
&nbsp;&nbsp;&nbsp;&nbsp;count = 0
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;for i in range(n):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for j in range(n):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if i != j:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;off_diag_sum += correlation_matrix[i][j]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count += 1
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;avg_correlation = off_diag_sum / count
&nbsp;&nbsp;&nbsp;&nbsp;return avg_correlation &gt; threshold
</code></pre>

<h4 id="eigenvalue-concentration-check">Eigenvalue Concentration Check</h4>
<p class="mb-4">When the first principal component (largest eigenvalue) dominates total portfolio variance (>50%), a single factor is driving most risk. This concentration indicates systematic exposure that cannot be diversified away—typically the "risk-off" factor during market stress. Hedging or position reduction is advisable.</p>

<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-python">
def first_pc_dominance(covariance_matrix, threshold=0.5):
&nbsp;&nbsp;&nbsp;&nbsp;eigenvalues = calculate_eigenvalues(covariance_matrix)
&nbsp;&nbsp;&nbsp;&nbsp;total_variance = sum(eigenvalues)
&nbsp;&nbsp;&nbsp;&nbsp;first_pc_ratio = max(eigenvalues) / total_variance
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;return first_pc_ratio &gt; threshold  # Single factor dominance
</code></pre>

<h3 id="screening-filters">Screening Filters</h3>

<h4 id="low-correlation-asset-scanner">Low Correlation Asset Scanner</h4>
<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-">
INPUT Current_Portfolio
CANDIDATE = Stock_X

FOR EACH Asset IN Current_Portfolio:
&nbsp;&nbsp;correl = CORRELATION(Stock_X, Asset, 252)
&nbsp;&nbsp;IF correl &gt; 0.7:
&nbsp;&nbsp;&nbsp;&nbsp;REJECT Stock_X

IF NOT REJECTED:
&nbsp;&nbsp;ADD Stock_X to diversification candidates
</code></pre>

<h4 id="regime-shift-detector">Regime Shift Detector</h4>
<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-">
rolling_corr = AVERAGE_CORRELATION(asset_universe, 60)
rolling_corr_prev = AVERAGE_CORRELATION(asset_universe, 60)[20]

IF rolling_corr &gt; rolling_corr_prev + 0.2:
&nbsp;&nbsp;ALERT &quot;Correlation Spike - Possible Regime Shift&quot;
</code></pre>

<h3 id="combination-strategies">Combination Strategies</h3>

<h4 id="vix-adjusted-portfolio-optimization">VIX-Adjusted Portfolio Optimization</h4>
<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-">
IF VIX &lt; 20:
&nbsp;&nbsp;covariance = historical_252_day_matrix
&nbsp;&nbsp;target_equity = 0.70
&nbsp;&nbsp;
ELSE IF VIX 20-30:
&nbsp;&nbsp;covariance = 0.5 * historical + 0.5 * crisis_matrix
&nbsp;&nbsp;target_equity = 0.50
&nbsp;&nbsp;
ELSE:
&nbsp;&nbsp;covariance = crisis_matrix (correlations = 0.9)
&nbsp;&nbsp;target_equity = 0.30

weights = mean_variance_optimize(expected_returns, covariance)
constrain: max_weight = 0.15, min_weight = 0.02
</code></pre>

<h4 id="momentum-filtered-optimization">Momentum-Filtered Optimization</h4>
<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-">
STEP 1: Rank universe by 6-month momentum
STEP 2: Select Top 50% by momentum rank
STEP 3: Calculate covariance matrix for selected assets only
STEP 4: Run mean-variance optimization on filtered set
STEP 5: Rebalance monthly
</code></pre>










                    </div>
                </article>
                <!-- Right: Sticky TOC -->
                <aside class="lg:block w-64 flex-shrink-0">
                    <div class="sticky top-24">
                        <h3 class="font-bold text-slate-900 mb-4 pb-2 border-b border-slate-100 text-sm uppercase tracking-wider">
                            On this page
                        </h3>
                        <nav id="toc-nav" class="space-y-1 text-sm text-slate-600">
                            <a href="#1-identity" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">1. Identity</a>
<a href="#2-calculation-logic" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">2. Calculation Logic</a>
<a href="#formula" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Formula</a>
<a href="#real-world-analogy" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Real-World Analogy</a>
<a href="#3-market-standards" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">3. Market Standards</a>
<a href="#default-parameters" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Default Parameters</a>
<a href="#data-requirements" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Data Requirements</a>
<a href="#why-these-values" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Why These Values?</a>
<a href="#4-market-context" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">4. Market Context</a>
<a href="#best-conditions" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Best Conditions</a>
<a href="#limitations" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Limitations</a>
<a href="#asset-class-suitability" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Asset Class Suitability</a>
<a href="#5-entry-signals" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">5. Entry Signals</a>
<a href="#diversification-signal" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Diversification Signal</a>
<a href="#risk-warning-signal" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Risk Warning Signal</a>
<a href="#6-filter-usage" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">6. Filter Usage</a>
<a href="#filter-rules" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Filter Rules</a>
<a href="#recommended-pairings" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Recommended Pairings</a>
<a href="#example-combined-strategy" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Example Combined Strategy</a>
<a href="#7-practical-cautions" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">7. Practical Cautions</a>
<a href="#estimation-challenges" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Estimation Challenges</a>
<a href="#false-signal-scenarios" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">False Signal Scenarios</a>
<a href="#mitigation-strategies" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Mitigation Strategies</a>
<a href="#8-pro-insights" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">8. Pro Insights</a>
<a href="#the-panic-convergence-warning" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">The Panic Convergence Warning</a>
<a href="#eigen-cleaning-for-signal-vs-noise" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Eigen-Cleaning for Signal vs. Noise</a>
<a href="#cross-asset-regime-detection" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Cross-Asset Regime Detection</a>
<a href="#shrinkage-implementation" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Shrinkage Implementation</a>
<a href="#9-summary" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">9. Summary</a>
<a href="#1-core-concept" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">1. Core Concept</a>
<a href="#2-statistical-edge" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">2. Statistical Edge</a>
<a href="#why-diversification-works" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Why Diversification Works</a>
<a href="#empirical-evidence" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Empirical Evidence</a>
<a href="#academic-foundation" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Academic Foundation</a>
<a href="#3-actionable-strategy" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">3. Actionable Strategy</a>
<a href="#strategy-name:-"regime-adjusted-allocation"" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Strategy Name: "Regime-Adjusted Allocation"</a>
<a href="#4-risks-&-limitations" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">4. Risks & Limitations</a>
<a href="#failure-patterns" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Failure Patterns</a>
<a href="#psychological-traps" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Psychological Traps</a>
<a href="#common-misinterpretations" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Common Misinterpretations</a>
<a href="#5-further-study" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">5. Further Study</a>
<a href="#creator-attribution" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Creator Attribution</a>
<a href="#related-concepts" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Related Concepts</a>
<a href="#recommended-readings" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Recommended Readings</a>
<a href="#55-related-indicators-comparison" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">5.5 Related Indicators Comparison</a>
<a href="#advanced-signal-reference" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">Advanced Signal Reference</a>
<a href="#threshold-matrix" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Threshold Matrix</a>
<a href="#signal-patterns" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Signal Patterns</a>
<a href="#screening-filters" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Screening Filters</a>
<a href="#combination-strategies" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Combination Strategies</a>

                        </nav>
                        <div class="mt-8 pt-4 border-t border-slate-100">
                            <a href="#" class="text-xs text-slate-400 hover:text-indigo-600 flex items-center transition-colors">
                                Back to Top
                            </a>
                        </div>
                    </div>
                </aside>
            </div>
        </section>


    </div>


        <!-- Footer -->
    <footer class="bg-white border-t border-slate-200 mt-12">
        <div class="max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8">
            <p class="text-center text-slate-400 text-sm">
                &copy; 2026 I ant I Investigates
            </p>
        </div>
    </footer>
        <!-- ========================================== -->
    <!-- 1. DATA & LOGIC INJECTION                  -->
    <!-- ========================================== -->
    <script>
        window.IndicatorLogic = {
            name: "CovarianceMatrix",
            params: [],
            calculate: null
        };
        (function() {
            try {
                const injectedCode = `
        window.IndicatorLogic = {
            calculate: (data, params) => {
                const period = params.period || 14;
                const result = CovarianceMatrix.calculate(data, period);
                // Handle both array and object returns
                if (Array.isArray(result)) {
                    return { main: result };
                }
                return result;
            }
        };
        `;
                const isTemplatePlaceholder = injectedCode.includes('{{') && injectedCode.includes('CODE_INDICATOR_LOGIC');
                if (injectedCode && injectedCode.trim().length > 0 && !isTemplatePlaceholder) {
                    new Function(injectedCode)();
                } else {
                    console.warn("Playground Logic: Running in Preview/Fallback mode.");
                    window.IndicatorLogic.calculate = () => []; 
                }
            } catch (e) {
                console.error("Critical Error in Logic Injection:", e);
                window.IndicatorLogic.calculate = () => [];
            }
        })();
    </script>

    <!-- ========================================== -->
    <!-- 2. VISUALIZATION ENGINE                    -->
    <!-- ========================================== -->
    <script>
        mermaid.initialize({ startOnLoad: false, theme: 'neutral', securityLevel: 'loose' });
    </script>
    <!-- ========================================== -->
    <!-- 3. UI CONTROLLERS & APP INITIALIZATION     -->
    <!-- ========================================== -->
    <!-- INLINE UI CONTROLLERS (PORTED FROM 0117) -->
    <script src="../assets/js/CovarianceMatrix.js"></script>
    <!-- JSON Data Containers (XSS-safe) -->
    <script id="data-indicator-config" type="application/json">
[{"id": "period", "label": "Period (14)", "type": "number", "value": 14, "min": 2, "max": 100}]
    </script>
    <script id="data-indicator-display" type="application/json">
{"isOverlay": true, "plots": {"main": {"label": "CovarianceMatrix", "color": "#4f46e5", "type": "line"}}}
    </script>
    <script>
        // --- 0. Indicator Data Injection ---
        // Use existing IndicatorLogic (set in earlier script block), only set if not exists
        var IndicatorLogic = window.IndicatorLogic || { calculate: null };
        var IndicatorConfig = [];
        var IndicatorDisplay = { isOverlay: false, plots: {} };

        // 1. Library Code - loaded externally before this block

        // 2. Configuration (XSS-safe via script type="application/json")
        try {
            var configEl = document.getElementById('data-indicator-config');
            if(configEl && configEl.textContent.trim()) {
                IndicatorConfig = JSON.parse(configEl.textContent);
            }
        } catch(e){ console.warn('Config parse error', e); }

        try {
            var displayEl = document.getElementById('data-indicator-display');
            if(displayEl && displayEl.textContent.trim()) {
                IndicatorDisplay = JSON.parse(displayEl.textContent);
            }
        } catch(e){ console.warn('Display parse error', e); }

        // 3. Logic Adapter
        window.IndicatorLogic = {
            calculate: (data, params) => {
                const period = params.period || 14;
                const result = CovarianceMatrix.calculate(data, period);
                // Handle both array and object returns
                if (Array.isArray(result)) {
                    return { main: result };
                }
                return result;
            }
        };
    </script>

    <!-- UI Controllers: indicator.js loads first to define PlaygroundController -->
    <script src="../assets/js/indicator.js" defer></script>
    <!-- script.js loads second, skips PlaygroundController if already defined -->
    <script src="../assets/js/script.js" defer></script>

</body>
</html>