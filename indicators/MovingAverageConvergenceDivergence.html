<!DOCTYPE html>
<html lang="ja" class="scroll-smooth">
<head>
        <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MovingAverageConvergenceDivergence - I ant I Investigates</title>
    <meta name="description" content="MACD - Technical Indicator">
    <meta name="keywords" content="MovingAverageConvergenceDivergence, technical indicator, stock analysis">
    <!-- Canonical URL -->
    <link rel="canonical" href="https://iantinvestigates.com/indicators/movingaverageconvergencedivergence.html">
    <!-- OGP (Open Graph Protocol) -->
    <meta property="og:type" content="article">
    <meta property="og:title" content="MovingAverageConvergenceDivergence - I ant I Investigates">
    <meta property="og:description" content="MACD - Technical Indicator">
    <meta property="og:url" content="https://iantinvestigates.com/indicators/movingaverageconvergencedivergence.html">
    <meta property="og:site_name" content="I ant I Investigates">
    <meta property="og:image" content="https://iantinvestigates.com/assets/images/ogp/movingaverageconvergencedivergence.png">
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="MovingAverageConvergenceDivergence">
    <meta name="twitter:description" content="MACD - Technical Indicator">
    <meta name="twitter:image" content="https://iantinvestigates.com/assets/images/ogp/movingaverageconvergencedivergence.png">
    <!-- Structured Data for SEO -->
    <script type="application/ld+json">
    </script>
    <!-- Resource Hints -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
    <!-- Styles -->
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
    <link rel="stylesheet" href="../assets/css/style.css">
    <link rel="stylesheet" href="../assets/css/indicator.css">
    <!-- KaTeX (Math) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
    <!-- Libraries (defer for non-blocking load) -->
    <script defer src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <!-- Pygments Syntax Highlighting (Externalized) -->
    <link rel="stylesheet" href="../assets/css/pygments.css">

</head>
<body class="bg-slate-50 text-slate-800 font-sans antialiased relative">
        <!-- Navigation -->
    <nav class="bg-white border-b border-slate-200 sticky top-0 z-50 shadow-sm">
        <div class="max-w-[1400px] mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <div class="flex-shrink-0 flex items-center mr-6">
                        <a href="../index.html" class="font-bold text-xl text-indigo-600">
                            I ant I Investigates
                        </a>
                    </div>
                    <!-- Breadcrumbs (Moved Here) -->
                    <nav class="flex text-sm text-slate-500 mr-8" aria-label="Breadcrumb">
                        <ol class="flex items-center space-x-2">
                            <li><a href="../index.html" class="hover:text-indigo-600 transition-colors">home</a></li>
                            <li><span class="mx-1">/</span></li>
                            <li><a href="./" class="hover:text-indigo-600 transition-colors">indicators</a></li>
                            <li><span class="mx-1">/</span></li>
                            <li><span class="font-medium text-slate-900">MovingAverageConvergenceDivergence</span></li>
                        </ol>
                    </nav>

                    <!-- Page Top Nav (Anchor Links) -->
                    <div class="flex space-x-4 items-center">
                        <a href="#interactive-playground" class="text-slate-600 hover:text-indigo-600 px-3 py-2 text-sm font-medium transition-colors">
                            Chart
                        </a>
                        <a href="#logic-visualization" class="text-slate-600 hover:text-indigo-600 px-3 py-2 text-sm font-medium transition-colors">
                            Logic
                        </a>
                        <a href="#documentation" class="text-slate-600 hover:text-indigo-600 px-3 py-2 text-sm font-medium transition-colors">
                            Docs
                        </a>
                    </div>
                </div>
                <!-- External Links Placeholder -->
                <div class="hidden sm:flex items-center">
                </div>
            </div>
        </div>
    </nav>
    <!-- Main Container: 1-Column Stack -->
    <div class="max-w-[1400px] mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-12">
        <!-- ======================================================= -->
        <!-- TOP SECTION: CONTEXT & PLAYGROUND                       -->
        <!-- ======================================================= -->
        <div class="flex flex-col gap-6">
            <!-- Hero Header -->
            <header>
                <h1 class="text-3xl md:text-4xl font-bold text-slate-900 mb-4 leading-tight">MACD</h1>
                <p class="text-lg text-slate-600 leading-relaxed">MACD transforms the relationship between two exponential moving averages into a momentum oscillator that reveals both trend direction and the acceleration of price movement.</p>
            </header>

            <!-- Interactive Playground -->
            <section id="interactive-playground" class="bg-white rounded-lg shadow-sm border border-slate-200 overflow-hidden scroll-mt-24">
                <div class="border-b border-slate-200 bg-indigo-50 px-6 py-4">
                    <h2 class="text-lg font-bold text-slate-800 flex items-center">
                        <span class="bg-indigo-600 text-white p-1 rounded mr-3 text-xs shadow-sm font-mono">C</span>
                        Calculator
                    </h2>
                    <p class="text-sm text-slate-600 mt-2">Calculate indicator values from your price data.</p>
                </div>
                <div class="p-6">
                    <!-- Chart Area -->
                    <div class="relative h-[400px] w-full mb-6 border border-slate-100 rounded bg-slate-50">
                        <canvas id="indicatorChart"></canvas>
                    </div>

                    <!-- Controls Area -->
                    <div id="controls" class="grid grid-cols-1 md:grid-cols-3 gap-6 bg-slate-50 p-4 rounded border border-slate-200">
                        <!-- Parameters -->
                        <div class="md:col-span-1 space-y-4">
                            <h3 class="font-bold text-sm text-slate-700 uppercase tracking-wide border-b border-slate-200 pb-2">Parameters</h3>
                            <div id="settings-container">
                                <div class="space-y-3">
                                    <!-- Dynamic settings will be injected here -->
                                </div>
                            </div>
                            <button id="btn-run" onclick="PlaygroundController.update()" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded transition-colors shadow-sm flex items-center justify-center">
                                Calculate
                            </button>
                        </div>

                        <!-- Data I/O -->
                        <div class="md:col-span-2 space-y-4">
                            <!-- Input -->
                            <div class="space-y-2">
                                <div class="flex justify-between items-center pb-2 border-b border-slate-200">
                                    <h3 class="font-bold text-sm text-slate-700 uppercase tracking-wide">Input Data (CSV)</h3>
                                    <div class="flex space-x-2">
                                        <button id="btn-load-sample-ohlcv" class="text-xs text-indigo-600 hover:text-indigo-800 hover:underline transition-colors" title="Load OHLCV Sample Data">Shape (OHLCV)</button>
                                        <span class="text-slate-300">|</span>
                                        <button id="btn-load-sample-single" class="text-xs text-indigo-600 hover:text-indigo-800 hover:underline transition-colors" title="Load Single Value Sample Data">Single</button>
                                    </div>
                                </div>
                                <p class="text-xs text-slate-500">Enter CSV data (Date,Open,High,Low,Close,Volume) or single values.</p>
                                <textarea id="input-data" class="w-full h-24 p-2 text-xs font-mono border border-slate-300 rounded focus:ring-2 focus:ring-indigo-500 transition-shadow" placeholder="e.g. 100.5, 101.2, 99.8, 102.3, 103.1...

or one per line:
100.5
101.2
99.8"></textarea>
                            </div>
                            <!-- Output (Enabled) -->
                            <div class="space-y-2">
                                <div class="flex justify-between items-center pb-2 border-b border-slate-200">
                                    <h3 class="font-bold text-sm text-slate-700 uppercase tracking-wide">Output Data (Result)</h3>
                                </div>
                                <textarea id="output-data" class="w-full h-24 p-2 text-xs font-mono border border-slate-300 rounded bg-slate-100 text-slate-600" readonly placeholder="Calculation results will appear here..."></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- ======================================================= -->
        <!-- MIDDLE SECTION: LOGIC & ARCHITECTURE (PORTED FROM 0117) -->
        <!-- ======================================================= -->
        <section id="logic-visualization" class="bg-white rounded-lg shadow-sm border border-slate-200 overflow-hidden scroll-mt-24">
            <!-- Section Header (Styled like Playground) -->
            <div class="border-b border-slate-200 bg-emerald-50 px-6 py-4">
                <h2 class="text-lg font-bold text-slate-800 flex items-center">
                    <span class="bg-emerald-600 text-white p-1 rounded mr-3 text-xs shadow-sm font-mono">L</span>
                    Logic & Code Architecture
                </h2>
                <p class="text-sm text-slate-600 mt-2">Visual flowchart showing how the indicator processes data.</p>
            </div>

            <!-- LOGIC FIGURE STRUCTURE -->
            <figure class="logic-figure" style="border: none; border-radius: 0;">
                <!-- 1. Code Panel Toggle Button -->
                <button id="code-panel-toggle-btn" onclick="toggleCodePanel()" title="View Source Code" class="font-bold text-xs">
                    CODE
                </button>

                <!-- 2. Infinite Canvas Layer -->
                <div id="canvas-container" class="chart-scroll-wrapper" 
                     tabindex="0"
                     role="application"
                     aria-label="フローチャート操作エリア。矢印キーで移動、+/-でズーム、Rでリセット">
                    <div id="canvas-content" class="mermaid" style="position: absolute; top:0; left:0;">
                        flowchart TD;
subgraph INGESTION["Phase 1: Ingestion"];
A[/"Receive Price Data Stream"/];
B["Capture Closing Prices"];
C["Define EMA Periods"];
end;
subgraph EVALUATION["Phase 2: Evaluation"];
D["Calculate Fast Trend via Short EMA"];
E["Calculate Slow Trend via Long EMA"];
F["Measure Trend Separation"];
end;
subgraph WEIGHTING["Phase 3: Weighting"];
G["Generate MACD Line from Spread"];
H["Smooth MACD via Signal Line"];
I["Calculate Momentum via Histogram"];
end;
subgraph SYNTHESIS["Phase 4: Synthesis"];
J["Track Crossover Events"];
K["Monitor Histogram Direction"];
L["Detect Divergence Patterns"];
end;
subgraph OUTCOME["Phase 5: Outcome"];
M{"Momentum Assessment?"};
N["MACD > Signal + Histogram Rising = Bullish"];
O["MACD < Signal + Histogram Falling = Bearish"];
P["Histogram Shrinking = Momentum Fading"];
Q[/"Generate Trend-Momentum Signal"/];
end;
A --> B;
B --> C;
C --> D;
D --> E;
E --> F;
F --> G;
G --> H;
H --> I;
I --> J;
J --> K;
K --> L;
L --> M;
M -->|Bullish| N;
M -->|Bearish| O;
M -->|Fading| P;
N --> Q;
O --> Q;
P --> Q;
style INGESTION fill:#e3f2fd;
style EVALUATION fill:#fff3e0;
style WEIGHTING fill:#e8f5e9;
style SYNTHESIS fill:#fce4ec;
style OUTCOME fill:#f3e5f5;
                    </div>
                </div>

                <!-- 3. Canvas Controls (Zoom) -->
                <div class="absolute top-4 right-4 flex flex-col gap-2 z-20">
                    <button onclick="if(window.resetView) window.resetView()" class="p-2 bg-white rounded shadow border border-slate-200 hover:bg-slate-50 text-slate-600 font-mono text-xs" title="Reset View">R</button>
                    <button onclick="if(window.zoomAction) window.zoomAction('in')" class="p-2 bg-white rounded shadow border border-slate-200 hover:bg-slate-50 text-slate-600 font-mono text-xs" title="Zoom In">+</button>
                    <button onclick="if(window.zoomAction) window.zoomAction('out')" class="p-2 bg-white rounded shadow border border-slate-200 hover:bg-slate-50 text-slate-600 font-mono text-xs" title="Zoom Out">-</button>
                </div>

                <!-- 4. Code Panel Overlay (Slide-in) -->
                <div id="code-panel-overlay" class="panel-hidden" onmousedown="event.stopPropagation();">
                    <!-- Header -->
                    <div class="flex justify-between items-center p-3 border-b border-slate-200 bg-slate-50 shrink-0">
                        <div class="flex gap-2">
                            <button id="btn-lang-csharp" class="px-2 py-1 text-xs rounded transition-colors text-slate-500 hover:bg-slate-100" onclick="setLang('csharp')">C#</button>
                            <button id="btn-lang-python" class="px-2 py-1 text-xs rounded transition-colors text-slate-500 hover:bg-slate-100" onclick="setLang('python')">Python</button>
                        </div>
                        <div class="flex items-center gap-2">
                            <button id="btn-type-simple" class="text-xs text-slate-500 hover:text-indigo-600 transition-colors" onclick="setType('simple')">Simple</button>
                            <button id="btn-type-detailed" class="text-xs text-slate-500 hover:text-indigo-600 transition-colors" onclick="setType('detailed')">Detailed</button>
                            <!-- Copy -->
                            <button id="btn-copy-code" class="ml-2 text-slate-500 hover:text-slate-800 transition-colors" onclick="copyCode()" title="Copy Code">
                                <svg id="icon-copy" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                </svg>
                                <svg id="icon-copy-done" class="hidden text-green-600" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <polyline points="20 6 9 17 4 12"></polyline>
                                </svg>
                            </button>
                            <!-- Expand/Collapse -->
                            <button id="btn-panel-expand" class="text-slate-500 hover:text-slate-800 transition-colors" onclick="toggleExpand()" title="Toggle Width">
                                <svg id="icon-expand" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M15 3h6v6" /><path d="M9 21H3v-6" /><path d="M21 3l-7 7" /><path d="M3 21l7-7" />
                                </svg>
                                <svg id="icon-collapse" class="hidden" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M4 14h6v6" /><path d="M20 10h-6V4" /><path d="M14 10l7-7" /><path d="M10 14l-7 7" />
                                </svg>
                            </button>
                            <!-- Close -->
                            <button class="text-slate-500 hover:text-red-600 transition-colors" onclick="toggleCodePanel()" title="Close Panel">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="18" y1="6" x2="6" y2="18" /><line x1="6" y1="6" x2="18" y2="18" />
                                </svg>
                            </button>
                        </div>
                    </div>
                    <!-- Body -->
                    <div class="code-panel-body custom-scrollbar p-4" 
                         id="code-panel-body"
                         data-code-src="../data/codes/MovingAverageConvergenceDivergence.js">
                        <!-- Loading indicator -->
                        <div id="code-loading" class="hidden absolute inset-0 flex items-center justify-center bg-white/80 z-10">
                            <span class="text-slate-400 text-sm">Loading code...</span>
                        </div>
                        <!-- Code containers (populated via JS fetch) -->
                        <div id="code-csharp-simple" class="code-content hidden"></div>
                        <div id="code-csharp-detailed" class="code-content hidden"></div>
                        <div id="code-python-simple" class="code-content hidden"></div>
                        <div id="code-python-detailed" class="code-content hidden"></div>
                    </div>
                </div>
            </figure>

            <!-- Legend (5-Step Model) -->
            <div class="logic-legend">
                <div class="legend-item"><span class="legend-dot l-ingestion"></span>Ingestion</div>
                <div class="legend-item"><span class="legend-dot l-evaluation"></span>Evaluation</div>
                <div class="legend-item"><span class="legend-dot l-weighting"></span>Weighting</div>
                <div class="legend-item"><span class="legend-dot l-synthesis"></span>Synthesis</div>
                <div class="legend-item"><span class="legend-dot l-outcome"></span>Outcome</div>
                <div class="text-xs text-slate-500 ml-auto">Keyboard: Arrows(pan) / +-(zoom) / R(reset)</div>
            </div>
        </section>

        <!-- ======================================================= -->
        <!-- BOTTOM SECTION: DOCS & TOC                              -->
        <!-- ======================================================= -->
        <section id="documentation" class="bg-white rounded-lg shadow-sm border border-slate-200 overflow-hidden scroll-mt-24">
            <!-- Documentation Header -->
            <div class="border-b border-orange-200 bg-orange-50 px-6 py-4">
                <h2 class="text-lg font-bold text-slate-900 flex items-center">
                    <span class="bg-indigo-600 text-white p-1 rounded mr-3 text-xs shadow-sm font-mono">D</span>
                    Technical Documentation
                </h2>
                <p class="text-slate-600 text-xs mt-1 ml-9">
                    Detailed technical explanation of the indicator's logic, math, and implementation details.
                </p>
            </div>
            <!-- Content Body -->
            <div class="p-6 flex flex-col lg:flex-row gap-12">
                <!-- Left: Article -->
                <article class="flex-1 min-w-0">
                    <div class="prose prose-slate max-w-none prose-headings:scroll-mt-24 prose-headings:font-bold prose-h2:text-2xl prose-h2:border-b prose-h2:pb-2 prose-h2:mt-8 prose-a:text-indigo-600 hover:prose-a:text-indigo-800">
                        <h1 id="moving-average-convergence-divergence-macd">Moving Average Convergence Divergence (MACD)</h1>

<p class="mb-4"><h2 class="text-2xl font-bold mt-12 mb-6 border-b pb-2">PART 1: MAIN GUIDE</h2></p>

<h2 id="1-identity">1. Identity</h2>

<p class="mb-4">Full Name: Moving Average Convergence Divergence  </p>
<p class="mb-4">Abbreviation: MACD  </p>
<p class="mb-4">Category: Momentum / Trend Following  </p>
<p class="mb-4">Creator: Gerald Appel (1979), Histogram by Thomas Aspray (1986)  </p>

<blockquote class="border-l-4 border-gray-300 pl-4 italic text-gray-700 my-4 bg-gray-50 py-2 pr-2 rounded-r">One-Sentence Definition: MACD transforms the relationship between two exponential moving averages into a momentum oscillator that reveals both trend direction and the acceleration of price movement.</blockquote>

<hr class="border-[#2a2e39] my-8">

<h2 id="2-calculation-logic">2. Calculation Logic</h2>

<h3 id="formula">Formula</h3>

<p class="mb-4">$$MACD_{Line} = EMA_{fast}(Price) - EMA_{slow}(Price)$$</p>

<p class="mb-4">$$Signal_{Line} = EMA_{signal}(MACD_{Line})$$</p>

<p class="mb-4">$$Histogram = MACD_{Line} - Signal_{Line}$$</p>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Step</td><td class="px-4 py-2 border-b border-[#2a2e39]">Formula</td><td class="px-4 py-2 border-b border-[#2a2e39]">Purpose</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">1</td><td class="px-4 py-2 border-b border-[#2a2e39]">$k = \frac{2}{period + 1}$</td><td class="px-4 py-2 border-b border-[#2a2e39]">EMA smoothing multiplier</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">2</td><td class="px-4 py-2 border-b border-[#2a2e39]">$EMA_{12} = (Close - EMA_{prev}) \times k_{12} + EMA_{prev}$</td><td class="px-4 py-2 border-b border-[#2a2e39]">Fast EMA (short-term trend)</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">3</td><td class="px-4 py-2 border-b border-[#2a2e39]">$EMA_{26} = (Close - EMA_{prev}) \times k_{26} + EMA_{prev}$</td><td class="px-4 py-2 border-b border-[#2a2e39]">Slow EMA (long-term trend)</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">4</td><td class="px-4 py-2 border-b border-[#2a2e39]">$MACD = EMA_{12} - EMA_{26}$</td><td class="px-4 py-2 border-b border-[#2a2e39]">Momentum line</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">5</td><td class="px-4 py-2 border-b border-[#2a2e39]">$Signal = EMA_9(MACD)$</td><td class="px-4 py-2 border-b border-[#2a2e39]">Trigger line</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">6</td><td class="px-4 py-2 border-b border-[#2a2e39]">$Histogram = MACD - Signal$</td><td class="px-4 py-2 border-b border-[#2a2e39]">Momentum acceleration</td></tr>
</table></div>

<h3 id="real-world-analogy">Real-World Analogy</h3>

<p class="mb-4">Think of MACD like a car's acceleration meter combined with its speedometer. The MACD line shows how fast you're "pulling away" from your average cruising speed (momentum). The Signal line shows the trend of that acceleration. The Histogram reveals whether you're pressing the gas harder (bars growing) or easing off (bars shrinking)—even if you're still moving forward.</p>

<hr class="border-[#2a2e39] my-8">

<h2 id="3-market-standards">3. Market Standards</h2>

<h3 id="default-parameters">Default Parameters</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Parameter</td><td class="px-4 py-2 border-b border-[#2a2e39]">Standard Value</td><td class="px-4 py-2 border-b border-[#2a2e39]">Rationale</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Fast EMA</td><td class="px-4 py-2 border-b border-[#2a2e39]">12</td><td class="px-4 py-2 border-b border-[#2a2e39]">Originally two trading weeks (6-day weeks in 1979)</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Slow EMA</td><td class="px-4 py-2 border-b border-[#2a2e39]">26</td><td class="px-4 py-2 border-b border-[#2a2e39]">Approximately one trading month</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Signal EMA</td><td class="px-4 py-2 border-b border-[#2a2e39]">9</td><td class="px-4 py-2 border-b border-[#2a2e39]">Smooths MACD for crossover signals</td></tr>
</table></div>

<h3 id="alternative-settings">Alternative Settings</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Trading Style</td><td class="px-4 py-2 border-b border-[#2a2e39]">Settings (Fast, Slow, Signal)</td><td class="px-4 py-2 border-b border-[#2a2e39]">Use Case</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Scalping</td><td class="px-4 py-2 border-b border-[#2a2e39]">(5, 35, 5)</td><td class="px-4 py-2 border-b border-[#2a2e39]">Higher sensitivity, more signals</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Swing Trading</td><td class="px-4 py-2 border-b border-[#2a2e39]">(12, 26, 9)</td><td class="px-4 py-2 border-b border-[#2a2e39]">Standard balanced approach</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Position Trading</td><td class="px-4 py-2 border-b border-[#2a2e39]">(19, 39, 9)</td><td class="px-4 py-2 border-b border-[#2a2e39]">Smoother, fewer false signals</td></tr>
</table></div>

<h3 id="timeframe-recommendations">Timeframe Recommendations</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Trading Style</td><td class="px-4 py-2 border-b border-[#2a2e39]">Timeframe</td><td class="px-4 py-2 border-b border-[#2a2e39]">Notes</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Day Trading</td><td class="px-4 py-2 border-b border-[#2a2e39]">5-min to 1-hour</td><td class="px-4 py-2 border-b border-[#2a2e39]">Use (5, 35, 5) for sensitivity</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Swing Trading</td><td class="px-4 py-2 border-b border-[#2a2e39]">Daily</td><td class="px-4 py-2 border-b border-[#2a2e39]">Standard (12, 26, 9) works best</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Position Trading</td><td class="px-4 py-2 border-b border-[#2a2e39]">Daily/Weekly</td><td class="px-4 py-2 border-b border-[#2a2e39]">Consider (19, 39, 9)</td></tr>
</table></div>

<hr class="border-[#2a2e39] my-8">

<h2 id="4-market-context">4. Market Context</h2>

<h3 id="best-conditions">Best Conditions</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Condition</td><td class="px-4 py-2 border-b border-[#2a2e39]">Why It Works</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Strong Trending Markets</td><td class="px-4 py-2 border-b border-[#2a2e39]">MACD excels at capturing sustained directional moves</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Post-Consolidation Breakouts</td><td class="px-4 py-2 border-b border-[#2a2e39]">Histogram expansion signals new trend birth</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Clear Bull/Bear Phases</td><td class="px-4 py-2 border-b border-[#2a2e39]">Crossovers provide reliable entry/exit timing</td></tr>
</table></div>

<h3 id="limitations">Limitations</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Condition</td><td class="px-4 py-2 border-b border-[#2a2e39]">Problem</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Sideways/Choppy Markets</td><td class="px-4 py-2 border-b border-[#2a2e39]">Generates whipsaw signals causing consecutive losses</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Fast V-Shaped Reversals</td><td class="px-4 py-2 border-b border-[#2a2e39]">Lagging nature misses first 10-15% of moves</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Low Volatility Periods</td><td class="px-4 py-2 border-b border-[#2a2e39]">Flat MACD produces meaningless crossovers</td></tr>
</table></div>

<h3 id="asset-class-suitability">Asset Class Suitability</h3>

<p class="mb-4">- Equities — Excellent for trending stocks and indices</p>
<p class="mb-4">- Forex — Works well on major pairs with clear trends</p>
<p class="mb-4">- Futures/Commodities — Strong performer in trending markets</p>
<p class="mb-4">- Crypto — Works but requires faster settings due to 24/7 volatility</p>

<hr class="border-[#2a2e39] my-8">

<h2 id="5-entry-signals">5. Entry Signals</h2>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Signal Type</td><td class="px-4 py-2 border-b border-[#2a2e39]">Condition</td><td class="px-4 py-2 border-b border-[#2a2e39]">Direction</td><td class="px-4 py-2 border-b border-[#2a2e39]">Strength</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Golden Cross</td><td class="px-4 py-2 border-b border-[#2a2e39]">MACD crosses above Signal Line</td><td class="px-4 py-2 border-b border-[#2a2e39]">Bullish</td><td class="px-4 py-2 border-b border-[#2a2e39]">Strong</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Dead Cross</td><td class="px-4 py-2 border-b border-[#2a2e39]">MACD crosses below Signal Line</td><td class="px-4 py-2 border-b border-[#2a2e39]">Bearish</td><td class="px-4 py-2 border-b border-[#2a2e39]">Strong</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Zero Line Bullish</td><td class="px-4 py-2 border-b border-[#2a2e39]">MACD crosses above Zero</td><td class="px-4 py-2 border-b border-[#2a2e39]">Bullish Confirmation</td><td class="px-4 py-2 border-b border-[#2a2e39]">Moderate</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Zero Line Bearish</td><td class="px-4 py-2 border-b border-[#2a2e39]">MACD crosses below Zero</td><td class="px-4 py-2 border-b border-[#2a2e39]">Bearish Confirmation</td><td class="px-4 py-2 border-b border-[#2a2e39]">Moderate</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Bullish Divergence</td><td class="px-4 py-2 border-b border-[#2a2e39]">Price Lower Low + MACD Higher Low</td><td class="px-4 py-2 border-b border-[#2a2e39]">Reversal Warning</td><td class="px-4 py-2 border-b border-[#2a2e39]">Strong</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Bearish Divergence</td><td class="px-4 py-2 border-b border-[#2a2e39]">Price Higher High + MACD Lower High</td><td class="px-4 py-2 border-b border-[#2a2e39]">Reversal Warning</td><td class="px-4 py-2 border-b border-[#2a2e39]">Strong</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Histogram Reversal</td><td class="px-4 py-2 border-b border-[#2a2e39]">Histogram bars shrinking after peak</td><td class="px-4 py-2 border-b border-[#2a2e39]">Early Exit Warning</td><td class="px-4 py-2 border-b border-[#2a2e39]">Moderate</td></tr>
</table></div>

<h3 id="primary-buy-signal">Primary Buy Signal</h3>

<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-">
IF MACD_Line crosses above Signal_Line
AND MACD_Line &lt; 0 (oversold territory)
AND Histogram &gt; Histogram[1] (momentum increasing)
THEN → BUY
</code></pre>

<h3 id="primary-sell/exit-signal">Primary Sell/Exit Signal</h3>

<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-">
IF MACD_Line crosses below Signal_Line
OR MACD_Line &gt; 0 AND Histogram &lt; Histogram[1] (momentum fading)
THEN → EXIT/SELL
</code></pre>

<hr class="border-[#2a2e39] my-8">

<h2 id="6-filter-usage">6. Filter Usage</h2>

<p class="mb-4">MACD works best as a trend confirmation tool rather than a standalone entry trigger. Use it to validate the direction before employing timing indicators.</p>

<h3 id="filter-rules">Filter Rules</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Rule</td><td class="px-4 py-2 border-b border-[#2a2e39]">Application</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]"><code>MACD > Signal</code></td><td class="px-4 py-2 border-b border-[#2a2e39]">Only take long entries from other indicators</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]"><code>MACD < Signal</code></td><td class="px-4 py-2 border-b border-[#2a2e39]">Only take short entries from other indicators</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]"><code>MACD > 0</code></td><td class="px-4 py-2 border-b border-[#2a2e39]">Market in bullish territory</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]"><code>Histogram expanding</code></td><td class="px-4 py-2 border-b border-[#2a2e39]">Momentum accelerating, safe to add positions</td></tr>
</table></div>

<h3 id="recommended-pairings">Recommended Pairings</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Partner Indicator</td><td class="px-4 py-2 border-b border-[#2a2e39]">Synergy Logic</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Stochastic Oscillator</td><td class="px-4 py-2 border-b border-[#2a2e39]">MACD defines trend; Stochastic times pullback entries</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">ADX</td><td class="px-4 py-2 border-b border-[#2a2e39]">Filter MACD signals: only trade when ADX > 25</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">RSI</td><td class="px-4 py-2 border-b border-[#2a2e39]">Confirm divergences with RSI divergence</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Bollinger Bands</td><td class="px-4 py-2 border-b border-[#2a2e39]">MACD for direction; Bands for volatility context</td></tr>
</table></div>

<h3 id="example-combined-strategy">Example Combined Strategy</h3>

<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-">
ENTRY CONDITIONS:
&nbsp;&nbsp;MACD_Line &gt; Signal_Line               // Bullish trend active
&nbsp;&nbsp;MACD_Line &lt; 0                         // Still in oversold zone
&nbsp;&nbsp;Stochastic drops below 20             // Pullback occurring
&nbsp;&nbsp;Stochastic crosses above 20           // Pullback ending

ACTION: BUY on the pullback within a confirmed uptrend
</code></pre>

<hr class="border-[#2a2e39] my-8">

<h2 id="7-practical-cautions">7. Practical Cautions</h2>

<h3 id="lag-characteristics">Lag Characteristics</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Component</td><td class="px-4 py-2 border-b border-[#2a2e39]">Approximate Lag</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">First Valid MACD</td><td class="px-4 py-2 border-b border-[#2a2e39]">~26 bars (Slow Period)</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">First Valid Signal</td><td class="px-4 py-2 border-b border-[#2a2e39]">~35 bars (26 + 9)</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">First Valid Histogram</td><td class="px-4 py-2 border-b border-[#2a2e39]">~35 bars</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Signal Responsiveness</td><td class="px-4 py-2 border-b border-[#2a2e39]">3-8 bars after trend begins</td></tr>
</table></div>

<blockquote class="border-l-4 border-gray-300 pl-4 italic text-gray-700 my-4 bg-gray-50 py-2 pr-2 rounded-r">Reality Check: MACD is a lagging indicator by design. By the time you get a Golden Cross, price has already moved. Use the Histogram for earlier signals.</blockquote>

<h3 id="false-signal-scenarios">False Signal Scenarios</h3>

<p class="mb-4">1. Whipsaws in Ranging Markets  </p>
<p class="mb-4">   Multiple crossovers in sideways action destroy capital. Filter with ADX > 25.</p>

<p class="mb-4">2. The "Hollow Rally" Trap  </p>
<p class="mb-4">   Price rises but Histogram shrinks—momentum is fading despite bullish crossover.</p>

<p class="mb-4">3. Zero Line Hesitation  </p>
<p class="mb-4">   MACD hovers around zero creating multiple false signals. Wait for decisive movement.</p>

<h3 id="mitigation-strategies">Mitigation Strategies</h3>

<p class="mb-4">- ADX Filter: Only trade MACD signals when ADX > 25</p>
<p class="mb-4">- Zero Line Bias: Buy signals stronger below zero; sell signals stronger above</p>
<p class="mb-4">- Histogram Confirmation: Wait for 2-3 bars of histogram expansion before entry</p>

<hr class="border-[#2a2e39] my-8">

<h2 id="8-pro-insights">8. Pro Insights</h2>

<h3 id="the-histogram-slingshot">The Histogram Slingshot</h3>

<p class="mb-4">Most traders focus on line crossovers, but professionals watch the Histogram. When the Histogram makes a peak and starts declining—even while MACD is still above Signal—the "energy" is dissipating. This often precedes the actual crossover by 2-5 bars, giving you an early exit signal.</p>

<h3 id="the-zero-line-rejection">The Zero Line Rejection</h3>

<p class="mb-4">In strong trends, watch for MACD to pull back toward the zero line but bounce off rather than cross. This "Zero Line Rejection" is a high-probability continuation signal. The trend was strong enough to bring momentum back to neutral but not reverse it.</p>

<h3 id="divergence-hierarchy">Divergence Hierarchy</h3>

<p class="mb-4">Not all divergences are equal:</p>
<p class="mb-4">1. Hidden Divergence (trend continuation): Price makes higher low but MACD makes lower low → trend resumption</p>
<p class="mb-4">2. Regular Divergence (reversal): Price makes lower low but MACD makes higher low → potential reversal</p>
<p class="mb-4">3. Triple Divergence: Three divergent swings dramatically increase reversal probability</p>

<h3 id="multi-timeframe-confirmation">Multi-Timeframe Confirmation</h3>

<p class="mb-4">Check MACD direction on a higher timeframe before trading the lower timeframe:</p>
<p class="mb-4">- Daily MACD bullish + 4-hour MACD Golden Cross = High-probability long</p>
<p class="mb-4">- Weekly MACD bearish + Daily crossover down = Strong short confirmation</p>

<hr class="border-[#2a2e39] my-8">

<h2 id="9-summary">9. Summary</h2>

<blockquote class="border-l-4 border-gray-300 pl-4 italic text-gray-700 my-4 bg-gray-50 py-2 pr-2 rounded-r">"MACD is your market's heartbeat monitor—the crossover tells you the pulse changed, but the histogram reveals whether the heart is beating stronger or about to flatline."</blockquote>

<p class="mb-4"><h2 class="text-2xl font-bold mt-12 mb-6 border-b pb-2">PART 2: SUPPLEMENTARY GUIDE</h2></p>

<h2 id="1-core-concept">1. Core Concept</h2>

<p class="mb-4">MACD answers one fundamental question: "Is momentum accelerating or decelerating?"</p>

<p class="mb-4">While moving averages tell you the trend's direction, MACD reveals the trend's *velocity*. The MACD Line measures how far the fast average has pulled away from the slow average—like measuring the gap between a sprinter and a jogger. When this gap widens, momentum is building. When it narrows, momentum is fading.</p>

<p class="mb-4">The genius of MACD lies in converting two lagging trend-following indicators (EMAs) into a leading momentum indicator (the Histogram). The Histogram's direction often changes before the MACD Line crosses the Signal Line, providing an early warning system.</p>

<p class="mb-4">Think of it this way:</p>
<p class="mb-4">- MACD Line = How fast is the spread between averages changing?</p>
<p class="mb-4">- Signal Line = What's the average speed of that change?</p>
<p class="mb-4">- Histogram = Is the change accelerating or decelerating?</p>

<hr class="border-[#2a2e39] my-8">

<h2 id="2-statistical-edge">2. Statistical Edge</h2>

<h3 id="backtest-evidence">Backtest Evidence</h3>

<p class="mb-4">Studies on MACD strategies show:</p>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Metric</td><td class="px-4 py-2 border-b border-[#2a2e39]">MACD Crossover Only</td><td class="px-4 py-2 border-b border-[#2a2e39]">With ADX > 25 Filter</td><td class="px-4 py-2 border-b border-[#2a2e39]">With Divergence Confirmation</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Win Rate</td><td class="px-4 py-2 border-b border-[#2a2e39]">45%</td><td class="px-4 py-2 border-b border-[#2a2e39]">54%</td><td class="px-4 py-2 border-b border-[#2a2e39]">62%</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Profit Factor</td><td class="px-4 py-2 border-b border-[#2a2e39]">1.2</td><td class="px-4 py-2 border-b border-[#2a2e39]">1.5</td><td class="px-4 py-2 border-b border-[#2a2e39]">1.9</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Max Drawdown</td><td class="px-4 py-2 border-b border-[#2a2e39]">-40%</td><td class="px-4 py-2 border-b border-[#2a2e39]">-28%</td><td class="px-4 py-2 border-b border-[#2a2e39]">-22%</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Trades/Year</td><td class="px-4 py-2 border-b border-[#2a2e39]">High</td><td class="px-4 py-2 border-b border-[#2a2e39]">Moderate</td><td class="px-4 py-2 border-b border-[#2a2e39]">Low</td></tr>
</table></div>

<h3 id="why-it-works">Why It Works</h3>

<p class="mb-4">The statistical edge comes from momentum persistence. Academic research (Jegadeesh & Titman, 1993) shows that assets that outperform tend to continue outperforming for 3-12 months. MACD captures this momentum effect by identifying when short-term performance diverges from longer-term trends.</p>

<h3 id="academic-reference">Academic Reference</h3>

<p class="mb-4">Gerald Appel's original research was published in his 1979 book *The Moving Average Convergence-Divergence Trading Method*. Thomas Aspray's Histogram enhancement appeared in *Technical Analysis of Stocks & Commodities* magazine in 1986, addressing the lag problem in crossover signals.</p>

<hr class="border-[#2a2e39] my-8">

<h2 id="3-actionable-strategy">3. Actionable Strategy</h2>

<h3 id="strategy-name:-"macd-hook-entry"">Strategy Name: "MACD Hook Entry"</h3>

<p class="mb-4">Concept: Enter trending markets on momentum pullbacks using MACD and Stochastic coordination.</p>

<p class="mb-4">Setup Requirements:</p>
<p class="mb-4">1. MACD Line > Signal Line (bullish trend active)</p>
<p class="mb-4">2. MACD Line < 0 (still in oversold territory)</p>
<p class="mb-4">3. ADX(14) > 25 (trend strength confirmed)</p>

<p class="mb-4">Entry Trigger:</p>
<p class="mb-4">- Stochastic %K drops below 20 (oversold pullback)</p>
<p class="mb-4">- Stochastic %K crosses back above 20 (reversal)</p>

<p class="mb-4">Position Sizing:</p>
<p class="mb-4">- Full size when Histogram expanding</p>
<p class="mb-4">- Half size when Histogram flat</p>

<p class="mb-4">Exit Rules:</p>
<p class="mb-4">1. Primary Exit: MACD Line crosses below Signal Line</p>
<p class="mb-4">2. Early Exit: Histogram makes 3 consecutive lower bars</p>
<p class="mb-4">3. Stop Loss: 2× ATR(14) below entry</p>
<p class="mb-4">4. Profit Target: 3:1 risk-reward or trail with Histogram</p>

<p class="mb-4">Example:</p>
<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-">
Stock XYZ shows:
&nbsp;&nbsp;MACD = -0.50, Signal = -0.65 (MACD &gt; Signal ✓)
&nbsp;&nbsp;MACD &lt; 0 (oversold territory ✓)
&nbsp;&nbsp;ADX = 28 (trending ✓)
&nbsp;&nbsp;Stochastic drops to 18, crosses above 20 → ENTRY

Position: Full size (Histogram expanding)
Stop: Entry - 2×ATR
Exit: When MACD &lt; Signal or Histogram shrinks
</code></pre>

<hr class="border-[#2a2e39] my-8">

<h2 id="4-risks-&-limitations">4. Risks & Limitations</h2>

<h3 id="failure-patterns">Failure Patterns</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Pattern</td><td class="px-4 py-2 border-b border-[#2a2e39]">Description</td><td class="px-4 py-2 border-b border-[#2a2e39]">Mitigation</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Ranging Market Whipsaws</td><td class="px-4 py-2 border-b border-[#2a2e39]">Multiple crossovers in tight range</td><td class="px-4 py-2 border-b border-[#2a2e39]">ADX filter: only trade when ADX > 25</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Late Entry Problem</td><td class="px-4 py-2 border-b border-[#2a2e39]">By crossover, first 10-15% already gone</td><td class="px-4 py-2 border-b border-[#2a2e39]">Use Histogram reversal for earlier signals</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Divergence False Positives</td><td class="px-4 py-2 border-b border-[#2a2e39]">Divergence can persist for weeks</td><td class="px-4 py-2 border-b border-[#2a2e39]">Require price pattern confirmation</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">EMA Startup Ghosting</td><td class="px-4 py-2 border-b border-[#2a2e39]">First 100+ bars show unstable values</td><td class="px-4 py-2 border-b border-[#2a2e39]">Ignore signals in first 150 bars of data</td></tr>
</table></div>

<h3 id="psychological-traps">Psychological Traps</h3>

<p class="mb-4">1. The "It's Still Bullish" Trap  </p>
<p class="mb-4">   MACD above Signal feels safe, but shrinking Histogram warns of fading momentum. Don't hold too long.</p>

<p class="mb-4">2. Divergence Impatience  </p>
<p class="mb-4">   Spotting a divergence doesn't mean acting immediately. Wait for price structure break.</p>

<p class="mb-4">3. Overtrading Crossovers  </p>
<p class="mb-4">   Each crossover feels significant. In reality, 40-50% fail in normal markets. Be selective.</p>

<h3 id="common-misinterpretations">Common Misinterpretations</h3>

<p class="mb-4">- "MACD above zero means buy" → It shows bulls in control, not entry timing</p>
<p class="mb-4">- "Bigger Histogram = stronger signal" → Extreme Histogram often precedes reversal</p>
<p class="mb-4">- "Crossover is the entry" → It's confirmation; Histogram reversal is the early signal</p>

<hr class="border-[#2a2e39] my-8">

<h2 id="5-further-study">5. Further Study</h2>

<h3 id="creator-attribution">Creator Attribution</h3>

<p class="mb-4">Gerald Appel developed MACD in 1979 as a money manager seeking a systematic approach to momentum. His psychology background influenced his understanding of market crowd behavior. Thomas Aspray added the Histogram in 1986 to address crossover lag.</p>

<h3 id="parent/child-indicators">Parent/Child Indicators</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Indicator</td><td class="px-4 py-2 border-b border-[#2a2e39]">Relationship</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">EMA</td><td class="px-4 py-2 border-b border-[#2a2e39]">Foundation — MACD is the difference of two EMAs</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">PPO</td><td class="px-4 py-2 border-b border-[#2a2e39]">Sibling — Percentage version of MACD for cross-asset comparison</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">MACD Histogram</td><td class="px-4 py-2 border-b border-[#2a2e39]">Child — The derivative of MACD for leading signals</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Signal Line</td><td class="px-4 py-2 border-b border-[#2a2e39]">Child — EMA of MACD for crossover triggers</td></tr>
</table></div>

<h3 id="recommended-readings">Recommended Readings</h3>

<p class="mb-4">1. *The Moving Average Convergence-Divergence Trading Method* — Gerald Appel</p>
<p class="mb-4">2. *Technical Analysis of the Financial Markets* — John J. Murphy</p>
<p class="mb-4">3. *Trading for a Living* — Dr. Alexander Elder (MACD Histogram analysis)</p>

<hr class="border-[#2a2e39] my-8">

<h3 id="55-related-indicators-comparison">5.5 Related Indicators Comparison</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Feature</td><td class="px-4 py-2 border-b border-[#2a2e39]">MACD</td><td class="px-4 py-2 border-b border-[#2a2e39]">PPO</td><td class="px-4 py-2 border-b border-[#2a2e39]">RSI</td><td class="px-4 py-2 border-b border-[#2a2e39]">Stochastic</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Type</td><td class="px-4 py-2 border-b border-[#2a2e39]">Momentum</td><td class="px-4 py-2 border-b border-[#2a2e39]">Momentum</td><td class="px-4 py-2 border-b border-[#2a2e39]">Momentum</td><td class="px-4 py-2 border-b border-[#2a2e39]">Momentum</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Bounded</td><td class="px-4 py-2 border-b border-[#2a2e39]">No</td><td class="px-4 py-2 border-b border-[#2a2e39]">No</td><td class="px-4 py-2 border-b border-[#2a2e39]">Yes (0-100)</td><td class="px-4 py-2 border-b border-[#2a2e39]">Yes (0-100)</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Best For</td><td class="px-4 py-2 border-b border-[#2a2e39]">Trend confirmation</td><td class="px-4 py-2 border-b border-[#2a2e39]">Cross-asset comparison</td><td class="px-4 py-2 border-b border-[#2a2e39]">Overbought/Oversold</td><td class="px-4 py-2 border-b border-[#2a2e39]">Entry timing</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Lag</td><td class="px-4 py-2 border-b border-[#2a2e39]">Moderate</td><td class="px-4 py-2 border-b border-[#2a2e39]">Moderate</td><td class="px-4 py-2 border-b border-[#2a2e39]">Low</td><td class="px-4 py-2 border-b border-[#2a2e39]">Low</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Divergence Use</td><td class="px-4 py-2 border-b border-[#2a2e39]">Strong</td><td class="px-4 py-2 border-b border-[#2a2e39]">Strong</td><td class="px-4 py-2 border-b border-[#2a2e39]">Strong</td><td class="px-4 py-2 border-b border-[#2a2e39]">Moderate</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Default Period</td><td class="px-4 py-2 border-b border-[#2a2e39]">12, 26, 9</td><td class="px-4 py-2 border-b border-[#2a2e39]">12, 26, 9</td><td class="px-4 py-2 border-b border-[#2a2e39]">14</td><td class="px-4 py-2 border-b border-[#2a2e39]">14, 3, 3</td></tr>
</table></div>

<p class="mb-4">When to Use Which:</p>
<p class="mb-4">- MACD — Trend direction and momentum confirmation on single assets</p>
<p class="mb-4">- PPO — Same as MACD but for comparing momentum across different-priced assets</p>
<p class="mb-4">- RSI — Overbought/oversold extremes and divergence detection</p>
<p class="mb-4">- Stochastic — Precise entry timing on pullbacks within trends</p>

<p class="mb-4"><h2 class="text-2xl font-bold mt-12 mb-6 border-b pb-2">PART 3: ADVANCED SIGNAL REFERENCE</h2></p>

<h2 id="advanced-signal-reference">Advanced Signal Reference</h2>

<h3 id="threshold-matrix">Threshold Matrix</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">MACD Position</td><td class="px-4 py-2 border-b border-[#2a2e39]">Histogram State</td><td class="px-4 py-2 border-b border-[#2a2e39]">Market Interpretation</td><td class="px-4 py-2 border-b border-[#2a2e39]">Action</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">MACD < 0, Signal < 0</td><td class="px-4 py-2 border-b border-[#2a2e39]">Expanding Down</td><td class="px-4 py-2 border-b border-[#2a2e39]">Strong bearish momentum</td><td class="px-4 py-2 border-b border-[#2a2e39]">Avoid longs; consider shorts</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">MACD < 0, Signal < 0</td><td class="px-4 py-2 border-b border-[#2a2e39]">Shrinking</td><td class="px-4 py-2 border-b border-[#2a2e39]">Selling pressure easing</td><td class="px-4 py-2 border-b border-[#2a2e39]">Watch for bottoming signals</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">MACD > Signal, MACD < 0</td><td class="px-4 py-2 border-b border-[#2a2e39]">Expanding Up</td><td class="px-4 py-2 border-b border-[#2a2e39]">Bullish crossover in oversold</td><td class="px-4 py-2 border-b border-[#2a2e39]">Strong buy zone</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">MACD > Signal, MACD > 0</td><td class="px-4 py-2 border-b border-[#2a2e39]">Expanding Up</td><td class="px-4 py-2 border-b border-[#2a2e39]">Bullish acceleration</td><td class="px-4 py-2 border-b border-[#2a2e39]">Trail stops, don't add</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">MACD > Signal, MACD > 0</td><td class="px-4 py-2 border-b border-[#2a2e39]">Shrinking</td><td class="px-4 py-2 border-b border-[#2a2e39]">Momentum fading</td><td class="px-4 py-2 border-b border-[#2a2e39]">Prepare to exit</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">MACD < Signal, MACD > 0</td><td class="px-4 py-2 border-b border-[#2a2e39]">Expanding Down</td><td class="px-4 py-2 border-b border-[#2a2e39]">Bearish crossover in overbought</td><td class="px-4 py-2 border-b border-[#2a2e39]">Strong sell/short zone</td></tr>
</table></div>

<h3 id="signal-patterns">Signal Patterns</h3>

<h4 id="buy-signal-golden-cross">Buy Signal (Golden Cross)</h4>
<p class="mb-4">This signal triggers when the MACD line crosses above the Signal line, indicating a shift from bearish to bullish momentum. The signal is strongest when the crossover occurs in oversold territory (MACD < 0) with expanding histogram bars confirming accelerating upward momentum. Reliability increases when combined with ADX > 25 to filter out sideways market whipsaws.</p>

<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-python">
def macd_buy_signal(macd, signal, histogram):
&nbsp;&nbsp;&nbsp;&nbsp;condition_1 = macd &gt; signal                    # MACD above Signal
&nbsp;&nbsp;&nbsp;&nbsp;condition_2 = macd_prev &lt;= signal_prev         # Just crossed (was below)
&nbsp;&nbsp;&nbsp;&nbsp;condition_3 = histogram &gt; histogram_prev       # Momentum building
&nbsp;&nbsp;&nbsp;&nbsp;condition_4 = macd &lt; 0                         # Oversold territory (bonus)
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;return condition_1 and condition_2 and condition_3
</code></pre>

<h4 id="sell/exit-signal-dead-cross">Sell/Exit Signal (Dead Cross)</h4>
<p class="mb-4">This exit signal identifies when bullish momentum is fading, either through a direct bearish crossover or through consecutive declining histogram bars. The signal is particularly reliable when MACD is in overbought territory (above zero) and the histogram has turned negative while MACD remains above Signal. Early exits can be taken on momentum fade before the actual crossover occurs.</p>

<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-python">
def macd_exit_signal(macd, signal, histogram):
&nbsp;&nbsp;&nbsp;&nbsp;dead_cross = macd &lt; signal and macd_prev &gt;= signal_prev
&nbsp;&nbsp;&nbsp;&nbsp;momentum_fade = histogram &lt; histogram_prev and histogram_prev &lt; histogram_prev2
&nbsp;&nbsp;&nbsp;&nbsp;extreme_overbought = macd &gt; 0 and histogram &lt; 0
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;return dead_cross or (momentum_fade and macd &gt; signal)
</code></pre>

<h4 id="divergence-detection">Divergence Detection</h4>
<p class="mb-4">Bullish divergence occurs when price makes a lower low while MACD makes a higher low, signaling that selling pressure is weakening despite continued price decline. This pattern often precedes trend reversals and is one of the most powerful MACD signals. The divergence is most reliable when confirmed by a subsequent MACD crossover above the Signal line within 3-5 bars.</p>

<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-python">
def macd_bullish_divergence(prices, macd):
&nbsp;&nbsp;&nbsp;&nbsp;price_lower_low = prices[-1] &lt; min(prices[-20:-1])
&nbsp;&nbsp;&nbsp;&nbsp;macd_higher_low = macd[-1] &gt; min(macd[-20:-1])
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;return price_lower_low and macd_higher_low
</code></pre>

<h3 id="screening-filters">Screening Filters</h3>

<h4 id="classic-bullish-scan">Classic Bullish Scan</h4>
<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-">
MACD_Line(12, 26) &gt; Signal_Line(9)
AND MACD_Histogram &gt; MACD_Histogram[1]
AND MACD_Line &lt; 0
AND ADX(14) &gt; 25
</code></pre>

<h4 id="momentum-acceleration-scan">Momentum Acceleration Scan</h4>
<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-">
MACD_Histogram &gt; MACD_Histogram[1]
AND MACD_Histogram[1] &gt; MACD_Histogram[2]
AND MACD_Line &gt; Signal_Line
</code></pre>

<h4 id="divergence-scanner">Divergence Scanner</h4>
<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-">
Close &lt; Lowest(Close, 20)
AND MACD_Line &gt; Lowest(MACD_Line, 20)
AND MACD_Line crosses above Signal_Line within 3 bars
</code></pre>

<h3 id="combination-strategies">Combination Strategies</h3>

<h4 id="macd-+-stochastic-pullback-strategy">MACD + Stochastic Pullback Strategy</h4>
<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-">
SETUP:
&nbsp;&nbsp;MACD_Line(12, 26) &gt; Signal_Line(9)
&nbsp;&nbsp;MACD_Line &lt; 0
&nbsp;&nbsp;ADX(14) &gt; 25

ENTRY:
&nbsp;&nbsp;Stochastic_K(14, 3) crosses above 20 from below

STOP_LOSS:
&nbsp;&nbsp;2 × ATR(14) below entry

TAKE_PROFIT:
&nbsp;&nbsp;MACD_Line crosses below Signal_Line
&nbsp;&nbsp;OR 3 × ATR(14) above entry
</code></pre>

<h4 id="macd-+-bollinger-band-reversal">MACD + Bollinger Band Reversal</h4>
<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-">
FILTER:
&nbsp;&nbsp;MACD_Histogram &lt; 0 for 5+ bars (selling exhausted)

ENTRY:
&nbsp;&nbsp;Price touches Lower Bollinger Band
&nbsp;&nbsp;AND MACD_Histogram starts turning up (less negative)

TRAIL:
&nbsp;&nbsp;Exit when MACD_Histogram turns negative again
</code></pre>

<h4 id="macd-+-rsi-confirmation">MACD + RSI Confirmation</h4>
<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-">
FILTER:
&nbsp;&nbsp;MACD_Line &gt; Signal_Line

ENTRY:
&nbsp;&nbsp;RSI(14) drops below 30
&nbsp;&nbsp;RSI(14) crosses back above 30

EXIT:
&nbsp;&nbsp;RSI &gt; 70 OR MACD crosses below Signal
</code></pre>





                    </div>
                </article>
                <!-- Right: Sticky TOC -->
                <aside class="lg:block w-64 flex-shrink-0">
                    <div class="sticky top-24">
                        <h3 class="font-bold text-slate-900 mb-4 pb-2 border-b border-slate-100 text-sm uppercase tracking-wider">
                            On this page
                        </h3>
                        <nav id="toc-nav" class="space-y-1 text-sm text-slate-600">
                            <a href="#1-identity" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">1. Identity</a>
<a href="#2-calculation-logic" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">2. Calculation Logic</a>
<a href="#formula" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Formula</a>
<a href="#real-world-analogy" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Real-World Analogy</a>
<a href="#3-market-standards" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">3. Market Standards</a>
<a href="#default-parameters" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Default Parameters</a>
<a href="#alternative-settings" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Alternative Settings</a>
<a href="#timeframe-recommendations" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Timeframe Recommendations</a>
<a href="#4-market-context" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">4. Market Context</a>
<a href="#best-conditions" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Best Conditions</a>
<a href="#limitations" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Limitations</a>
<a href="#asset-class-suitability" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Asset Class Suitability</a>
<a href="#5-entry-signals" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">5. Entry Signals</a>
<a href="#primary-buy-signal" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Primary Buy Signal</a>
<a href="#primary-sell/exit-signal" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Primary Sell/Exit Signal</a>
<a href="#6-filter-usage" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">6. Filter Usage</a>
<a href="#filter-rules" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Filter Rules</a>
<a href="#recommended-pairings" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Recommended Pairings</a>
<a href="#example-combined-strategy" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Example Combined Strategy</a>
<a href="#7-practical-cautions" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">7. Practical Cautions</a>
<a href="#lag-characteristics" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Lag Characteristics</a>
<a href="#false-signal-scenarios" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">False Signal Scenarios</a>
<a href="#mitigation-strategies" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Mitigation Strategies</a>
<a href="#8-pro-insights" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">8. Pro Insights</a>
<a href="#the-histogram-slingshot" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">The Histogram Slingshot</a>
<a href="#the-zero-line-rejection" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">The Zero Line Rejection</a>
<a href="#divergence-hierarchy" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Divergence Hierarchy</a>
<a href="#multi-timeframe-confirmation" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Multi-Timeframe Confirmation</a>
<a href="#9-summary" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">9. Summary</a>
<a href="#1-core-concept" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">1. Core Concept</a>
<a href="#2-statistical-edge" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">2. Statistical Edge</a>
<a href="#backtest-evidence" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Backtest Evidence</a>
<a href="#why-it-works" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Why It Works</a>
<a href="#academic-reference" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Academic Reference</a>
<a href="#3-actionable-strategy" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">3. Actionable Strategy</a>
<a href="#strategy-name:-"macd-hook-entry"" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Strategy Name: "MACD Hook Entry"</a>
<a href="#4-risks-&-limitations" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">4. Risks & Limitations</a>
<a href="#failure-patterns" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Failure Patterns</a>
<a href="#psychological-traps" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Psychological Traps</a>
<a href="#common-misinterpretations" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Common Misinterpretations</a>
<a href="#5-further-study" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">5. Further Study</a>
<a href="#creator-attribution" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Creator Attribution</a>
<a href="#parent/child-indicators" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Parent/Child Indicators</a>
<a href="#recommended-readings" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Recommended Readings</a>
<a href="#55-related-indicators-comparison" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">5.5 Related Indicators Comparison</a>
<a href="#advanced-signal-reference" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">Advanced Signal Reference</a>
<a href="#threshold-matrix" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Threshold Matrix</a>
<a href="#signal-patterns" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Signal Patterns</a>
<a href="#screening-filters" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Screening Filters</a>
<a href="#combination-strategies" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Combination Strategies</a>

                        </nav>
                        <div class="mt-8 pt-4 border-t border-slate-100">
                            <a href="#" class="text-xs text-slate-400 hover:text-indigo-600 flex items-center transition-colors">
                                Back to Top
                            </a>
                        </div>
                    </div>
                </aside>
            </div>
        </section>


    </div>


        <!-- Footer -->
    <footer class="bg-white border-t border-slate-200 mt-12">
        <div class="max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8">
            <p class="text-center text-slate-400 text-sm">
                &copy; 2023-2025 I ant I Investigates. All rights reserved.
            </p>
        </div>
    </footer>
        <!-- ========================================== -->
    <!-- 1. DATA & LOGIC INJECTION                  -->
    <!-- ========================================== -->
    <script>
        window.IndicatorLogic = {
            name: "MovingAverageConvergenceDivergence",
            params: [],
            calculate: null
        };
        (function() {
            try {
                const injectedCode = `
        window.IndicatorLogic = {
            calculate: (data, params) => {
                const shortPeriod = params.shortPeriod || 12;
                const longPeriod = params.longPeriod || 26;
                const signalPeriod = params.signalPeriod || 9;
                const result = MovingAverageConvergenceDivergence.calculate(data, shortPeriod, longPeriod, signalPeriod);
                // Handle both array and object returns
                if (Array.isArray(result)) {
                    return { main: result };
                }
                return result;
            }
        };
        `;
                const isTemplatePlaceholder = injectedCode.includes('{{') && injectedCode.includes('CODE_INDICATOR_LOGIC');
                if (injectedCode && injectedCode.trim().length > 0 && !isTemplatePlaceholder) {
                    new Function(injectedCode)();
                } else {
                    console.warn("Playground Logic: Running in Preview/Fallback mode.");
                    window.IndicatorLogic.calculate = () => []; 
                }
            } catch (e) {
                console.error("Critical Error in Logic Injection:", e);
                window.IndicatorLogic.calculate = () => [];
            }
        })();
    </script>

    <!-- ========================================== -->
    <!-- 2. VISUALIZATION ENGINE                    -->
    <!-- ========================================== -->
    <script>
        mermaid.initialize({ startOnLoad: false, theme: 'neutral', securityLevel: 'loose' });
    </script>
    <!-- ========================================== -->
    <!-- 3. UI CONTROLLERS & APP INITIALIZATION     -->
    <!-- ========================================== -->
    <!-- INLINE UI CONTROLLERS (PORTED FROM 0117) -->
    <script src="../assets/js/MovingAverageConvergenceDivergence.js"></script>
    <!-- JSON Data Containers (XSS-safe) -->
    <script id="data-indicator-config" type="application/json">
[{"id": "shortPeriod", "label": "Shortperiod (12)", "type": "number", "value": 12, "min": 2, "max": 100}, {"id": "longPeriod", "label": "Longperiod (26)", "type": "number", "value": 26, "min": 2, "max": 100}, {"id": "signalPeriod", "label": "Signalperiod (9)", "type": "number", "value": 9, "min": 2, "max": 100}]
    </script>
    <script id="data-indicator-display" type="application/json">
{"isOverlay": false, "plots": {"macd": {"label": "MACD Line", "color": "#3b82f6", "type": "line"}, "signal": {"label": "Signal Line", "color": "#ef4444", "type": "line"}, "histogram": {"label": "Histogram", "color": "#fbbf24", "type": "bar"}}}
    </script>
    <script>
        // --- 0. Indicator Data Injection ---
        // Use existing IndicatorLogic (set in earlier script block), only set if not exists
        var IndicatorLogic = window.IndicatorLogic || { calculate: null };
        var IndicatorConfig = [];
        var IndicatorDisplay = { isOverlay: false, plots: {} };

        // 1. Library Code - loaded externally before this block

        // 2. Configuration (XSS-safe via script type="application/json")
        try {
            var configEl = document.getElementById('data-indicator-config');
            if(configEl && configEl.textContent.trim()) {
                IndicatorConfig = JSON.parse(configEl.textContent);
            }
        } catch(e){ console.warn('Config parse error', e); }

        try {
            var displayEl = document.getElementById('data-indicator-display');
            if(displayEl && displayEl.textContent.trim()) {
                IndicatorDisplay = JSON.parse(displayEl.textContent);
            }
        } catch(e){ console.warn('Display parse error', e); }

        // 3. Logic Adapter
        window.IndicatorLogic = {
            calculate: (data, params) => {
                const shortPeriod = params.shortPeriod || 12;
                const longPeriod = params.longPeriod || 26;
                const signalPeriod = params.signalPeriod || 9;
                const result = MovingAverageConvergenceDivergence.calculate(data, shortPeriod, longPeriod, signalPeriod);
                // Handle both array and object returns
                if (Array.isArray(result)) {
                    return { main: result };
                }
                return result;
            }
        };
    </script>

    <!-- UI Controllers: indicator.js loads first to define PlaygroundController -->
    <script src="../assets/js/indicator.js" defer></script>
    <!-- script.js loads second, skips PlaygroundController if already defined -->
    <script src="../assets/js/script.js" defer></script>

</body>
</html>