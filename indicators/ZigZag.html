<!DOCTYPE html>
<html lang="ja" class="scroll-smooth">
<head>
        <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZigZag - I ant I Investigates</title>
    <meta name="description" content="ZigZag - Technical Indicator">
    <meta name="keywords" content="ZigZag, technical indicator, stock analysis">
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3375094177283762"
         crossorigin="anonymous"></script>
    <!-- Canonical URL -->
    <link rel="canonical" href="https://akuro17.github.io/indicators/zigzag.html">
    <!-- OGP (Open Graph Protocol) -->
    <meta property="og:type" content="article">
    <meta property="og:title" content="ZigZag - I ant I Investigates">
    <meta property="og:description" content="ZigZag - Technical Indicator">
    <meta property="og:url" content="https://akuro17.github.io/indicators/zigzag.html">
    <meta property="og:site_name" content="I ant I Investigates">
    <meta property="og:image" content="https://akuro17.github.io/assets/images/ogp/zigzag.png">
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="ZigZag">
    <meta name="twitter:description" content="ZigZag - Technical Indicator">
    <meta name="twitter:image" content="https://akuro17.github.io/assets/images/ogp/zigzag.png">
    <!-- Structured Data for SEO -->
    <script type="application/ld+json">
        {
    "@context": "https://schema.org",
    "@graph": [
        {
            "@context": "https://schema.org",
            "@type": "TechArticle",
            "headline": "ZigZag Technical Indicator",
            "description": "The ZigZag Indicator is a noise filter that connects significant price points (Swing Highs and Swing Lows) with straight lines, ignoring price movements smaller than a specified deviation.",
            "image": "https://akuro17.github.io/assets/images/ogp/zigzag.png",
            "author": {
                "@type": "Organization",
                "name": "I ant I Investigates",
                "url": "https://akuro17.github.io"
            },
            "publisher": {
                "@type": "Organization",
                "name": "I ant I Investigates",
                "logo": {
                    "@type": "ImageObject",
                    "url": "https://akuro17.github.io/assets/images/logo.png"
                }
            },
            "mainEntityOfPage": {
                "@type": "WebPage",
                "@id": "https://akuro17.github.io/indicators/zigzag.html"
            },
            "about": {
                "@type": "SoftwareSourceCode",
                "name": "ZigZag Indicator Code",
                "programmingLanguage": [
                    "C#",
                    "Python"
                ]
            }
        },
        {
            "@context": "https://schema.org",
            "@type": "BreadcrumbList",
            "itemListElement": [
                {
                    "@type": "ListItem",
                    "position": 1,
                    "name": "Home",
                    "item": "https://akuro17.github.io/"
                },
                {
                    "@type": "ListItem",
                    "position": 2,
                    "name": "Indicators",
                    "item": "https://akuro17.github.io/indicators/"
                },
                {
                    "@type": "ListItem",
                    "position": 3,
                    "name": "ZigZag",
                    "item": "https://akuro17.github.io/indicators/zigzag.html"
                }
            ]
        }
    ]
}
    </script>
    <!-- Resource Hints -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
    <!-- Styles -->
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
    <link rel="stylesheet" href="../assets/css/style.css">
    <link rel="stylesheet" href="../assets/css/indicator.css">
    <!-- KaTeX (Math) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
    <!-- Libraries (defer for non-blocking load) -->
    <script defer src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <!-- Pygments Syntax Highlighting (Externalized) -->
    <link rel="stylesheet" href="../assets/css/pygments.css">

</head>
<body class="bg-slate-50 text-slate-800 font-sans antialiased relative">
        <!-- Navigation -->
    <nav class="bg-white border-b border-slate-200 sticky top-0 z-50 shadow-sm">
        <div class="max-w-[1400px] mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <div class="flex-shrink-0 flex items-center mr-6">
                        <a href="../index.html" class="font-bold text-xl text-indigo-600">
                            I ant I Investigates
                        </a>
                    </div>
                    <!-- Breadcrumbs (Moved Here) -->
                    <nav class="flex text-sm text-slate-500 mr-8" aria-label="Breadcrumb">
                        <ol class="flex items-center space-x-2">
                            <li><a href="../index.html" class="hover:text-indigo-600 transition-colors">home</a></li>
                            <li><span class="mx-1">/</span></li>
                            <li><a href="./" class="hover:text-indigo-600 transition-colors">indicators</a></li>
                            <li><span class="mx-1">/</span></li>
                            <li><span class="font-medium text-slate-900">ZigZag</span></li>
                        </ol>
                    </nav>

                    <!-- Page Top Nav (Anchor Links) -->
                    <div class="flex space-x-4 items-center">
                        <a href="#interactive-playground" class="text-slate-600 hover:text-indigo-600 px-3 py-2 text-sm font-medium transition-colors">
                            Chart
                        </a>
                        <a href="#logic-visualization" class="text-slate-600 hover:text-indigo-600 px-3 py-2 text-sm font-medium transition-colors">
                            Logic
                        </a>
                        <a href="#documentation" class="text-slate-600 hover:text-indigo-600 px-3 py-2 text-sm font-medium transition-colors">
                            Docs
                        </a>
                    </div>
                </div>
                <!-- External Links Placeholder -->
                <div class="hidden sm:flex items-center">
                </div>
            </div>
        </div>
    </nav>
    <!-- Main Container: 1-Column Stack -->
    <div class="max-w-[1400px] mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-12">
        <!-- ======================================================= -->
        <!-- TOP SECTION: CONTEXT & PLAYGROUND                       -->
        <!-- ======================================================= -->
        <div class="flex flex-col gap-6">
            <!-- Hero Header -->
            <header>
                <h1 class="text-3xl md:text-4xl font-bold text-slate-900 mb-4 leading-tight">ZigZag</h1>
                <p class="text-lg text-slate-600 leading-relaxed">The ZigZag Indicator is a noise filter that connects significant price points (Swing Highs and Swing Lows) with straight lines, ignoring price movements smaller than a specified deviation.</p>
            </header>

            <!-- Interactive Playground -->
            <section id="interactive-playground" class="bg-white rounded-lg shadow-sm border border-slate-200 overflow-hidden scroll-mt-24">
                <div class="border-b border-slate-200 bg-indigo-50 px-6 py-4">
                    <h2 class="text-lg font-bold text-slate-800 flex items-center">
                        <span class="bg-indigo-600 text-white p-1 rounded mr-3 text-xs shadow-sm font-mono">C</span>
                        Calculator
                    </h2>
                    <p class="text-sm text-slate-600 mt-2">Calculate indicator values from your price data.</p>
                </div>
                <div class="p-6">
                    <!-- Chart Area -->
                    <div class="relative h-[400px] w-full mb-6 border border-slate-100 rounded bg-slate-50">
                        <canvas id="indicatorChart"></canvas>
                    </div>

                    <!-- Controls Area -->
                    <div id="controls" class="grid grid-cols-1 md:grid-cols-3 gap-6 bg-slate-50 p-4 rounded border border-slate-200">
                        <!-- Parameters -->
                        <div class="md:col-span-1 space-y-4">
                            <h3 class="font-bold text-sm text-slate-700 uppercase tracking-wide border-b border-slate-200 pb-2">Parameters</h3>
                            <div id="settings-container">
                                <div class="space-y-3">
                                    <!-- Dynamic settings will be injected here -->
                                </div>
                            </div>
                            <button id="btn-run" onclick="PlaygroundController.update()" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded transition-colors shadow-sm flex items-center justify-center">
                                Calculate
                            </button>
                        </div>

                        <!-- Data I/O -->
                        <div class="md:col-span-2 space-y-4">
                            <!-- Input -->
                            <div class="space-y-2">
                                <div class="flex justify-between items-center pb-2 border-b border-slate-200">
                                    <h3 class="font-bold text-sm text-slate-700 uppercase tracking-wide">Input Data (CSV)</h3>
                                    <div class="flex space-x-2">
                                        <button id="btn-load-sample-ohlcv" class="text-xs text-indigo-600 hover:text-indigo-800 hover:underline transition-colors" title="Load OHLCV Sample Data">Shape (OHLCV)</button>
                                        <span class="text-slate-300">|</span>
                                        <button id="btn-load-sample-single" class="text-xs text-indigo-600 hover:text-indigo-800 hover:underline transition-colors" title="Load Single Value Sample Data">Single</button>
                                    </div>
                                </div>
                                <p class="text-xs text-slate-500">Enter CSV data (Date,Open,High,Low,Close,Volume) or single values.</p>
                                <textarea id="input-data" class="w-full h-24 p-2 text-xs font-mono border border-slate-300 rounded focus:ring-2 focus:ring-indigo-500 transition-shadow" placeholder="e.g. 100.5, 101.2, 99.8, 102.3, 103.1...

or one per line:
100.5
101.2
99.8"></textarea>
                            </div>
                            <!-- Output (Enabled) -->
                            <div class="space-y-2">
                                <div class="flex justify-between items-center pb-2 border-b border-slate-200">
                                    <h3 class="font-bold text-sm text-slate-700 uppercase tracking-wide">Output Data (Result)</h3>
                                </div>
                                <textarea id="output-data" class="w-full h-24 p-2 text-xs font-mono border border-slate-300 rounded bg-slate-100 text-slate-600" readonly placeholder="Calculation results will appear here..."></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- ======================================================= -->
        <!-- MIDDLE SECTION: LOGIC & ARCHITECTURE (PORTED FROM 0117) -->
        <!-- ======================================================= -->
        <section id="logic-visualization" class="bg-white rounded-lg shadow-sm border border-slate-200 overflow-hidden scroll-mt-24">
            <!-- Section Header (Styled like Playground) -->
            <div class="border-b border-slate-200 bg-emerald-50 px-6 py-4">
                <h2 class="text-lg font-bold text-slate-800 flex items-center">
                    <span class="bg-emerald-600 text-white p-1 rounded mr-3 text-xs shadow-sm font-mono">L</span>
                    Logic & Code Architecture
                </h2>
                <p class="text-sm text-slate-600 mt-2">Visual flowchart showing how the indicator processes data.</p>
            </div>

            <!-- LOGIC FIGURE STRUCTURE -->
            <figure class="logic-figure" style="border: none; border-radius: 0;">
                <!-- 1. Code Panel Toggle Button -->
                <button id="code-panel-toggle-btn" onclick="toggleCodePanel()" title="View Source Code" class="font-bold text-xs">
                    CODE
                </button>

                <!-- 2. Infinite Canvas Layer -->
                <div id="canvas-container" class="chart-scroll-wrapper" 
                     tabindex="0"
                     role="application"
                     aria-label="Flowchart interaction area. Use arrow keys to pan, +/- to zoom, R to reset">
                    <div id="canvas-content" class="mermaid" style="position: absolute; top:0; left:0;">
                        flowchart TD;
subgraph INGESTION["INGESTION<br/>Data Collection"];
A["Gather OHLC prices<br/>for pattern analysis"];
B["Set deviation threshold<br/>defining significant moves"];
end;
subgraph EVALUATION["EVALUATION<br/>Market Assessment"];
C["Identify significant peaks<br/>above noise threshold"];
D["Identify significant troughs<br/>above noise threshold"];
E["Filter minor fluctuations<br/>below deviation percent"];
end;
subgraph WEIGHTING["WEIGHTING<br/>Importance Assignment"];
F["Lock confirmed pivots<br/>after reversal exceeds threshold"];
G["Keep last leg tentative<br/>until reversal confirms"];
H["NOTE: Last leg repaints<br/>as new data arrives"];
end;
subgraph SYNTHESIS["SYNTHESIS<br/>Signal Integration"];
I["Connect swing points<br/>with straight line segments"];
J["Reveal market structure<br/>at chosen resolution level"];
end;
subgraph OUTCOME["OUTCOME<br/>Trading Decision"];
K["Use for structure analysis:<br/>Higher highs/higher lows"];
L["Anchor Fibonacci levels<br/>from confirmed pivots only"];
M["NEVER trade last leg<br/>it will repaint retroactively"];
end;
A --> C;
B --> C;
C --> D;
D --> E;
E --> F;
F --> G;
G --> H;
H --> I;
I --> J;
J --> K;
K --> L;
L --> M;
style INGESTION fill:#e3f2fd;
style EVALUATION fill:#fff3e0;
style WEIGHTING fill:#e8f5e9;
style SYNTHESIS fill:#fce4ec;
style OUTCOME fill:#f3e5f5;
                    </div>
                </div>

                <!-- 3. Canvas Controls (Zoom) -->
                <div class="absolute top-4 right-4 flex flex-col gap-2 z-20">
                    <button onclick="if(window.resetView) window.resetView()" class="p-2 bg-white rounded shadow border border-slate-200 hover:bg-slate-50 text-slate-600 font-mono text-xs" title="Reset View">R</button>
                    <button onclick="if(window.zoomAction) window.zoomAction('in')" class="p-2 bg-white rounded shadow border border-slate-200 hover:bg-slate-50 text-slate-600 font-mono text-xs" title="Zoom In">+</button>
                    <button onclick="if(window.zoomAction) window.zoomAction('out')" class="p-2 bg-white rounded shadow border border-slate-200 hover:bg-slate-50 text-slate-600 font-mono text-xs" title="Zoom Out">-</button>
                </div>

                <!-- 4. Code Panel Overlay (Slide-in) -->
                <div id="code-panel-overlay" class="panel-hidden" onmousedown="event.stopPropagation();">
                    <!-- Header -->
                    <div class="flex justify-between items-center p-3 border-b border-slate-200 bg-slate-50 shrink-0">
                        <div class="flex gap-2">
                            <button id="btn-lang-csharp" class="px-2 py-1 text-xs rounded transition-colors text-slate-500 hover:bg-slate-100" onclick="setLang('csharp')">C#</button>
                            <button id="btn-lang-python" class="px-2 py-1 text-xs rounded transition-colors text-slate-500 hover:bg-slate-100" onclick="setLang('python')">Python</button>
                        </div>
                        <div class="flex items-center gap-2">
                            <button id="btn-type-simple" class="text-xs text-slate-500 hover:text-indigo-600 transition-colors" onclick="setType('simple')">Simple</button>
                            <button id="btn-type-detailed" class="text-xs text-slate-500 hover:text-indigo-600 transition-colors" onclick="setType('detailed')">Detailed</button>
                            <!-- Copy -->
                            <button id="btn-copy-code" class="ml-2 text-slate-500 hover:text-slate-800 transition-colors" onclick="copyCode()" title="Copy Code">
                                <svg id="icon-copy" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                </svg>
                                <svg id="icon-copy-done" class="hidden text-green-600" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <polyline points="20 6 9 17 4 12"></polyline>
                                </svg>
                            </button>
                            <!-- Expand/Collapse -->
                            <button id="btn-panel-expand" class="text-slate-500 hover:text-slate-800 transition-colors" onclick="toggleExpand()" title="Toggle Width">
                                <svg id="icon-expand" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M15 3h6v6" /><path d="M9 21H3v-6" /><path d="M21 3l-7 7" /><path d="M3 21l7-7" />
                                </svg>
                                <svg id="icon-collapse" class="hidden" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M4 14h6v6" /><path d="M20 10h-6V4" /><path d="M14 10l7-7" /><path d="M10 14l-7 7" />
                                </svg>
                            </button>
                            <!-- Close -->
                            <button class="text-slate-500 hover:text-red-600 transition-colors" onclick="toggleCodePanel()" title="Close Panel">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="18" y1="6" x2="6" y2="18" /><line x1="6" y1="6" x2="18" y2="18" />
                                </svg>
                            </button>
                        </div>
                    </div>
                    <!-- Body -->
                    <div class="code-panel-body custom-scrollbar p-4" 
                         id="code-panel-body"
                         data-code-src="../data/codes/ZigZag.js">
                        <!-- Loading indicator -->
                        <div id="code-loading" class="hidden absolute inset-0 flex items-center justify-center bg-white/80 z-10">
                            <span class="text-slate-400 text-sm">Loading code...</span>
                        </div>
                        <!-- Code containers (populated via JS fetch) -->
                        <div id="code-csharp-simple" class="code-content hidden"></div>
                        <div id="code-csharp-detailed" class="code-content hidden"></div>
                        <div id="code-python-simple" class="code-content hidden"></div>
                        <div id="code-python-detailed" class="code-content hidden"></div>
                    </div>
                </div>
            </figure>

            <!-- Legend (5-Step Model) -->
            <div class="logic-legend">
                <div class="legend-item"><span class="legend-dot l-ingestion"></span>Ingestion</div>
                <div class="legend-item"><span class="legend-dot l-evaluation"></span>Evaluation</div>
                <div class="legend-item"><span class="legend-dot l-weighting"></span>Weighting</div>
                <div class="legend-item"><span class="legend-dot l-synthesis"></span>Synthesis</div>
                <div class="legend-item"><span class="legend-dot l-outcome"></span>Outcome</div>
                <div class="text-xs text-slate-500 ml-auto">Keyboard: Arrows(pan) / +-(zoom) / R(reset)</div>
            </div>
        </section>

        <!-- ======================================================= -->
        <!-- BOTTOM SECTION: DOCS & TOC                              -->
        <!-- ======================================================= -->
        <section id="documentation" class="bg-white rounded-lg shadow-sm border border-slate-200 overflow-hidden scroll-mt-24">
            <!-- Documentation Header -->
            <div class="border-b border-orange-200 bg-orange-50 px-6 py-4">
                <h2 class="text-lg font-bold text-slate-900 flex items-center">
                    <span class="bg-indigo-600 text-white p-1 rounded mr-3 text-xs shadow-sm font-mono">D</span>
                    Technical Documentation
                </h2>
                <p class="text-slate-600 text-xs mt-1 ml-9">
                    Detailed technical explanation of the indicator's logic, math, and implementation details.
                </p>
            </div>
            <!-- Content Body -->
            <div class="p-6 flex flex-col lg:flex-row gap-12">
                <!-- Left: Article -->
                <article class="flex-1 min-w-0">
                    <div class="prose prose-slate max-w-none prose-headings:scroll-mt-24 prose-headings:font-bold prose-h2:text-2xl prose-h2:border-b prose-h2:pb-2 prose-h2:mt-8 prose-a:text-indigo-600 hover:prose-a:text-indigo-800">
                        <h1 id="zigzag-indicator">ZigZag Indicator</h1>

<p class="mb-4"><h2 class="text-2xl font-bold mt-12 mb-6 border-b pb-2">PART 1: MAIN GUIDE</h2></p>

<h2 id="1-identity">1. Identity</h2>

<p class="mb-4">Full Name: ZigZag Indicator  </p>
<p class="mb-4">Abbreviation: ZZ  </p>
<p class="mb-4">Category: Noise Filter / Pattern Recognition  </p>
<p class="mb-4">Creator: Often attributed to Arthur Merrill (1977)</p>

<blockquote class="border-l-4 border-gray-300 pl-4 italic text-gray-700 my-4 bg-gray-50 py-2 pr-2 rounded-r">One-Sentence Definition: The ZigZag Indicator is a noise filter that connects significant price points (Swing Highs and Swing Lows) with straight lines, ignoring price movements smaller than a specified deviation.</blockquote>

<hr class="border-[#2a2e39] my-8">

<h2 id="2-calculation-logic">2. Calculation Logic</h2>

<h3 id="algorithm-description">Algorithm Description</h3>

<p class="mb-4">Unlike indicators with a mathematical formula, ZigZag operates via an algorithmic filter:</p>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Parameter</td><td class="px-4 py-2 border-b border-[#2a2e39]">Description</td><td class="px-4 py-2 border-b border-[#2a2e39]">Default</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Deviation/Threshold</td><td class="px-4 py-2 border-b border-[#2a2e39]">Minimum change to form new leg</td><td class="px-4 py-2 border-b border-[#2a2e39]">5%</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Depth</td><td class="px-4 py-2 border-b border-[#2a2e39]">Minimum bars to confirm extremum</td><td class="px-4 py-2 border-b border-[#2a2e39]">12</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Backstep</td><td class="px-4 py-2 border-b border-[#2a2e39]">Minimum bars between swing points</td><td class="px-4 py-2 border-b border-[#2a2e39]">3</td></tr>
</table></div>

<p class="mb-4">Algorithm Logic:</p>
<p class="mb-4">1. Initialize with a starting pivot point (first Close)</p>
<p class="mb-4">2. Track direction (seeking High or Low)</p>
<p class="mb-4">3. If price moves in current direction, update tentative pivot</p>
<p class="mb-4">4. If price reverses by more than Deviation%, lock previous pivot and switch direction</p>
<p class="mb-4">5. The last leg is always tentative and repaints</p>

<h3 id="real-world-analogy">Real-World Analogy</h3>

<p class="mb-4">Think of ZigZag like connecting the dots on a mountain range photograph. You only mark the significant peaks and valleys, ignoring small bumps. The resulting line shows overall terrain structure—but the last peak you're standing near might not be the "true" peak until you've walked down 5% of the mountain.</p>

<hr class="border-[#2a2e39] my-8">

<h2 id="3-market-standards">3. Market Standards</h2>

<h3 id="default-parameters">Default Parameters</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Parameter</td><td class="px-4 py-2 border-b border-[#2a2e39]">Standard Value</td><td class="px-4 py-2 border-b border-[#2a2e39]">Rationale</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Deviation</td><td class="px-4 py-2 border-b border-[#2a2e39]">5%</td><td class="px-4 py-2 border-b border-[#2a2e39]">Filters minor movements</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Long-term Deviation</td><td class="px-4 py-2 border-b border-[#2a2e39]">10%</td><td class="px-4 py-2 border-b border-[#2a2e39]">Weekly/monthly structure</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Depth</td><td class="px-4 py-2 border-b border-[#2a2e39]">12</td><td class="px-4 py-2 border-b border-[#2a2e39]">Standard extremum confirmation</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Backstep</td><td class="px-4 py-2 border-b border-[#2a2e39]">3</td><td class="px-4 py-2 border-b border-[#2a2e39]">Prevents too-close pivots</td></tr>
</table></div>

<h3 id="usage-context">Usage Context</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Application</td><td class="px-4 py-2 border-b border-[#2a2e39]">Description</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Pattern Recognition</td><td class="px-4 py-2 border-b border-[#2a2e39]">Harmonic patterns, Elliott Wave</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Structure Analysis</td><td class="px-4 py-2 border-b border-[#2a2e39]">Higher Highs/Higher Lows</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">ML Labeling</td><td class="px-4 py-2 border-b border-[#2a2e39]">Defining "ideal" trade targets</td></tr>
</table></div>

<hr class="border-[#2a2e39] my-8">

<h2 id="4-market-context">4. Market Context</h2>

<h3 id="best-conditions">Best Conditions</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Condition</td><td class="px-4 py-2 border-b border-[#2a2e39]">Why It Works</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Hindsight Analysis</td><td class="px-4 py-2 border-b border-[#2a2e39]">Perfect for post-trade review</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Pattern Recognition</td><td class="px-4 py-2 border-b border-[#2a2e39]">ABCD, Gartley, Butterfly identification</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Educational Purposes</td><td class="px-4 py-2 border-b border-[#2a2e39]">Teaching market structure</td></tr>
</table></div>

<h3 id="limitations">Limitations</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Condition</td><td class="px-4 py-2 border-b border-[#2a2e39]">Problem</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Real-Time Trading</td><td class="px-4 py-2 border-b border-[#2a2e39]">The last leg repaints!</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">High-Frequency</td><td class="px-4 py-2 border-b border-[#2a2e39]">Too slow for immediate decisions</td></tr>
</table></div>

<h3 id="asset-class-suitability">Asset Class Suitability</h3>

<p class="mb-4">- Indices — Structure analysis</p>
<p class="mb-4">- Forex Majors — Pattern identification</p>
<p class="mb-4">- All Assets (Real-Time) — CRITICAL: Repainting makes live signals unreliable</p>

<hr class="border-[#2a2e39] my-8">

<h2 id="5-entry-signals">5. Entry Signals</h2>

<blockquote class="border-l-4 border-gray-300 pl-4 italic text-gray-700 my-4 bg-gray-50 py-2 pr-2 rounded-r">CRITICAL WARNING: ZigZag signals are NOT real-time. The last leg is always tentative and repaints as price evolves.</blockquote>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Signal Type</td><td class="px-4 py-2 border-b border-[#2a2e39]">Condition</td><td class="px-4 py-2 border-b border-[#2a2e39]">Direction</td><td class="px-4 py-2 border-b border-[#2a2e39]">Strength</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Up-Leg Confirmation</td><td class="px-4 py-2 border-b border-[#2a2e39]">Price rises > Deviation from Swing Low</td><td class="px-4 py-2 border-b border-[#2a2e39]">Bullish</td><td class="px-4 py-2 border-b border-[#2a2e39]">Low (repainting)</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Down-Leg Confirmation</td><td class="px-4 py-2 border-b border-[#2a2e39]">Price drops > Deviation from Swing High</td><td class="px-4 py-2 border-b border-[#2a2e39]">Bearish</td><td class="px-4 py-2 border-b border-[#2a2e39]">Low (repainting)</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">"W" Bottom</td><td class="px-4 py-2 border-b border-[#2a2e39]">ZigZag forms W shape</td><td class="px-4 py-2 border-b border-[#2a2e39]">Bullish</td><td class="px-4 py-2 border-b border-[#2a2e39]">High (historical)</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">"M" Top</td><td class="px-4 py-2 border-b border-[#2a2e39]">ZigZag forms M shape</td><td class="px-4 py-2 border-b border-[#2a2e39]">Bearish</td><td class="px-4 py-2 border-b border-[#2a2e39]">High (historical)</td></tr>
</table></div>

<h3 id="structure-analysis-historical-only">Structure Analysis (Historical Only)</h3>

<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-">
Higher High: Current ZigZag High &gt; Previous ZigZag High
Higher Low: Current ZigZag Low &gt; Previous ZigZag Low
→ Bullish structure confirmed (NOT real-time tradeable)
</code></pre>

<hr class="border-[#2a2e39] my-8">

<h2 id="6-filter-usage">6. Filter Usage</h2>

<h3 id="filter-rules">Filter Rules</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Rule</td><td class="px-4 py-2 border-b border-[#2a2e39]">Application</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Use confirmed pivots only</td><td class="px-4 py-2 border-b border-[#2a2e39]">Never trade the current leg</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Fibonacci anchoring</td><td class="px-4 py-2 border-b border-[#2a2e39]">Draw from previous LOCKED leg</td></tr>
</table></div>

<h3 id="recommended-pairings">Recommended Pairings</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Partner Indicator</td><td class="px-4 py-2 border-b border-[#2a2e39]">Synergy Logic</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Fibonacci Retracement</td><td class="px-4 py-2 border-b border-[#2a2e39]">ZigZag identifies anchor points</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Elliott Wave</td><td class="px-4 py-2 border-b border-[#2a2e39]">Automates wave counting</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Harmonic Patterns</td><td class="px-4 py-2 border-b border-[#2a2e39]">Identifies ABCD vertices</td></tr>
</table></div>

<hr class="border-[#2a2e39] my-8">

<h2 id="7-practical-cautions">7. Practical Cautions</h2>

<h3 id="lag-characteristics">Lag Characteristics</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Component</td><td class="px-4 py-2 border-b border-[#2a2e39]">Characteristic</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Type</td><td class="px-4 py-2 border-b border-[#2a2e39]">Repainting (last leg is unstable)</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Confirmation</td><td class="px-4 py-2 border-b border-[#2a2e39]">Only after reversal exceeds threshold</td></tr>
</table></div>

<blockquote class="border-l-4 border-gray-300 pl-4 italic text-gray-700 my-4 bg-gray-50 py-2 pr-2 rounded-r">CRITICAL: REPAINTING! The last leg of ZigZag is *temporary* and will shift as new price data comes in. NEVER trade based on the current appearing line.</blockquote>

<h3 id="what-"repainting"-means">What "Repainting" Means</h3>

<p class="mb-4">1. ZigZag shows a "Low" at $100</p>
<p class="mb-4">2. Price drops further to $95</p>
<p class="mb-4">3. The indicator moves the Low from $100 to $95</p>
<p class="mb-4">4. Your entry signal has disappeared retroactively</p>

<h3 id="mitigation-strategies">Mitigation Strategies</h3>

<p class="mb-4">- Never trade the last leg — only use confirmed (locked) pivots</p>
<p class="mb-4">- Use ZigZag purely for structure identification, not signals</p>
<p class="mb-4">- Wait for a candle close breaking the trendline connecting last two ZigZag points</p>

<hr class="border-[#2a2e39] my-8">

<h2 id="8-pro-insights">8. Pro Insights</h2>

<h3 id="the-repainting-reality">The Repainting Reality</h3>

<p class="mb-4">New traders are often fooled because historical ZigZag looks perfect. It is NOT real-time—it's been redrawn with hindsight. Professional use is limited to pattern detection and structure analysis.</p>

<h3 id="fibonacci-automation">Fibonacci Automation</h3>

<p class="mb-4">The real power of ZigZag is automating Fibonacci drawing. Identify the previous confirmed Swing Low → Swing High leg. Place Limit Buy orders at the 61.8% retracement level.</p>

<h3 id="harmonic-pattern-foundation">Harmonic Pattern Foundation</h3>

<p class="mb-4">ZigZag is essential for identifying Gartley, Bat, Butterfly, and Crab patterns. The indicator isolates the ABCD vertices required for these geometric patterns.</p>

<hr class="border-[#2a2e39] my-8">

<h2 id="9-summary">9. Summary</h2>

<blockquote class="border-l-4 border-gray-300 pl-4 italic text-gray-700 my-4 bg-gray-50 py-2 pr-2 rounded-r">"ZigZag reveals the skeleton of price—but the last bone is still forming."</blockquote>

<p class="mb-4"><h2 class="text-2xl font-bold mt-12 mb-6 border-b pb-2">PART 2: SUPPLEMENTARY GUIDE</h2></p>

<h2 id="1-core-concept">1. Core Concept</h2>

<p class="mb-4">ZigZag is fundamentally a noise reduction filter. Markets move in fractal patterns—every upswing contains minor downswings. ZigZag strips away the noise below a certain threshold, leaving only the "significant" swings.</p>

<p class="mb-4">The threshold acts like a resolution setting. At 5% deviation, you see daily structure. At 10%, weekly structure. At 20%, monthly structure.</p>

<hr class="border-[#2a2e39] my-8">

<h2 id="2-statistical-edge">2. Statistical Edge</h2>

<h3 id="why-it's-used">Why It's Used</h3>

<p class="mb-4">- Eliminates subjective swing identification</p>
<p class="mb-4">- Standardizes pattern recognition across analysts</p>
<p class="mb-4">- Provides consistent labeling for quantitative analysis</p>

<h3 id="the-limitation">The Limitation</h3>

<p class="mb-4">ZigZag has no predictive edge because it *repaints*. Backtests using ZigZag to generate signals are invalid unless special care is taken to use only locked (confirmed) pivots.</p>

<hr class="border-[#2a2e39] my-8">

<h2 id="3-actionable-strategy">3. Actionable Strategy</h2>

<h3 id="strategy-name:-"fibonacci-confluence-at-zigzag-levels"">Strategy Name: "Fibonacci Confluence at ZigZag Levels"</h3>

<p class="mb-4">Setup:</p>
<p class="mb-4">1. Identify the previous completed ZigZag leg (not the current one!)</p>
<p class="mb-4">2. Draw Fibonacci retracement from Swing Low to Swing High (bullish setup)</p>

<p class="mb-4">Entry Rules:</p>
<p class="mb-4">1. Place Limit Buy order at 61.8% retracement level</p>
<p class="mb-4">2. Stop loss below 78.6% or below previous Swing Low</p>
<p class="mb-4">3. Only execute if price reaches level *before* current leg confirms</p>

<p class="mb-4">Exit Rules:</p>
<p class="mb-4">1. Take profit at previous Swing High</p>
<p class="mb-4">2. OR trail using ZLEMA</p>

<p class="mb-4">Position Sizing: Conservative 1% risk</p>

<hr class="border-[#2a2e39] my-8">

<h2 id="4-risks-&-limitations">4. Risks & Limitations</h2>

<h3 id="failure-patterns">Failure Patterns</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Pattern</td><td class="px-4 py-2 border-b border-[#2a2e39]">Description</td><td class="px-4 py-2 border-b border-[#2a2e39]">Mitigation</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">No Plot</td><td class="px-4 py-2 border-b border-[#2a2e39]">Volatility below threshold</td><td class="px-4 py-2 border-b border-[#2a2e39]">Adjust deviation</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Late Confirmation</td><td class="px-4 py-2 border-b border-[#2a2e39]">Pivot locked after move</td><td class="px-4 py-2 border-b border-[#2a2e39]">Accept as structure tool only</td></tr>
</table></div>

<h3 id="psychological-traps">Psychological Traps</h3>

<p class="mb-4">- Believing historical ZigZag performance is replicable in real-time</p>
<p class="mb-4">- Overcomplicating with too small a deviation</p>

<hr class="border-[#2a2e39] my-8">

<h2 id="5-further-study">5. Further Study</h2>

<h3 id="historical-context">Historical Context</h3>

<p class="mb-4">Often linked to Arthur Merrill (*Filtered Waves*, 1977) and Robert Levy (1971) regarding predictive significance of chart patterns.</p>

<h3 id="parent/child-indicators">Parent/Child Indicators</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Indicator</td><td class="px-4 py-2 border-b border-[#2a2e39]">Relationship</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Fibonacci Retracement</td><td class="px-4 py-2 border-b border-[#2a2e39]">Partner — Uses ZigZag for anchors</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Elliott Wave</td><td class="px-4 py-2 border-b border-[#2a2e39]">Partner — Automates wave counting</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Harmonic Patterns</td><td class="px-4 py-2 border-b border-[#2a2e39]">Partner — ABCD vertex identification</td></tr>
</table></div>

<hr class="border-[#2a2e39] my-8">

<h3 id="55-related-indicators-comparison">5.5 Related Indicators Comparison</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Feature</td><td class="px-4 py-2 border-b border-[#2a2e39]">ZigZag</td><td class="px-4 py-2 border-b border-[#2a2e39]">Fractals</td><td class="px-4 py-2 border-b border-[#2a2e39]">Pivot Points</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Repaints</td><td class="px-4 py-2 border-b border-[#2a2e39]">Yes (last leg)</td><td class="px-4 py-2 border-b border-[#2a2e39]">No</td><td class="px-4 py-2 border-b border-[#2a2e39]">No</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Time-Based</td><td class="px-4 py-2 border-b border-[#2a2e39]">No</td><td class="px-4 py-2 border-b border-[#2a2e39]">Yes (fixed bars)</td><td class="px-4 py-2 border-b border-[#2a2e39]">Yes (period-based)</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Best For</td><td class="px-4 py-2 border-b border-[#2a2e39]">Structure</td><td class="px-4 py-2 border-b border-[#2a2e39]">Micro-swings</td><td class="px-4 py-2 border-b border-[#2a2e39]">Support/Resistance</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Algorithmic</td><td class="px-4 py-2 border-b border-[#2a2e39]">Yes</td><td class="px-4 py-2 border-b border-[#2a2e39]">Yes</td><td class="px-4 py-2 border-b border-[#2a2e39]">Yes</td></tr>
</table></div>

<p class="mb-4"><h2 class="text-2xl font-bold mt-12 mb-6 border-b pb-2">PART 3: ADVANCED SIGNAL REFERENCE</h2></p>

<h2 id="advanced-signal-reference">Advanced Signal Reference</h2>

<h3 id="threshold-matrix">Threshold Matrix</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Deviation</td><td class="px-4 py-2 border-b border-[#2a2e39]">Timeframe</td><td class="px-4 py-2 border-b border-[#2a2e39]">Structure Revealed</td><td class="px-4 py-2 border-b border-[#2a2e39]">Use Case</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">2-3%</td><td class="px-4 py-2 border-b border-[#2a2e39]">Intraday</td><td class="px-4 py-2 border-b border-[#2a2e39]">Micro swings</td><td class="px-4 py-2 border-b border-[#2a2e39]">Scalping analysis</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">5%</td><td class="px-4 py-2 border-b border-[#2a2e39]">Daily</td><td class="px-4 py-2 border-b border-[#2a2e39]">Daily structure</td><td class="px-4 py-2 border-b border-[#2a2e39]">Standard trading</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">10%</td><td class="px-4 py-2 border-b border-[#2a2e39]">Weekly</td><td class="px-4 py-2 border-b border-[#2a2e39]">Macro swings</td><td class="px-4 py-2 border-b border-[#2a2e39]">Position trading</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">20%</td><td class="px-4 py-2 border-b border-[#2a2e39]">Monthly</td><td class="px-4 py-2 border-b border-[#2a2e39]">Major trends</td><td class="px-4 py-2 border-b border-[#2a2e39]">Investment allocation</td></tr>
</table></div>

<h3 id="signal-patterns">Signal Patterns</h3>

<blockquote class="border-l-4 border-gray-300 pl-4 italic text-gray-700 my-4 bg-gray-50 py-2 pr-2 rounded-r">These patterns can only be reliably identified on locked (historical) pivots.</blockquote>

<h4 id="w-bottom-detection-double-bottom">W-Bottom Detection (Double Bottom)</h4>

<p class="mb-4">This pattern identifies a classic W-bottom (double bottom) formation by analyzing the last 5 ZigZag pivot points—two lows at similar levels separated by a high, followed by a breakout above that high. The 3% tolerance for matching lows accounts for natural market noise while still confirming the structural pattern. CRITICAL: This pattern can only be reliably identified on LOCKED (historical) pivots—the repainting nature of ZigZag makes real-time detection unreliable.</p>

<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-python">
def zigzag_w_bottom(pivots):
&nbsp;&nbsp;&nbsp;&nbsp;if len(pivots) &lt; 5:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return False
&nbsp;&nbsp;&nbsp;&nbsp;low1 = pivots[-4][&#x27;value&#x27;]
&nbsp;&nbsp;&nbsp;&nbsp;high = pivots[-3][&#x27;value&#x27;]
&nbsp;&nbsp;&nbsp;&nbsp;low2 = pivots[-2][&#x27;value&#x27;]
&nbsp;&nbsp;&nbsp;&nbsp;current = pivots[-1][&#x27;value&#x27;]
&nbsp;&nbsp;&nbsp;&nbsp;return (
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pivots[-4][&#x27;type&#x27;] == &#x27;low&#x27; and
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pivots[-3][&#x27;type&#x27;] == &#x27;high&#x27; and
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pivots[-2][&#x27;type&#x27;] == &#x27;low&#x27; and
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;abs(low2 - low1) / low1 &lt; 0.03 and
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;current &gt; high
&nbsp;&nbsp;&nbsp;&nbsp;)
</code></pre>

<h3 id="screening-filters">Screening Filters</h3>

<h4 id="structure-scan-caution---repainting!">Structure Scan (Caution - Repainting!)</h4>
<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-">
Last_ZigZag_Leg == Up
Current_Price &lt; ZigZag_High * 0.95
→ Looking for pullback entries
</code></pre>

<h3 id="combination-strategies">Combination Strategies</h3>

<h4 id="zigzag-+-fibonacci-integration">ZigZag + Fibonacci Integration</h4>
<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-">
SETUP:
&nbsp;&nbsp;Identify CONFIRMED ZigZag leg (Swing Low to Swing High)

ENTRY:
&nbsp;&nbsp;Place Limit Buy at 61.8% retracement
&nbsp;&nbsp;
STOP_LOSS:
&nbsp;&nbsp;Below 78.6% retracement

TAKE_PROFIT:
&nbsp;&nbsp;Previous Swing High

EXIT:
&nbsp;&nbsp;Price breaks below Swing Low
</code></pre>





                    </div>
                </article>
                <!-- Right: Sticky TOC -->
                <aside class="lg:block w-64 flex-shrink-0">
                    <div class="sticky top-24">
                        <h3 class="font-bold text-slate-900 mb-4 pb-2 border-b border-slate-100 text-sm uppercase tracking-wider">
                            On this page
                        </h3>
                        <nav id="toc-nav" class="space-y-1 text-sm text-slate-600">
                            <a href="#1-identity" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">1. Identity</a>
<a href="#2-calculation-logic" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">2. Calculation Logic</a>
<a href="#algorithm-description" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Algorithm Description</a>
<a href="#real-world-analogy" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Real-World Analogy</a>
<a href="#3-market-standards" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">3. Market Standards</a>
<a href="#default-parameters" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Default Parameters</a>
<a href="#usage-context" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Usage Context</a>
<a href="#4-market-context" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">4. Market Context</a>
<a href="#best-conditions" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Best Conditions</a>
<a href="#limitations" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Limitations</a>
<a href="#asset-class-suitability" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Asset Class Suitability</a>
<a href="#5-entry-signals" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">5. Entry Signals</a>
<a href="#structure-analysis-historical-only" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Structure Analysis (Historical Only)</a>
<a href="#6-filter-usage" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">6. Filter Usage</a>
<a href="#filter-rules" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Filter Rules</a>
<a href="#recommended-pairings" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Recommended Pairings</a>
<a href="#7-practical-cautions" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">7. Practical Cautions</a>
<a href="#lag-characteristics" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Lag Characteristics</a>
<a href="#what-"repainting"-means" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">What "Repainting" Means</a>
<a href="#mitigation-strategies" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Mitigation Strategies</a>
<a href="#8-pro-insights" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">8. Pro Insights</a>
<a href="#the-repainting-reality" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">The Repainting Reality</a>
<a href="#fibonacci-automation" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Fibonacci Automation</a>
<a href="#harmonic-pattern-foundation" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Harmonic Pattern Foundation</a>
<a href="#9-summary" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">9. Summary</a>
<a href="#1-core-concept" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">1. Core Concept</a>
<a href="#2-statistical-edge" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">2. Statistical Edge</a>
<a href="#why-it's-used" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Why It's Used</a>
<a href="#the-limitation" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">The Limitation</a>
<a href="#3-actionable-strategy" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">3. Actionable Strategy</a>
<a href="#strategy-name:-"fibonacci-confluence-at-zigzag-levels"" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Strategy Name: "Fibonacci Confluence at ZigZag Levels"</a>
<a href="#4-risks-&-limitations" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">4. Risks & Limitations</a>
<a href="#failure-patterns" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Failure Patterns</a>
<a href="#psychological-traps" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Psychological Traps</a>
<a href="#5-further-study" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">5. Further Study</a>
<a href="#historical-context" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Historical Context</a>
<a href="#parent/child-indicators" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Parent/Child Indicators</a>
<a href="#55-related-indicators-comparison" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">5.5 Related Indicators Comparison</a>
<a href="#advanced-signal-reference" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">Advanced Signal Reference</a>
<a href="#threshold-matrix" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Threshold Matrix</a>
<a href="#signal-patterns" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Signal Patterns</a>
<a href="#screening-filters" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Screening Filters</a>
<a href="#combination-strategies" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Combination Strategies</a>

                        </nav>
                        <div class="mt-8 pt-4 border-t border-slate-100">
                            <a href="#" class="text-xs text-slate-400 hover:text-indigo-600 flex items-center transition-colors">
                                Back to Top
                            </a>
                        </div>
                    </div>
                </aside>
            </div>
        </section>


    </div>


        <!-- Footer -->
    <footer class="bg-white border-t border-slate-200 mt-12">
        <div class="max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8">
            <p class="text-center text-slate-400 text-sm">
                &copy; 2026 I ant I Investigates
            </p>
        </div>
    </footer>
        <!-- ========================================== -->
    <!-- 1. DATA & LOGIC INJECTION                  -->
    <!-- ========================================== -->
    <script>
        window.IndicatorLogic = {
            name: "ZigZag",
            params: [],
            calculate: null
        };
        (function() {
            try {
                const injectedCode = `
        window.IndicatorLogic = {
            calculate: (data, params) => {
                const threshold = params.threshold || 5.0;
                const result = ZigZag.calculate(data, threshold);
                // Handle both array and object returns
                if (Array.isArray(result)) {
                    return { main: result };
                }
                return result;
            }
        };
        `;
                const isTemplatePlaceholder = injectedCode.includes('{{') && injectedCode.includes('CODE_INDICATOR_LOGIC');
                if (injectedCode && injectedCode.trim().length > 0 && !isTemplatePlaceholder) {
                    new Function(injectedCode)();
                } else {
                    console.warn("Playground Logic: Running in Preview/Fallback mode.");
                    window.IndicatorLogic.calculate = () => []; 
                }
            } catch (e) {
                console.error("Critical Error in Logic Injection:", e);
                window.IndicatorLogic.calculate = () => [];
            }
        })();
    </script>

    <!-- ========================================== -->
    <!-- 2. VISUALIZATION ENGINE                    -->
    <!-- ========================================== -->
    <script>
        mermaid.initialize({ startOnLoad: false, theme: 'neutral', securityLevel: 'loose' });
    </script>
    <!-- ========================================== -->
    <!-- 3. UI CONTROLLERS & APP INITIALIZATION     -->
    <!-- ========================================== -->
    <!-- INLINE UI CONTROLLERS (PORTED FROM 0117) -->
    <script src="../assets/js/ZigZag.js"></script>
    <!-- JSON Data Containers (XSS-safe) -->
    <script id="data-indicator-config" type="application/json">
[{"id": "threshold", "label": "Threshold (5.0)", "type": "number", "value": 5.0, "min": 0.0, "max": 1.0, "step": 0.01}]
    </script>
    <script id="data-indicator-display" type="application/json">
{"isOverlay": true, "plots": {"main": {"label": "ZigZag", "color": "#4f46e5", "type": "line"}}}
    </script>
    <script>
        // --- 0. Indicator Data Injection ---
        // Use existing IndicatorLogic (set in earlier script block), only set if not exists
        var IndicatorLogic = window.IndicatorLogic || { calculate: null };
        var IndicatorConfig = [];
        var IndicatorDisplay = { isOverlay: false, plots: {} };

        // 1. Library Code - loaded externally before this block

        // 2. Configuration (XSS-safe via script type="application/json")
        try {
            var configEl = document.getElementById('data-indicator-config');
            if(configEl && configEl.textContent.trim()) {
                IndicatorConfig = JSON.parse(configEl.textContent);
            }
        } catch(e){ console.warn('Config parse error', e); }

        try {
            var displayEl = document.getElementById('data-indicator-display');
            if(displayEl && displayEl.textContent.trim()) {
                IndicatorDisplay = JSON.parse(displayEl.textContent);
            }
        } catch(e){ console.warn('Display parse error', e); }

        // 3. Logic Adapter
        window.IndicatorLogic = {
            calculate: (data, params) => {
                const threshold = params.threshold || 5.0;
                const result = ZigZag.calculate(data, threshold);
                // Handle both array and object returns
                if (Array.isArray(result)) {
                    return { main: result };
                }
                return result;
            }
        };
    </script>

    <!-- UI Controllers: indicator.js loads first to define PlaygroundController -->
    <script src="../assets/js/indicator.js" defer></script>
    <!-- script.js loads second, skips PlaygroundController if already defined -->
    <script src="../assets/js/script.js" defer></script>

</body>
</html>