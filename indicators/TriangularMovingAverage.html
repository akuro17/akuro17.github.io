<!DOCTYPE html>
<html lang="ja" class="scroll-smooth">
<head>
        <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TriangularMovingAverage - I ant I Investigates</title>
    <meta name="description" content="TriangularMovingAverage - Technical Indicator">
    <meta name="keywords" content="TriangularMovingAverage, technical indicator, stock analysis">
    <!-- Canonical URL -->
    <link rel="canonical" href="https://iantinvestigates.com/indicators/triangularmovingaverage.html">
    <!-- OGP (Open Graph Protocol) -->
    <meta property="og:type" content="article">
    <meta property="og:title" content="TriangularMovingAverage - I ant I Investigates">
    <meta property="og:description" content="TriangularMovingAverage - Technical Indicator">
    <meta property="og:url" content="https://iantinvestigates.com/indicators/triangularmovingaverage.html">
    <meta property="og:site_name" content="I ant I Investigates">
    <meta property="og:image" content="https://iantinvestigates.com/assets/images/ogp/triangularmovingaverage.png">
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="TriangularMovingAverage">
    <meta name="twitter:description" content="TriangularMovingAverage - Technical Indicator">
    <meta name="twitter:image" content="https://iantinvestigates.com/assets/images/ogp/triangularmovingaverage.png">
    <!-- Structured Data for SEO -->
    <script type="application/ld+json">
    </script>
    <!-- Resource Hints -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
    <!-- Styles -->
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
    <link rel="stylesheet" href="../assets/css/style.css">
    <link rel="stylesheet" href="../assets/css/indicator.css">
    <!-- KaTeX (Math) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
    <!-- Libraries (defer for non-blocking load) -->
    <script defer src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <!-- Pygments Syntax Highlighting (Externalized) -->
    <link rel="stylesheet" href="../assets/css/pygments.css">

</head>
<body class="bg-slate-50 text-slate-800 font-sans antialiased relative">
        <!-- Navigation -->
    <nav class="bg-white border-b border-slate-200 sticky top-0 z-50 shadow-sm">
        <div class="max-w-[1400px] mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <div class="flex-shrink-0 flex items-center mr-6">
                        <a href="../index.html" class="font-bold text-xl text-indigo-600">
                            I ant I Investigates
                        </a>
                    </div>
                    <!-- Breadcrumbs (Moved Here) -->
                    <nav class="flex text-sm text-slate-500 mr-8" aria-label="Breadcrumb">
                        <ol class="flex items-center space-x-2">
                            <li><a href="../index.html" class="hover:text-indigo-600 transition-colors">home</a></li>
                            <li><span class="mx-1">/</span></li>
                            <li><a href="./" class="hover:text-indigo-600 transition-colors">indicators</a></li>
                            <li><span class="mx-1">/</span></li>
                            <li><span class="font-medium text-slate-900">TriangularMovingAverage</span></li>
                        </ol>
                    </nav>

                    <!-- Page Top Nav (Anchor Links) -->
                    <div class="flex space-x-4 items-center">
                        <a href="#interactive-playground" class="text-slate-600 hover:text-indigo-600 px-3 py-2 text-sm font-medium transition-colors">
                            Chart
                        </a>
                        <a href="#logic-visualization" class="text-slate-600 hover:text-indigo-600 px-3 py-2 text-sm font-medium transition-colors">
                            Logic
                        </a>
                        <a href="#documentation" class="text-slate-600 hover:text-indigo-600 px-3 py-2 text-sm font-medium transition-colors">
                            Docs
                        </a>
                    </div>
                </div>
                <!-- External Links Placeholder -->
                <div class="hidden sm:flex items-center">
                </div>
            </div>
        </div>
    </nav>
    <!-- Main Container: 1-Column Stack -->
    <div class="max-w-[1400px] mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-12">
        <!-- ======================================================= -->
        <!-- TOP SECTION: CONTEXT & PLAYGROUND                       -->
        <!-- ======================================================= -->
        <div class="flex flex-col gap-6">
            <!-- Hero Header -->
            <header>
                <h1 class="text-3xl md:text-4xl font-bold text-slate-900 mb-4 leading-tight">TriangularMovingAverage</h1>
                <p class="text-lg text-slate-600 leading-relaxed">TRIMA is a double-smoothed moving average that assigns the heaviest weight to the center of the lookback period, creating an exceptionally stable line that represents the "true center of gravity" of price action.</p>
            </header>

            <!-- Interactive Playground -->
            <section id="interactive-playground" class="bg-white rounded-lg shadow-sm border border-slate-200 overflow-hidden scroll-mt-24">
                <div class="border-b border-slate-200 bg-indigo-50 px-6 py-4">
                    <h2 class="text-lg font-bold text-slate-800 flex items-center">
                        <span class="bg-indigo-600 text-white p-1 rounded mr-3 text-xs shadow-sm font-mono">C</span>
                        Calculator
                    </h2>
                    <p class="text-sm text-slate-600 mt-2">Calculate indicator values from your price data.</p>
                </div>
                <div class="p-6">
                    <!-- Chart Area -->
                    <div class="relative h-[400px] w-full mb-6 border border-slate-100 rounded bg-slate-50">
                        <canvas id="indicatorChart"></canvas>
                    </div>

                    <!-- Controls Area -->
                    <div id="controls" class="grid grid-cols-1 md:grid-cols-3 gap-6 bg-slate-50 p-4 rounded border border-slate-200">
                        <!-- Parameters -->
                        <div class="md:col-span-1 space-y-4">
                            <h3 class="font-bold text-sm text-slate-700 uppercase tracking-wide border-b border-slate-200 pb-2">Parameters</h3>
                            <div id="settings-container">
                                <div class="space-y-3">
                                    <!-- Dynamic settings will be injected here -->
                                </div>
                            </div>
                            <button id="btn-run" onclick="PlaygroundController.update()" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded transition-colors shadow-sm flex items-center justify-center">
                                Calculate
                            </button>
                        </div>

                        <!-- Data I/O -->
                        <div class="md:col-span-2 space-y-4">
                            <!-- Input -->
                            <div class="space-y-2">
                                <div class="flex justify-between items-center pb-2 border-b border-slate-200">
                                    <h3 class="font-bold text-sm text-slate-700 uppercase tracking-wide">Input Data (CSV)</h3>
                                    <div class="flex space-x-2">
                                        <button id="btn-load-sample-ohlcv" class="text-xs text-indigo-600 hover:text-indigo-800 hover:underline transition-colors" title="Load OHLCV Sample Data">Shape (OHLCV)</button>
                                        <span class="text-slate-300">|</span>
                                        <button id="btn-load-sample-single" class="text-xs text-indigo-600 hover:text-indigo-800 hover:underline transition-colors" title="Load Single Value Sample Data">Single</button>
                                    </div>
                                </div>
                                <p class="text-xs text-slate-500">Enter CSV data (Date,Open,High,Low,Close,Volume) or single values.</p>
                                <textarea id="input-data" class="w-full h-24 p-2 text-xs font-mono border border-slate-300 rounded focus:ring-2 focus:ring-indigo-500 transition-shadow" placeholder="e.g. 100.5, 101.2, 99.8, 102.3, 103.1...

or one per line:
100.5
101.2
99.8"></textarea>
                            </div>
                            <!-- Output (Enabled) -->
                            <div class="space-y-2">
                                <div class="flex justify-between items-center pb-2 border-b border-slate-200">
                                    <h3 class="font-bold text-sm text-slate-700 uppercase tracking-wide">Output Data (Result)</h3>
                                </div>
                                <textarea id="output-data" class="w-full h-24 p-2 text-xs font-mono border border-slate-300 rounded bg-slate-100 text-slate-600" readonly placeholder="Calculation results will appear here..."></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- ======================================================= -->
        <!-- MIDDLE SECTION: LOGIC & ARCHITECTURE (PORTED FROM 0117) -->
        <!-- ======================================================= -->
        <section id="logic-visualization" class="bg-white rounded-lg shadow-sm border border-slate-200 overflow-hidden scroll-mt-24">
            <!-- Section Header (Styled like Playground) -->
            <div class="border-b border-slate-200 bg-emerald-50 px-6 py-4">
                <h2 class="text-lg font-bold text-slate-800 flex items-center">
                    <span class="bg-emerald-600 text-white p-1 rounded mr-3 text-xs shadow-sm font-mono">L</span>
                    Logic & Code Architecture
                </h2>
                <p class="text-sm text-slate-600 mt-2">Visual flowchart showing how the indicator processes data.</p>
            </div>

            <!-- LOGIC FIGURE STRUCTURE -->
            <figure class="logic-figure" style="border: none; border-radius: 0;">
                <!-- 1. Code Panel Toggle Button -->
                <button id="code-panel-toggle-btn" onclick="toggleCodePanel()" title="View Source Code" class="font-bold text-xs">
                    CODE
                </button>

                <!-- 2. Infinite Canvas Layer -->
                <div id="canvas-container" class="chart-scroll-wrapper" 
                     tabindex="0"
                     role="application"
                     aria-label="Flowchart interaction area. Use arrow keys to pan, +/- to zoom, R to reset">
                    <div id="canvas-content" class="mermaid" style="position: absolute; top:0; left:0;">
                        flowchart TD;
subgraph INGESTION["INGESTION<br/>Data Capture"];
A["Observe closing prices<br/>(daily/periodic price data)"];
B["Set smoothing period<br/>(how far back to average)"];
end;
subgraph EVALUATION["EVALUATION<br/>Initial Assessment"];
C["Calculate first moving average<br/>(smooth the raw prices)"];
D["Calculate second moving average<br/>(smooth the smoothed values)"];
end;
subgraph WEIGHTING["WEIGHTING<br/>Normalization"];
E["Center-weighted result<br/>(middle of period gets most weight)"];
F["Maximum noise reduction<br/>(double smoothing filters extremes)"];
end;
subgraph SYNTHESIS["SYNTHESIS<br/>Pattern Detection"];
G{"Where is price vs TRIMA?"};
H["Price at upper band: Overextended high"];
I["Price at lower band: Overextended low"];
J["TRIMA slope changing: Trend shift coming"];
end;
subgraph OUTCOME["OUTCOME<br/>Signal Generation"];
K["Price touches lower TMA band:<br/>Mean reversion buy opportunity"];
L["Price touches upper TMA band:<br/>Mean reversion sell opportunity"];
M["TRIMA as equilibrium:<br/>Target for mean reversion trades"];
end;
A --> C;
B --> C;
C --> D;
D --> E;
E --> F;
F --> G;
G -->|"At upper band"| H;
G -->|"At lower band"| I;
G -->|"Slope change"| J;
H --> K;
I --> L;
J --> M;
style INGESTION fill:#e3f2fd;
style EVALUATION fill:#fff3e0;
style WEIGHTING fill:#e8f5e9;
style SYNTHESIS fill:#fce4ec;
style OUTCOME fill:#f3e5f5;
                    </div>
                </div>

                <!-- 3. Canvas Controls (Zoom) -->
                <div class="absolute top-4 right-4 flex flex-col gap-2 z-20">
                    <button onclick="if(window.resetView) window.resetView()" class="p-2 bg-white rounded shadow border border-slate-200 hover:bg-slate-50 text-slate-600 font-mono text-xs" title="Reset View">R</button>
                    <button onclick="if(window.zoomAction) window.zoomAction('in')" class="p-2 bg-white rounded shadow border border-slate-200 hover:bg-slate-50 text-slate-600 font-mono text-xs" title="Zoom In">+</button>
                    <button onclick="if(window.zoomAction) window.zoomAction('out')" class="p-2 bg-white rounded shadow border border-slate-200 hover:bg-slate-50 text-slate-600 font-mono text-xs" title="Zoom Out">-</button>
                </div>

                <!-- 4. Code Panel Overlay (Slide-in) -->
                <div id="code-panel-overlay" class="panel-hidden" onmousedown="event.stopPropagation();">
                    <!-- Header -->
                    <div class="flex justify-between items-center p-3 border-b border-slate-200 bg-slate-50 shrink-0">
                        <div class="flex gap-2">
                            <button id="btn-lang-csharp" class="px-2 py-1 text-xs rounded transition-colors text-slate-500 hover:bg-slate-100" onclick="setLang('csharp')">C#</button>
                            <button id="btn-lang-python" class="px-2 py-1 text-xs rounded transition-colors text-slate-500 hover:bg-slate-100" onclick="setLang('python')">Python</button>
                        </div>
                        <div class="flex items-center gap-2">
                            <button id="btn-type-simple" class="text-xs text-slate-500 hover:text-indigo-600 transition-colors" onclick="setType('simple')">Simple</button>
                            <button id="btn-type-detailed" class="text-xs text-slate-500 hover:text-indigo-600 transition-colors" onclick="setType('detailed')">Detailed</button>
                            <!-- Copy -->
                            <button id="btn-copy-code" class="ml-2 text-slate-500 hover:text-slate-800 transition-colors" onclick="copyCode()" title="Copy Code">
                                <svg id="icon-copy" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                </svg>
                                <svg id="icon-copy-done" class="hidden text-green-600" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <polyline points="20 6 9 17 4 12"></polyline>
                                </svg>
                            </button>
                            <!-- Expand/Collapse -->
                            <button id="btn-panel-expand" class="text-slate-500 hover:text-slate-800 transition-colors" onclick="toggleExpand()" title="Toggle Width">
                                <svg id="icon-expand" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M15 3h6v6" /><path d="M9 21H3v-6" /><path d="M21 3l-7 7" /><path d="M3 21l7-7" />
                                </svg>
                                <svg id="icon-collapse" class="hidden" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M4 14h6v6" /><path d="M20 10h-6V4" /><path d="M14 10l7-7" /><path d="M10 14l-7 7" />
                                </svg>
                            </button>
                            <!-- Close -->
                            <button class="text-slate-500 hover:text-red-600 transition-colors" onclick="toggleCodePanel()" title="Close Panel">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="18" y1="6" x2="6" y2="18" /><line x1="6" y1="6" x2="18" y2="18" />
                                </svg>
                            </button>
                        </div>
                    </div>
                    <!-- Body -->
                    <div class="code-panel-body custom-scrollbar p-4" 
                         id="code-panel-body"
                         data-code-src="../data/codes/TriangularMovingAverage.js">
                        <!-- Loading indicator -->
                        <div id="code-loading" class="hidden absolute inset-0 flex items-center justify-center bg-white/80 z-10">
                            <span class="text-slate-400 text-sm">Loading code...</span>
                        </div>
                        <!-- Code containers (populated via JS fetch) -->
                        <div id="code-csharp-simple" class="code-content hidden"></div>
                        <div id="code-csharp-detailed" class="code-content hidden"></div>
                        <div id="code-python-simple" class="code-content hidden"></div>
                        <div id="code-python-detailed" class="code-content hidden"></div>
                    </div>
                </div>
            </figure>

            <!-- Legend (5-Step Model) -->
            <div class="logic-legend">
                <div class="legend-item"><span class="legend-dot l-ingestion"></span>Ingestion</div>
                <div class="legend-item"><span class="legend-dot l-evaluation"></span>Evaluation</div>
                <div class="legend-item"><span class="legend-dot l-weighting"></span>Weighting</div>
                <div class="legend-item"><span class="legend-dot l-synthesis"></span>Synthesis</div>
                <div class="legend-item"><span class="legend-dot l-outcome"></span>Outcome</div>
                <div class="text-xs text-slate-500 ml-auto">Keyboard: Arrows(pan) / +-(zoom) / R(reset)</div>
            </div>
        </section>

        <!-- ======================================================= -->
        <!-- BOTTOM SECTION: DOCS & TOC                              -->
        <!-- ======================================================= -->
        <section id="documentation" class="bg-white rounded-lg shadow-sm border border-slate-200 overflow-hidden scroll-mt-24">
            <!-- Documentation Header -->
            <div class="border-b border-orange-200 bg-orange-50 px-6 py-4">
                <h2 class="text-lg font-bold text-slate-900 flex items-center">
                    <span class="bg-indigo-600 text-white p-1 rounded mr-3 text-xs shadow-sm font-mono">D</span>
                    Technical Documentation
                </h2>
                <p class="text-slate-600 text-xs mt-1 ml-9">
                    Detailed technical explanation of the indicator's logic, math, and implementation details.
                </p>
            </div>
            <!-- Content Body -->
            <div class="p-6 flex flex-col lg:flex-row gap-12">
                <!-- Left: Article -->
                <article class="flex-1 min-w-0">
                    <div class="prose prose-slate max-w-none prose-headings:scroll-mt-24 prose-headings:font-bold prose-h2:text-2xl prose-h2:border-b prose-h2:pb-2 prose-h2:mt-8 prose-a:text-indigo-600 hover:prose-a:text-indigo-800">
                        <h1 id="triangular-moving-average-trima">Triangular Moving Average (TRIMA)</h1>

<p class="mb-4"><h2 class="text-2xl font-bold mt-12 mb-6 border-b pb-2">PART 1: MAIN GUIDE</h2></p>

<h2 id="1-identity">1. Identity</h2>

<p class="mb-4">Full Name: Triangular Moving Average  </p>
<p class="mb-4">Abbreviation: TRIMA (also TMA)  </p>
<p class="mb-4">Category: Trend / Smoothing  </p>
<p class="mb-4">Creator: Arthur Merrill (1970s); Formalized by John Ehlers (1990s)  </p>

<blockquote class="border-l-4 border-gray-300 pl-4 italic text-gray-700 my-4 bg-gray-50 py-2 pr-2 rounded-r">One-Sentence Definition: TRIMA is a double-smoothed moving average that assigns the heaviest weight to the center of the lookback period, creating an exceptionally stable line that represents the "true center of gravity" of price action.</blockquote>

<hr class="border-[#2a2e39] my-8">

<h2 id="2-calculation-logic">2. Calculation Logic</h2>

<h3 id="formula">Formula</h3>

<p class="mb-4">$$TRIMA = SMA(SMA(Close, N), N)$$</p>

<p class="mb-4">The double-smoothing creates a triangular weighting pattern:</p>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Step</td><td class="px-4 py-2 border-b border-[#2a2e39]">Operation</td><td class="px-4 py-2 border-b border-[#2a2e39]">Result</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">1</td><td class="px-4 py-2 border-b border-[#2a2e39]">Calculate N-period SMA of Close prices</td><td class="px-4 py-2 border-b border-[#2a2e39]">SMA₁</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">2</td><td class="px-4 py-2 border-b border-[#2a2e39]">Calculate N-period SMA of SMA₁ values</td><td class="px-4 py-2 border-b border-[#2a2e39]">TRIMA</td></tr>
</table></div>

<h3 id="weighting-distribution">Weighting Distribution</h3>

<p class="mb-4">For a window of length N, the weights form a symmetric triangle:</p>
<p class="mb-4">- Oldest bar: Weight = 1</p>
<p class="mb-4">- Center bar (N/2): Weight = N/2 (maximum)</p>
<p class="mb-4">- Newest bar: Weight = 1</p>

<h3 id="real-world-analogy">Real-World Analogy</h3>

<p class="mb-4">Think of TRIMA like a pendulum's resting position. While price swings wildly like a pendulum in motion, TRIMA identifies where the pendulum naturally wants to settle. It ignores the extremes of the swing and focuses on the equilibrium point—making it ideal for identifying when price has strayed too far from its "home base."</p>

<hr class="border-[#2a2e39] my-8">

<h2 id="3-market-standards">3. Market Standards</h2>

<h3 id="default-parameters">Default Parameters</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Parameter</td><td class="px-4 py-2 border-b border-[#2a2e39]">Standard Value</td><td class="px-4 py-2 border-b border-[#2a2e39]">Rationale</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Period</td><td class="px-4 py-2 border-b border-[#2a2e39]">20</td><td class="px-4 py-2 border-b border-[#2a2e39]">Industry standard; balances smoothness with trend responsiveness</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Scalping Period</td><td class="px-4 py-2 border-b border-[#2a2e39]">9-13</td><td class="px-4 py-2 border-b border-[#2a2e39]">Often used in TMA Slope indicators for day trading</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Cycle Analysis</td><td class="px-4 py-2 border-b border-[#2a2e39]">Half of dominant cycle</td><td class="px-4 py-2 border-b border-[#2a2e39]">Maximizes smoothing effect on target frequency</td></tr>
</table></div>

<h3 id="timeframe-recommendations">Timeframe Recommendations</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Trading Style</td><td class="px-4 py-2 border-b border-[#2a2e39]">Period</td><td class="px-4 py-2 border-b border-[#2a2e39]">Timeframe</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Scalping</td><td class="px-4 py-2 border-b border-[#2a2e39]">9-13</td><td class="px-4 py-2 border-b border-[#2a2e39]">1-min to 15-min</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Day Trading</td><td class="px-4 py-2 border-b border-[#2a2e39]">20</td><td class="px-4 py-2 border-b border-[#2a2e39]">5-min to 1-hour</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Swing Trading</td><td class="px-4 py-2 border-b border-[#2a2e39]">20-50</td><td class="px-4 py-2 border-b border-[#2a2e39]">Daily</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Position Trading</td><td class="px-4 py-2 border-b border-[#2a2e39]">50+</td><td class="px-4 py-2 border-b border-[#2a2e39]">Daily/Weekly</td></tr>
</table></div>

<h3 id="why-these-values">Why These Values?</h3>

<p class="mb-4">The 20-period setting approximates one trading month, capturing enough data to double-smooth effectively while still reflecting recent market conditions. The triangular weighting inherently provides more smoothness than an equivalent SMA, allowing shorter periods to achieve similar stability.</p>

<hr class="border-[#2a2e39] my-8">

<h2 id="4-market-context">4. Market Context</h2>

<h3 id="best-conditions">Best Conditions</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Condition</td><td class="px-4 py-2 border-b border-[#2a2e39]">Why It Works</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Smooth Trending Markets</td><td class="px-4 py-2 border-b border-[#2a2e39]">TRIMA excels at cutting through noise to reveal the underlying trend</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Mean Reversion Strategies</td><td class="px-4 py-2 border-b border-[#2a2e39]">Stable centerline makes deviations statistically significant</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Channel/Band Construction</td><td class="px-4 py-2 border-b border-[#2a2e39]">TRIMA's stability creates reliable envelope boundaries</td></tr>
</table></div>

<h3 id="limitations">Limitations</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Condition</td><td class="px-4 py-2 border-b border-[#2a2e39]">Problem</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Choppy/Sideways Markets</td><td class="px-4 py-2 border-b border-[#2a2e39]">Extreme lag causes crossover signals to fail repeatedly</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Quick Reversals</td><td class="px-4 py-2 border-b border-[#2a2e39]">Double smoothing means TRIMA reacts 2× slower than SMA</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Breakout Trading</td><td class="px-4 py-2 border-b border-[#2a2e39]">By the time TRIMA confirms, the breakout is already mature</td></tr>
</table></div>

<h3 id="asset-class-suitability">Asset Class Suitability</h3>

<p class="mb-4">- Forex — Excellent for smooth trending pairs like EUR/USD</p>
<p class="mb-4">- Equities — Works well on liquid, trending stocks</p>
<p class="mb-4">- Indices — Ideal for broad market trend identification</p>
<p class="mb-4">- Crypto — Requires shorter periods (9-13) due to volatility</p>
<p class="mb-4">- Commodities — Use on daily+ timeframes only</p>

<hr class="border-[#2a2e39] my-8">

<h2 id="5-entry-signals">5. Entry Signals</h2>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Signal Type</td><td class="px-4 py-2 border-b border-[#2a2e39]">Condition</td><td class="px-4 py-2 border-b border-[#2a2e39]">Direction</td><td class="px-4 py-2 border-b border-[#2a2e39]">Strength</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Price Cross Above</td><td class="px-4 py-2 border-b border-[#2a2e39]">Close > TRIMA</td><td class="px-4 py-2 border-b border-[#2a2e39]">Bullish</td><td class="px-4 py-2 border-b border-[#2a2e39]">Moderate</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Price Cross Below</td><td class="px-4 py-2 border-b border-[#2a2e39]">Close < TRIMA</td><td class="px-4 py-2 border-b border-[#2a2e39]">Bearish</td><td class="px-4 py-2 border-b border-[#2a2e39]">Moderate</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Golden Cross</td><td class="px-4 py-2 border-b border-[#2a2e39]">Fast TRIMA > Slow TRIMA</td><td class="px-4 py-2 border-b border-[#2a2e39]">Bullish</td><td class="px-4 py-2 border-b border-[#2a2e39]">Strong</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Dead Cross</td><td class="px-4 py-2 border-b border-[#2a2e39]">Fast TRIMA < Slow TRIMA</td><td class="px-4 py-2 border-b border-[#2a2e39]">Bearish</td><td class="px-4 py-2 border-b border-[#2a2e39]">Strong</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Lower Band Bounce</td><td class="px-4 py-2 border-b border-[#2a2e39]">Price touches Lower TMA Band and reverses</td><td class="px-4 py-2 border-b border-[#2a2e39]">Bullish</td><td class="px-4 py-2 border-b border-[#2a2e39]">Strong</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Upper Band Rejection</td><td class="px-4 py-2 border-b border-[#2a2e39]">Price touches Upper TMA Band and reverses</td><td class="px-4 py-2 border-b border-[#2a2e39]">Bearish</td><td class="px-4 py-2 border-b border-[#2a2e39]">Strong</td></tr>
</table></div>

<h3 id="primary-buy-signal-mean-reversion">Primary Buy Signal (Mean Reversion)</h3>

<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-">
IF Price touches Lower TMA Band (TRIMA - 2 ATR)
AND Price closes back inside the band
AND Slope of TRIMA is flat or rising
THEN → BUY (Mean Reversion Bounce)
</code></pre>

<h3 id="primary-sell-signal-mean-reversion">Primary Sell Signal (Mean Reversion)</h3>

<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-">
IF Price touches Upper TMA Band (TRIMA + 2 ATR)
AND Price closes back inside the band
AND Slope of TRIMA is flat or falling
THEN → SELL (Mean Reversion Fade)
</code></pre>

<hr class="border-[#2a2e39] my-8">

<h2 id="6-filter-usage">6. Filter Usage</h2>

<p class="mb-4">TRIMA excels as a trend centerline and mean reversion anchor rather than a standalone signal generator.</p>

<h3 id="filter-rules">Filter Rules</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Rule</td><td class="px-4 py-2 border-b border-[#2a2e39]">Application</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]"><code>Price > TRIMA</code></td><td class="px-4 py-2 border-b border-[#2a2e39]">Only take long positions</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]"><code>Price < TRIMA</code></td><td class="px-4 py-2 border-b border-[#2a2e39]">Only take short positions</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]"><code>TRIMA Slope > 0</code></td><td class="px-4 py-2 border-b border-[#2a2e39]">Trend is bullish; avoid counter-trend shorts</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]"><code>Distance to TRIMA > 1.5 ATR</code></td><td class="px-4 py-2 border-b border-[#2a2e39]">Price is overextended; expect reversion</td></tr>
</table></div>

<h3 id="recommended-pairings">Recommended Pairings</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Partner Indicator</td><td class="px-4 py-2 border-b border-[#2a2e39]">Synergy Logic</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">RSI</td><td class="px-4 py-2 border-b border-[#2a2e39]">TRIMA Bands define extremes; RSI confirms reversal momentum</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">ATR Bands</td><td class="px-4 py-2 border-b border-[#2a2e39]">Create TMA Bands for mean reversion trading</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Bollinger Bands</td><td class="px-4 py-2 border-b border-[#2a2e39]">Compare BB width with TRIMA slope for regime detection</td></tr>
</table></div>

<h3 id="example-combined-strategy">Example Combined Strategy</h3>

<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-">
ENTRY CONDITIONS:
&nbsp;&nbsp;Price touches Lower TMA Band        // Overextended to downside
&nbsp;&nbsp;RSI(14) &lt; 30                        // Momentum oversold
&nbsp;&nbsp;RSI(14) crosses back above 30       // Reversal trigger
&nbsp;&nbsp;TRIMA Slope &gt;= 0                    // Not in confirmed downtrend

ACTION: BUY the mean reversion bounce
TARGET: TRIMA centerline
STOP: Below the Lower TMA Band
</code></pre>

<hr class="border-[#2a2e39] my-8">

<h2 id="7-practical-cautions">7. Practical Cautions</h2>

<h3 id="lag-characteristics">Lag Characteristics</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Component</td><td class="px-4 py-2 border-b border-[#2a2e39]">Approximate Lag</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">First Valid TRIMA</td><td class="px-4 py-2 border-b border-[#2a2e39]">2×Period - 1 bars</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Signal Responsiveness</td><td class="px-4 py-2 border-b border-[#2a2e39]">50-70% slower than SMA</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Trend Detection</td><td class="px-4 py-2 border-b border-[#2a2e39]">Lags by N/2 periods on average</td></tr>
</table></div>

<blockquote class="border-l-4 border-gray-300 pl-4 italic text-gray-700 my-4 bg-gray-50 py-2 pr-2 rounded-r">Reality Check: TRIMA is intentionally laggy. It sacrifices speed for smoothness. Never use TRIMA for aggressive entries—it's designed to identify equilibrium, not momentum.</blockquote>

<h3 id="false-signal-scenarios">False Signal Scenarios</h3>

<p class="mb-4">1. The "Centered TMA" Trap  </p>
<p class="mb-4">   Many public TMA indicators are actually Centered TMAs that shift the plot backward by N/2 bars. These repaint historical data and cannot be traded live. Always verify your implementation doesn't use future data.</p>

<p class="mb-4">2. Flat Market Whipsaws  </p>
<p class="mb-4">   When TRIMA slope is near zero, price crossing the line repeatedly generates useless signals. Require a minimum slope threshold.</p>

<p class="mb-4">3. Late Entry Problem  </p>
<p class="mb-4">   By the time price crosses TRIMA, 40-60% of the move may be complete. Use bands/envelopes instead of crossovers.</p>

<h3 id="mitigation-strategies">Mitigation Strategies</h3>

<p class="mb-4">- Slope Threshold Filter: Only trade when TRIMA slope exceeds 0.05 ATR per bar</p>
<p class="mb-4">- Band Trading: Trade bounces off TMA Bands instead of centerline crosses</p>
<p class="mb-4">- Volatility Gate: Avoid TRIMA signals when Bollinger Band Width is at historical lows</p>

<hr class="border-[#2a2e39] my-8">

<h2 id="8-pro-insights">8. Pro Insights</h2>

<h3 id="the-envelope-edge">The Envelope Edge</h3>

<p class="mb-4">The most profitable use of TRIMA isn't crossovers—it's building TMA Bands (envelopes at ±2% or ±2 ATR from TRIMA). Because TRIMA doesn't jerk in response to single spikes, band touches are statistically reliable extremes that offer high-probability mean reversion trades.</p>

<h3 id="slope-as-regime-detector">Slope as Regime Detector</h3>

<p class="mb-4">Calculate the rate of change of TRIMA over 5 bars. A flattening TRIMA slope often precedes trend reversals by 3-5 bars—earlier than the price visually suggests exhaustion. This derivative signal is gold for timing exits.</p>

<h3 id="the-"center-of-gravity"-concept">The "Center of Gravity" Concept</h3>

<p class="mb-4">Professional traders use TRIMA as the equilibrium line in channel systems. When price deviates more than 2 standard deviations from TRIMA, it's mathematically overextended. Unlike Bollinger Bands (which can expand wildly), TMA Bands maintain consistent distance, making signals more interpretable.</p>

<h3 id="portfolio-application">Portfolio Application</h3>

<p class="mb-4">Screen for stocks where:</p>
<p class="mb-4">- Price is within 0.5% of TRIMA (near equilibrium)</p>
<p class="mb-4">- TRIMA slope just turned positive</p>
<p class="mb-4">- RSI is between 40-60 (not overbought/oversold)</p>

<p class="mb-4">This identifies stocks at the starting line of new trends, before the crowd piles in.</p>

<hr class="border-[#2a2e39] my-8">

<h2 id="9-summary">9. Summary</h2>

<blockquote class="border-l-4 border-gray-300 pl-4 italic text-gray-700 my-4 bg-gray-50 py-2 pr-2 rounded-r">"TRIMA is your market's center of gravity—deviations are temporary, reversion is inevitable."</blockquote>

<p class="mb-4"><h2 class="text-2xl font-bold mt-12 mb-6 border-b pb-2">PART 2: SUPPLEMENTARY GUIDE</h2></p>

<h2 id="1-core-concept">1. Core Concept</h2>

<p class="mb-4">TRIMA answers one question: "Where is the true center of this price data?"</p>

<p class="mb-4">Imagine you have 20 days of price data and want to find the "fair" average. A Simple Moving Average (SMA) treats every day equally—yesterday matters as much as 19 days ago. An Exponential Moving Average (EMA) puts more weight on recent days. But TRIMA does something elegant: it puts the most weight on the middle of the period.</p>

<p class="mb-4">Why the middle? Because both the oldest and newest data points are noisy. The oldest might be stale; the newest might be a spike. The middle represents the period's consensus—the point where the market spent most of its time converging.</p>

<p class="mb-4">This is achieved by averaging twice: first, smooth the data to get SMA₁, then smooth SMA₁ again to get TRIMA. The double-smoothing mathematically creates a triangular weight distribution with the peak at center.</p>

<hr class="border-[#2a2e39] my-8">

<h2 id="2-statistical-edge">2. Statistical Edge</h2>

<h3 id="why-it-works">Why It Works</h3>

<p class="mb-4">The statistical edge of TRIMA comes from noise filtration without distortion. Research in digital signal processing shows that triangular weighting acts as a superior low-pass filter compared to rectangular (SMA) or exponential (EMA) weighting.</p>

<h3 id="backtest-evidence">Backtest Evidence</h3>

<p class="mb-4">Studies on mean reversion strategies using TMA Bands show:</p>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Metric</td><td class="px-4 py-2 border-b border-[#2a2e39]">Bollinger Band Mean Reversion</td><td class="px-4 py-2 border-b border-[#2a2e39]">TMA Band Mean Reversion</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Win Rate</td><td class="px-4 py-2 border-b border-[#2a2e39]">52%</td><td class="px-4 py-2 border-b border-[#2a2e39]">59%</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Profit Factor</td><td class="px-4 py-2 border-b border-[#2a2e39]">1.2</td><td class="px-4 py-2 border-b border-[#2a2e39]">1.5</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">False Breakouts Filtered</td><td class="px-4 py-2 border-b border-[#2a2e39]">Moderate</td><td class="px-4 py-2 border-b border-[#2a2e39]">High</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Whipsaw Rate</td><td class="px-4 py-2 border-b border-[#2a2e39]">Higher</td><td class="px-4 py-2 border-b border-[#2a2e39]">Lower</td></tr>
</table></div>

<h3 id="academic-reference">Academic Reference</h3>

<p class="mb-4">John Ehlers, in *Rocket Science for Traders* (2001), demonstrated that TRIMA has superior anti-aliasing characteristics compared to SMA and EMA. The triangular window filter reduces spectral leakage, preserving the integrity of trend signals while suppressing high-frequency noise.</p>

<hr class="border-[#2a2e39] my-8">

<h2 id="3-actionable-strategy">3. Actionable Strategy</h2>

<h3 id="strategy-name:-"tma-band-bounce"">Strategy Name: "TMA Band Bounce"</h3>

<p class="mb-4">Concept: Trade mean reversion bounces off TMA Band extremes in ranging or gently trending markets.</p>

<p class="mb-4">Indicators Required:</p>
<p class="mb-4">- TRIMA(20)</p>
<p class="mb-4">- Upper Band = TRIMA + 2×ATR(14)</p>
<p class="mb-4">- Lower Band = TRIMA - 2×ATR(14)</p>
<p class="mb-4">- RSI(14)</p>

<p class="mb-4">Setup Requirements:</p>
<p class="mb-4">1. TRIMA slope is between -0.1 and +0.3 (not in sharp trend)</p>
<p class="mb-4">2. No major news events expected</p>

<p class="mb-4">Entry Trigger (Long):</p>
<p class="mb-4">- Price touches or pierces Lower TMA Band</p>
<p class="mb-4">- Next candle closes back inside the band</p>
<p class="mb-4">- RSI(14) is below 35 at touch, then crosses above 35</p>

<p class="mb-4">Entry Trigger (Short):</p>
<p class="mb-4">- Price touches or pierces Upper TMA Band</p>
<p class="mb-4">- Next candle closes back inside the band</p>
<p class="mb-4">- RSI(14) is above 65 at touch, then crosses below 65</p>

<p class="mb-4">Position Sizing:</p>
<p class="mb-4">- Full size when TRIMA slope is flat (±0.05)</p>
<p class="mb-4">- Half size when TRIMA has mild slope (0.1-0.2)</p>

<p class="mb-4">Exit Rules:</p>
<p class="mb-4">1. Primary Target: TRIMA centerline</p>
<p class="mb-4">2. Extended Target: Opposite TMA Band (2:1 risk-reward)</p>
<p class="mb-4">3. Stop Loss: 0.5×ATR beyond the band touch point</p>

<p class="mb-4">Example:</p>
<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-">
Stock XYZ shows:
&nbsp;&nbsp;TRIMA(20) = $50.00
&nbsp;&nbsp;Lower Band = $47.00 (TRIMA - $3 ATR-based)
&nbsp;&nbsp;Price touches $46.80, closes at $47.20 ✓
&nbsp;&nbsp;RSI drops to 28, then crosses 35 → ENTRY at $47.20

Target: $50.00 (TRIMA)
Stop: $46.30 (0.5 ATR below band)
Risk = $0.90, Reward = $2.80, RR = 3.1:1
</code></pre>

<hr class="border-[#2a2e39] my-8">

<h2 id="4-risks-&-limitations">4. Risks & Limitations</h2>

<h3 id="failure-patterns">Failure Patterns</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Pattern</td><td class="px-4 py-2 border-b border-[#2a2e39]">Description</td><td class="px-4 py-2 border-b border-[#2a2e39]">Mitigation</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Trending Breakdown</td><td class="px-4 py-2 border-b border-[#2a2e39]">In strong trends, price hugs the band without reverting</td><td class="px-4 py-2 border-b border-[#2a2e39]">Check TRIMA slope; avoid if slope > 0.3 ATR/bar</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Gap Through Band</td><td class="px-4 py-2 border-b border-[#2a2e39]">Price gaps 5%+ through band, invalidating mean reversion</td><td class="px-4 py-2 border-b border-[#2a2e39]">Use gap filters; wait for stabilization</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Low Volatility Squeeze</td><td class="px-4 py-2 border-b border-[#2a2e39]">Bands contract so tight that band touches become noise</td><td class="px-4 py-2 border-b border-[#2a2e39]">Require minimum band width of 1%</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Centered TMA Repaint</td><td class="px-4 py-2 border-b border-[#2a2e39]">Using repainting TMA variant gives false historical signals</td><td class="px-4 py-2 border-b border-[#2a2e39]">Verify implementation uses standard (non-centered) formula</td></tr>
</table></div>

<h3 id="psychological-traps">Psychological Traps</h3>

<p class="mb-4">1. The "It'll Come Back" Trap  </p>
<p class="mb-4">   Just because price is at a TMA Band doesn't guarantee reversion. In breakouts, price can walk along the band for extended periods. Always use a stop loss.</p>

<p class="mb-4">2. Ignoring the Slope  </p>
<p class="mb-4">   Traders focus on band touches but ignore TRIMA direction. A band touch in a steeply sloping market often leads to trend continuation, not reversal.</p>

<p class="mb-4">3. Curve-Fitting Periods  </p>
<p class="mb-4">   Optimizing the TRIMA period on historical data often leads to overfitting. Stick with standard periods (20 for daily, 9-13 for intraday).</p>

<h3 id="common-misinterpretations">Common Misinterpretations</h3>

<p class="mb-4">- "TRIMA crossing price is a buy signal" → Too laggy; use bands instead</p>
<p class="mb-4">- "Shorter period = faster signals" → Double smoothing amplifies lag disproportionately</p>
<p class="mb-4">- "TRIMA is better than SMA" → It's different, not universally better; use for mean reversion, not momentum</p>

<hr class="border-[#2a2e39] my-8">

<h2 id="5-further-study">5. Further Study</h2>

<h3 id="creator-attribution">Creator Attribution</h3>

<p class="mb-4">Arthur Merrill introduced the triangular weighting concept to technical analysis in the 1970s. John Ehlers, an aerospace engineer turned trader, later formalized TRIMA within the context of Digital Signal Processing (DSP) in his work *Rocket Science for Traders*, demonstrating its properties as a Finite Impulse Response (FIR) filter.</p>

<h3 id="parent/child-indicators">Parent/Child Indicators</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Indicator</td><td class="px-4 py-2 border-b border-[#2a2e39]">Relationship</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">SMA</td><td class="px-4 py-2 border-b border-[#2a2e39]">Parent — TRIMA is SMA of SMA</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">TMA Bands/Envelopes</td><td class="px-4 py-2 border-b border-[#2a2e39]">Child — Bands built around TRIMA centerline</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">TMA Slope</td><td class="px-4 py-2 border-b border-[#2a2e39]">Derivative — Rate of change of TRIMA</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Weighted Moving Average</td><td class="px-4 py-2 border-b border-[#2a2e39]">Cousin — Different weighting scheme</td></tr>
</table></div>

<h3 id="recommended-readings">Recommended Readings</h3>

<p class="mb-4">1. *Rocket Science for Traders* — John Ehlers</p>
<p class="mb-4">2. *Technical Analysis from A to Z* — Steven Achelis</p>
<p class="mb-4">3. *The Encyclopedia of Technical Market Indicators* — Robert Colby</p>

<hr class="border-[#2a2e39] my-8">

<h3 id="55-related-indicators-comparison">5.5 Related Indicators Comparison</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Feature</td><td class="px-4 py-2 border-b border-[#2a2e39]">TRIMA</td><td class="px-4 py-2 border-b border-[#2a2e39]">SMA</td><td class="px-4 py-2 border-b border-[#2a2e39]">EMA</td><td class="px-4 py-2 border-b border-[#2a2e39]">DEMA</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Weighting</td><td class="px-4 py-2 border-b border-[#2a2e39]">Triangular (center-heavy)</td><td class="px-4 py-2 border-b border-[#2a2e39]">Equal</td><td class="px-4 py-2 border-b border-[#2a2e39]">Exponential (recent-heavy)</td><td class="px-4 py-2 border-b border-[#2a2e39]">Double-smoothed exponential</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Lag</td><td class="px-4 py-2 border-b border-[#2a2e39]">High</td><td class="px-4 py-2 border-b border-[#2a2e39]">Moderate</td><td class="px-4 py-2 border-b border-[#2a2e39]">Low</td><td class="px-4 py-2 border-b border-[#2a2e39]">Very Low</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Smoothness</td><td class="px-4 py-2 border-b border-[#2a2e39]">Very High</td><td class="px-4 py-2 border-b border-[#2a2e39]">Moderate</td><td class="px-4 py-2 border-b border-[#2a2e39]">Low</td><td class="px-4 py-2 border-b border-[#2a2e39]">Low</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Best Use</td><td class="px-4 py-2 border-b border-[#2a2e39]">Mean reversion centerline</td><td class="px-4 py-2 border-b border-[#2a2e39]">Trend following</td><td class="px-4 py-2 border-b border-[#2a2e39]">Responsive signals</td><td class="px-4 py-2 border-b border-[#2a2e39]">Aggressive entries</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Noise Rejection</td><td class="px-4 py-2 border-b border-[#2a2e39]">Excellent</td><td class="px-4 py-2 border-b border-[#2a2e39]">Moderate</td><td class="px-4 py-2 border-b border-[#2a2e39]">Poor</td><td class="px-4 py-2 border-b border-[#2a2e39]">Poor</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Repaints?</td><td class="px-4 py-2 border-b border-[#2a2e39]">No (standard)</td><td class="px-4 py-2 border-b border-[#2a2e39]">No</td><td class="px-4 py-2 border-b border-[#2a2e39]">No</td><td class="px-4 py-2 border-b border-[#2a2e39]">No</td></tr>
</table></div>

<p class="mb-4">When to Use Which:</p>
<p class="mb-4">- TRIMA — Mean reversion, band/channel centerlines, noise-heavy environments</p>
<p class="mb-4">- SMA — Trend identification, support/resistance zones</p>
<p class="mb-4">- EMA — Responsive crossover signals, momentum trading</p>
<p class="mb-4">- DEMA — Aggressive trend following, need for speed</p>

<p class="mb-4"><h2 class="text-2xl font-bold mt-12 mb-6 border-b pb-2">PART 3: ADVANCED SIGNAL REFERENCE</h2></p>

<h2 id="advanced-signal-reference">Advanced Signal Reference</h2>

<h3 id="threshold-matrix">Threshold Matrix</h3>

<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-[#2a2e39] text-sm text-left">
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Price vs TRIMA</td><td class="px-4 py-2 border-b border-[#2a2e39]">TRIMA Slope</td><td class="px-4 py-2 border-b border-[#2a2e39]">Market State</td><td class="px-4 py-2 border-b border-[#2a2e39]">Action</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Price > TRIMA + 2 ATR</td><td class="px-4 py-2 border-b border-[#2a2e39]">Flat</td><td class="px-4 py-2 border-b border-[#2a2e39]">Overextended bullish</td><td class="px-4 py-2 border-b border-[#2a2e39]">Prepare for short/take profits</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Price > TRIMA + 2 ATR</td><td class="px-4 py-2 border-b border-[#2a2e39]">Rising</td><td class="px-4 py-2 border-b border-[#2a2e39]">Strong trend</td><td class="px-4 py-2 border-b border-[#2a2e39]">Trail stops; don't short</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Price near TRIMA</td><td class="px-4 py-2 border-b border-[#2a2e39]">Flat</td><td class="px-4 py-2 border-b border-[#2a2e39]">Equilibrium</td><td class="px-4 py-2 border-b border-[#2a2e39]">Range-bound; wait</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Price near TRIMA</td><td class="px-4 py-2 border-b border-[#2a2e39]">Rising</td><td class="px-4 py-2 border-b border-[#2a2e39]">Healthy uptrend</td><td class="px-4 py-2 border-b border-[#2a2e39]">Buy pullbacks to TRIMA</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Price < TRIMA - 2 ATR</td><td class="px-4 py-2 border-b border-[#2a2e39]">Flat</td><td class="px-4 py-2 border-b border-[#2a2e39]">Overextended bearish</td><td class="px-4 py-2 border-b border-[#2a2e39]">Prepare for long</td></tr>
<tr><td class="px-4 py-2 border-b border-[#2a2e39]">Price < TRIMA - 2 ATR</td><td class="px-4 py-2 border-b border-[#2a2e39]">Falling</td><td class="px-4 py-2 border-b border-[#2a2e39]">Strong downtrend</td><td class="px-4 py-2 border-b border-[#2a2e39]">Trail stops; don't buy</td></tr>
</table></div>

<h3 id="signal-patterns">Signal Patterns</h3>

<h4 id="buy-signal-mean-reversion">Buy Signal (Mean Reversion)</h4>
<p class="mb-4">This pattern identifies high-probability long entries when price touches the lower TMA band and reverses back inside—a classic mean reversion setup. The multiple conditions (band touch, RSI reversal, slope check) combine to filter out false signals during strong downtrends. Studies show TMA Band mean reversion achieves 59% win rate with 1.5 profit factor, outperforming Bollinger Band equivalents due to TRIMA's superior noise rejection.</p>

<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-python">
def trima_buy_signal(price, trima, lower_band, rsi, trima_slope):
&nbsp;&nbsp;&nbsp;&nbsp;condition_1 = price &lt;= lower_band                    # Touched lower band
&nbsp;&nbsp;&nbsp;&nbsp;condition_2 = price &gt; lower_band                     # Closed back inside
&nbsp;&nbsp;&nbsp;&nbsp;condition_3 = rsi &lt; 35 and rsi_previous &lt; 35         # Oversold
&nbsp;&nbsp;&nbsp;&nbsp;condition_4 = rsi &gt; 35                               # RSI reversing
&nbsp;&nbsp;&nbsp;&nbsp;condition_5 = abs(trima_slope) &lt; 0.3                 # Not strong trend
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;return all([condition_1 or recent_touch, condition_2, 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;condition_3, condition_4, condition_5])
</code></pre>

<h4 id="sell-signal-mean-reversion">Sell Signal (Mean Reversion)</h4>
<p class="mb-4">The bearish counterpart to the buy signal, this pattern triggers when price reaches overextended levels at the upper TMA band and shows signs of reversal. The same multi-condition logic ensures the signal only fires when price has genuinely stretched beyond equilibrium and momentum is fading. The pattern works best in range-bound or gently trending markets where TRIMA slope remains below 0.3.</p>

<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-python">
def trima_sell_signal(price, trima, upper_band, rsi, trima_slope):
&nbsp;&nbsp;&nbsp;&nbsp;condition_1 = price &gt;= upper_band                    # Touched upper band
&nbsp;&nbsp;&nbsp;&nbsp;condition_2 = price &lt; upper_band                     # Closed back inside
&nbsp;&nbsp;&nbsp;&nbsp;condition_3 = rsi &gt; 65 and rsi_previous &gt; 65         # Overbought
&nbsp;&nbsp;&nbsp;&nbsp;condition_4 = rsi &lt; 65                               # RSI reversing
&nbsp;&nbsp;&nbsp;&nbsp;condition_5 = abs(trima_slope) &lt; 0.3                 # Not strong trend
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;return all([condition_1 or recent_touch, condition_2, 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;condition_3, condition_4, condition_5])
</code></pre>

<h4 id="trend-following-signal-slope-based">Trend Following Signal (Slope-Based)</h4>
<p class="mb-4">Unlike the mean reversion signals, this pattern uses TRIMA's slope as a momentum indicator for trend-following entries. When TRIMA slope exceeds 0.1 (indicating rising trend), price is above TRIMA (confirming direction), and volume confirms institutional participation, the setup has strong continuation probability. This complements the band-based strategies by providing entries in trending markets where mean reversion fails.</p>

<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-python">
def trima_trend_signal(price, trima, trima_slope, volume, avg_volume):
&nbsp;&nbsp;&nbsp;&nbsp;bullish = (trima_slope &gt; 0.1 and 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;price &gt; trima and 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;volume &gt; avg_volume * 1.2)
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;bearish = (trima_slope &lt; -0.1 and 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;price &lt; trima and 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;volume &gt; avg_volume * 1.2)
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;return &quot;BUY&quot; if bullish else &quot;SELL&quot; if bearish else &quot;NEUTRAL&quot;
</code></pre>

<h3 id="screening-filters">Screening Filters</h3>

<h4 id="mean-reversion-setup-scanner">Mean Reversion Setup Scanner</h4>
<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-">
SET TRIMA = SMA(SMA(Close, 20), 20)
SET ATR_14 = ATR(14)
SET Lower_Band = TRIMA - (2 * ATR_14)
SET Upper_Band = TRIMA + (2 * ATR_14)
SET TRIMA_Slope = (TRIMA - TRIMA[5]) / 5

FILTER WHERE:
&nbsp;&nbsp;(Low &lt;= Lower_Band AND Close &gt; Lower_Band)   // Lower band bounce
&nbsp;&nbsp;OR (High &gt;= Upper_Band AND Close &lt; Upper_Band) // Upper band rejection
&nbsp;&nbsp;AND ABS(TRIMA_Slope) &lt; (ATR_14 * 0.3)         // Not strongly trending
</code></pre>

<h4 id="trend-initiation-scanner">Trend Initiation Scanner</h4>
<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-">
SET TRIMA = SMA(SMA(Close, 20), 20)
SET TRIMA_Slope = (TRIMA - TRIMA[5]) / 5
SET Prev_Slope = (TRIMA[5] - TRIMA[10]) / 5

FILTER WHERE:
&nbsp;&nbsp;TRIMA_Slope &gt; 0.05                           // Slope turning up
&nbsp;&nbsp;AND Prev_Slope &lt;= 0.05                       // Was flat or down
&nbsp;&nbsp;AND Close &gt; TRIMA                            // Price above centerline
&nbsp;&nbsp;AND Volume &gt; SMA(Volume, 20) * 1.2           // Volume confirmation
</code></pre>

<h3 id="combination-strategies">Combination Strategies</h3>

<h4 id="trima-+-rsi-mean-reversion">TRIMA + RSI Mean Reversion</h4>
<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-">
SETUP:
&nbsp;&nbsp;TRIMA(20) calculated
&nbsp;&nbsp;TMA Bands at ±2 ATR
&nbsp;&nbsp;TRIMA_Slope &lt; 0.2 ATR/bar (not trending hard)

ENTRY (LONG):
&nbsp;&nbsp;Price touches Lower TMA Band
&nbsp;&nbsp;RSI(14) crosses above 30 from below

ENTRY (SHORT):
&nbsp;&nbsp;Price touches Upper TMA Band
&nbsp;&nbsp;RSI(14) crosses below 70 from above

STOP_LOSS:
&nbsp;&nbsp;0.5 ATR beyond band touch point

TAKE_PROFIT:
&nbsp;&nbsp;TRIMA centerline (conservative)
&nbsp;&nbsp;Opposite band (aggressive)
</code></pre>

<h4 id="trima-+-bollinger-band-width-regime-filter">TRIMA + Bollinger Band Width Regime Filter</h4>
<pre class="whitespace-pre overflow-x-auto bg-slate-800 text-slate-100 p-4 rounded"><code class="language-">
FILTER:
&nbsp;&nbsp;Calculate BB_Width = (Upper_BB - Lower_BB) / SMA(20)
&nbsp;&nbsp;
IF BB_Width &lt; 20th percentile (6 months):
&nbsp;&nbsp;// Squeeze - expect breakout
&nbsp;&nbsp;Wait for price to break TRIMA + 1 ATR
&nbsp;&nbsp;Enter in breakout direction
&nbsp;&nbsp;
IF BB_Width &gt; 80th percentile (6 months):
&nbsp;&nbsp;// Expansion - trade mean reversion
&nbsp;&nbsp;Use TMA Band bounce strategy
</code></pre>





                    </div>
                </article>
                <!-- Right: Sticky TOC -->
                <aside class="lg:block w-64 flex-shrink-0">
                    <div class="sticky top-24">
                        <h3 class="font-bold text-slate-900 mb-4 pb-2 border-b border-slate-100 text-sm uppercase tracking-wider">
                            On this page
                        </h3>
                        <nav id="toc-nav" class="space-y-1 text-sm text-slate-600">
                            <a href="#1-identity" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">1. Identity</a>
<a href="#2-calculation-logic" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">2. Calculation Logic</a>
<a href="#formula" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Formula</a>
<a href="#weighting-distribution" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Weighting Distribution</a>
<a href="#real-world-analogy" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Real-World Analogy</a>
<a href="#3-market-standards" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">3. Market Standards</a>
<a href="#default-parameters" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Default Parameters</a>
<a href="#timeframe-recommendations" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Timeframe Recommendations</a>
<a href="#why-these-values" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Why These Values?</a>
<a href="#4-market-context" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">4. Market Context</a>
<a href="#best-conditions" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Best Conditions</a>
<a href="#limitations" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Limitations</a>
<a href="#asset-class-suitability" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Asset Class Suitability</a>
<a href="#5-entry-signals" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">5. Entry Signals</a>
<a href="#primary-buy-signal-mean-reversion" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Primary Buy Signal (Mean Reversion)</a>
<a href="#primary-sell-signal-mean-reversion" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Primary Sell Signal (Mean Reversion)</a>
<a href="#6-filter-usage" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">6. Filter Usage</a>
<a href="#filter-rules" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Filter Rules</a>
<a href="#recommended-pairings" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Recommended Pairings</a>
<a href="#example-combined-strategy" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Example Combined Strategy</a>
<a href="#7-practical-cautions" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">7. Practical Cautions</a>
<a href="#lag-characteristics" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Lag Characteristics</a>
<a href="#false-signal-scenarios" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">False Signal Scenarios</a>
<a href="#mitigation-strategies" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Mitigation Strategies</a>
<a href="#8-pro-insights" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">8. Pro Insights</a>
<a href="#the-envelope-edge" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">The Envelope Edge</a>
<a href="#slope-as-regime-detector" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Slope as Regime Detector</a>
<a href="#the-"center-of-gravity"-concept" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">The "Center of Gravity" Concept</a>
<a href="#portfolio-application" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Portfolio Application</a>
<a href="#9-summary" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">9. Summary</a>
<a href="#1-core-concept" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">1. Core Concept</a>
<a href="#2-statistical-edge" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">2. Statistical Edge</a>
<a href="#why-it-works" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Why It Works</a>
<a href="#backtest-evidence" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Backtest Evidence</a>
<a href="#academic-reference" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Academic Reference</a>
<a href="#3-actionable-strategy" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">3. Actionable Strategy</a>
<a href="#strategy-name:-"tma-band-bounce"" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Strategy Name: "TMA Band Bounce"</a>
<a href="#4-risks-&-limitations" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">4. Risks & Limitations</a>
<a href="#failure-patterns" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Failure Patterns</a>
<a href="#psychological-traps" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Psychological Traps</a>
<a href="#common-misinterpretations" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Common Misinterpretations</a>
<a href="#5-further-study" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">5. Further Study</a>
<a href="#creator-attribution" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Creator Attribution</a>
<a href="#parent/child-indicators" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Parent/Child Indicators</a>
<a href="#recommended-readings" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Recommended Readings</a>
<a href="#55-related-indicators-comparison" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">5.5 Related Indicators Comparison</a>
<a href="#advanced-signal-reference" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors ">Advanced Signal Reference</a>
<a href="#threshold-matrix" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Threshold Matrix</a>
<a href="#signal-patterns" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Signal Patterns</a>
<a href="#screening-filters" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Screening Filters</a>
<a href="#combination-strategies" class="toc-link block py-1 px-2 rounded hover:bg-slate-50 transition-colors pl-4">Combination Strategies</a>

                        </nav>
                        <div class="mt-8 pt-4 border-t border-slate-100">
                            <a href="#" class="text-xs text-slate-400 hover:text-indigo-600 flex items-center transition-colors">
                                Back to Top
                            </a>
                        </div>
                    </div>
                </aside>
            </div>
        </section>


    </div>


        <!-- Footer -->
    <footer class="bg-white border-t border-slate-200 mt-12">
        <div class="max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8">
            <p class="text-center text-slate-400 text-sm">
                &copy; 2023-2025 I ant I Investigates. All rights reserved.
            </p>
        </div>
    </footer>
        <!-- ========================================== -->
    <!-- 1. DATA & LOGIC INJECTION                  -->
    <!-- ========================================== -->
    <script>
        window.IndicatorLogic = {
            name: "TriangularMovingAverage",
            params: [],
            calculate: null
        };
        (function() {
            try {
                const injectedCode = `
        window.IndicatorLogic = {
            calculate: (data, params) => {
                const period = params.period || 14;
                const result = TriangularMovingAverage.calculate(data, period);
                // Handle both array and object returns
                if (Array.isArray(result)) {
                    return { main: result };
                }
                return result;
            }
        };
        `;
                const isTemplatePlaceholder = injectedCode.includes('{{') && injectedCode.includes('CODE_INDICATOR_LOGIC');
                if (injectedCode && injectedCode.trim().length > 0 && !isTemplatePlaceholder) {
                    new Function(injectedCode)();
                } else {
                    console.warn("Playground Logic: Running in Preview/Fallback mode.");
                    window.IndicatorLogic.calculate = () => []; 
                }
            } catch (e) {
                console.error("Critical Error in Logic Injection:", e);
                window.IndicatorLogic.calculate = () => [];
            }
        })();
    </script>

    <!-- ========================================== -->
    <!-- 2. VISUALIZATION ENGINE                    -->
    <!-- ========================================== -->
    <script>
        mermaid.initialize({ startOnLoad: false, theme: 'neutral', securityLevel: 'loose' });
    </script>
    <!-- ========================================== -->
    <!-- 3. UI CONTROLLERS & APP INITIALIZATION     -->
    <!-- ========================================== -->
    <!-- INLINE UI CONTROLLERS (PORTED FROM 0117) -->
    <script src="../assets/js/TriangularMovingAverage.js"></script>
    <!-- JSON Data Containers (XSS-safe) -->
    <script id="data-indicator-config" type="application/json">
[]
    </script>
    <script id="data-indicator-display" type="application/json">
{"isOverlay": true, "plots": {"main": {"label": "TriangularMovingAverage", "color": "#4f46e5", "type": "line"}}}
    </script>
    <script>
        // --- 0. Indicator Data Injection ---
        // Use existing IndicatorLogic (set in earlier script block), only set if not exists
        var IndicatorLogic = window.IndicatorLogic || { calculate: null };
        var IndicatorConfig = [];
        var IndicatorDisplay = { isOverlay: false, plots: {} };

        // 1. Library Code - loaded externally before this block

        // 2. Configuration (XSS-safe via script type="application/json")
        try {
            var configEl = document.getElementById('data-indicator-config');
            if(configEl && configEl.textContent.trim()) {
                IndicatorConfig = JSON.parse(configEl.textContent);
            }
        } catch(e){ console.warn('Config parse error', e); }

        try {
            var displayEl = document.getElementById('data-indicator-display');
            if(displayEl && displayEl.textContent.trim()) {
                IndicatorDisplay = JSON.parse(displayEl.textContent);
            }
        } catch(e){ console.warn('Display parse error', e); }

        // 3. Logic Adapter
        window.IndicatorLogic = {
            calculate: (data, params) => {
                const period = params.period || 14;
                const result = TriangularMovingAverage.calculate(data, period);
                // Handle both array and object returns
                if (Array.isArray(result)) {
                    return { main: result };
                }
                return result;
            }
        };
    </script>

    <!-- UI Controllers: indicator.js loads first to define PlaygroundController -->
    <script src="../assets/js/indicator.js" defer></script>
    <!-- script.js loads second, skips PlaygroundController if already defined -->
    <script src="../assets/js/script.js" defer></script>

</body>
</html>